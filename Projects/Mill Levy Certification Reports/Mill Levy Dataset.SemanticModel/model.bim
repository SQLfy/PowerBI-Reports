{
  "compatibilityLevel": 1567,
  "model": {
    "annotations": [
      {
        "name": "PBIDesktopVersion",
        "value": "2.137.751.0 (24.10)"
      },
      {
        "name": "__PBI_TimeIntelligenceEnabled",
        "value": "0"
      },
      {
        "name": "PBI_QueryOrder",
        "value": "[\"FundType_Position\",\"StateReportTab\",\"StateReportTabSection\",\"Tax Authority Info\",\"Realware GRASSASSESSED\",\"ENCOMPASS TLKPTAXAUTHORITYDETAIL\",\"Millap GROSSASSESSED\",\"Azure Mill Levy App GROSSASSESSED\",\"mds_server\",\"mds_database\",\"realware_server\",\"realware_database\",\"TaxYear_Param\",\"County\",\"County (2)\",\"County (3)\",\"NON 32\",\"Non Title 32 (2)\",\"Non Title 32 (3)\",\"Title 32\",\"Title 32 Totals\",\"Title 32 (2)\",\"Title 32 (3)\",\"Schools\",\"Schools (2)\",\"Schools (3)\",\"City\",\"City (2)\",\"City (3)\",\"azure_server\",\"azure_database\",\"TaxYear_Param_LY\",\"Parameters\"]"
      },
      {
        "name": "PBI_ProTooling",
        "value": "[\"DevMode\"]"
      }
    ],
    "culture": "en-US",
    "cultures": [
      {
        "name": "en-US",
        "linguisticMetadata": {
          "content": {
            "Language": "en-US",
            "Version": "1.0.0"
          },
          "contentType": "json"
        }
      }
    ],
    "dataAccessOptions": {
      "legacyRedirects": true,
      "returnErrorValuesAsNull": true
    },
    "defaultPowerBIDataSourceVersion": "powerBI_V3",
    "expressions": [
      {
        "name": "mds_server",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Text"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "expression": "\"PRDCETL-MST01.dcgov.douglas.co.us\" meta [IsParameterQuery=true, Type=\"Text\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "0dbbd973-8e99-4803-b01a-68eb01f2e459"
      },
      {
        "name": "mds_database",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Text"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "expression": "\"MDS\" meta [IsParameterQuery=true, Type=\"Any\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "a0aa8ed4-448a-424e-9231-54ae03f0c040"
      },
      {
        "name": "realware_server",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Text"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "expression": "\"uarw2-sql01.dcgov.douglas.co.us\" meta [IsParameterQuery=true, List={\"prrw2-sql01\"}, DefaultValue=\"prrw2-sql01\", Type=\"Text\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "50d40410-3b8b-4e21-91ee-590f16ec44a4"
      },
      {
        "name": "realware_database",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Text"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "expression": "\"PRRW_Upgrade\" meta [IsParameterQuery=true, Type=\"Any\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "68678d6a-4f38-4a5c-8dd4-18eb2b252386"
      },
      {
        "name": "TaxYear_Param",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Number"
          }
        ],
        "expression": "2024 meta [IsParameterQuery=true, Type=\"Number\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "47b1e760-6540-4d28-9fbb-627554974abf"
      },
      {
        "name": "azure_server",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Text"
          }
        ],
        "expression": "\"sql-milllevy-ua-westus3.database.windows.net\" meta [IsParameterQuery=true, Type=\"Text\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "9ef12e1b-539d-4dce-9212-021a829e758b"
      },
      {
        "name": "azure_database",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Text"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "expression": "\"milllevy\" meta [IsParameterQuery=true, Type=\"Text\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "f5af03c7-938e-45d3-9572-3f542930287c"
      },
      {
        "name": "TaxYear_Param_LY",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Number"
          }
        ],
        "expression": "2023 meta [IsParameterQuery=true, Type=\"Number\", IsParameterQueryRequired=false]",
        "kind": "m",
        "lineageTag": "007ae789-9895-4c54-afe9-db4f28b54b7a"
      }
    ],
    "sourceQueryCulture": "en-US",
    "tables": [
      {
        "name": "FundType_Position",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "changedProperties": [
          {
            "property": "IsHidden"
          }
        ],
        "columns": [
          {
            "name": "Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "68df2765-5d4f-4e0a-8f21-fa439b1b0216",
            "sourceColumn": "Name",
            "summarizeBy": "none"
          },
          {
            "name": "Code",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "ee8a9270-5d41-4893-8449-1b3cb9bc578a",
            "sourceColumn": "Code",
            "summarizeBy": "none"
          },
          {
            "name": "Index",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d478b2b2-75f6-4622-b4d3-030c3c3e9c4e",
            "sourceColumn": "Index",
            "summarizeBy": "none"
          },
          {
            "name": "Position",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "13674e6c-b270-4603-b0a6-d9bbd6eace19",
            "sourceColumn": "Position",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup_title_32",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b3dc9394-4191-42e6-853b-99dc156d268e",
            "sourceColumn": "PositionRowGroup_title_32",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup_Schools",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d694e4eb-274d-479c-b49d-0957d99b4520",
            "sourceColumn": "PositionRowGroup_Schools",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup_City",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "5f36178f-a145-4166-9a50-00d6154bed5b",
            "sourceColumn": "PositionRowGroup_City",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup_Non_32",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ad80a978-b8e4-4ff1-878a-08380cc48c31",
            "sourceColumn": "PositionRowGroup_Non_32",
            "summarizeBy": "none"
          },
          {
            "name": "Position_Schools",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "lineageTag": "a080cb88-ae88-492f-ab2c-3a8697d9fd8f",
            "sourceColumn": "Position_Schools",
            "summarizeBy": "none"
          },
          {
            "name": "PositionColGroup_Schools",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "lineageTag": "30467db5-34a7-4edf-b23f-e289cceeea8f",
            "sourceColumn": "PositionColGroup_Schools",
            "summarizeBy": "none"
          },
          {
            "name": "Position_TITLE_32",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "lineageTag": "7e11188f-edf0-4b6e-b266-cdcd1b8fae86",
            "sourceColumn": "Position_TITLE_32",
            "summarizeBy": "none"
          },
          {
            "name": "Position_City",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "lineageTag": "0e0c279c-880a-427b-a5d4-1f322763d26e",
            "sourceColumn": "Position_City",
            "summarizeBy": "none"
          },
          {
            "name": "Position_NON_32",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "lineageTag": "0783603b-fa31-4afa-94ac-a17a0f0e0ffc",
            "sourceColumn": "Position_NON_32",
            "summarizeBy": "none"
          },
          {
            "name": "Position_County",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "lineageTag": "0133689c-223c-4364-8330-e92d77f6d8a3",
            "sourceColumn": "Position_County",
            "summarizeBy": "none"
          },
          {
            "name": "PositionColGroup_TITLE_32",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "lineageTag": "f1337a90-2122-4933-976a-1c7a9927fd66",
            "sourceColumn": "PositionColGroup_TITLE_32",
            "summarizeBy": "none"
          },
          {
            "name": "PositionColGroup_City",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "lineageTag": "b8591a1d-448a-4c8c-9c47-6ff1132683d7",
            "sourceColumn": "PositionColGroup_City",
            "summarizeBy": "none"
          },
          {
            "name": "PositionColGroup_NON_32",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "lineageTag": "a580fc51-1e27-4d44-bef3-532c9ea92da8",
            "sourceColumn": "PositionColGroup_NON_32",
            "summarizeBy": "none"
          },
          {
            "name": "PositionColGroup_County",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "lineageTag": "315146de-a3cd-4457-84e6-c88368ed4718",
            "sourceColumn": "PositionColGroup_County",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup_County",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "lineageTag": "e7375d29-2e15-4951-a8e2-bde852b6eeb2",
            "sourceColumn": "PositionRowGroup_County",
            "summarizeBy": "none"
          },
          {
            "name": "CountyCode",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "lineageTag": "f362d798-d06a-48e9-9a6e-3e8dd08510f8",
            "sourceColumn": "CountyCode",
            "summarizeBy": "none"
          },
          {
            "name": "CountyPosition",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "lineageTag": "c8eeac3d-e1fa-45fd-811d-097ebc75456b",
            "sourceColumn": "CountyPosition",
            "summarizeBy": "none"
          },
          {
            "name": "CountyColumnGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "777a6938-8242-4c51-9df0-2b8825556ea2",
            "sourceColumn": "CountyColumnGroup",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "9fad7bc7-ef2b-4dc4-84c3-996a621d8d30",
        "partitions": [
          {
            "name": "FundType_Position-8925f311-4e68-4988-808b-4c72c5c008f4",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(mds_server, mds_database, [CreateNavigationProperties=false]),",
                "    mdm_Mill_Levy_FundType_Position = Source{[Schema=\"mdm\",Item=\"Mill_Levy_FundType_Position\"]}[Data],",
                "    #\"Removed Columns\" = Table.RemoveColumns(mdm_Mill_Levy_FundType_Position,{\"ID\", \"MUID\", \"VersionName\", \"VersionNumber\", \"Version_ID\", \"VersionFlag\", \"ChangeTrackingMask\", \"EnterDateTime\", \"EnterUserName\", \"EnterVersionNumber\", \"LastChgDateTime\", \"LastChgUserName\", \"LastChgVersionNumber\", \"ValidationStatus\"}),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Removed Columns\",{{\"CountyPosition\", Int64.Type}, {\"CountyCode\", Int64.Type}, {\"PositionRowGroup_County\", Int64.Type}, {\"PositionColGroup_County\", Int64.Type}, {\"PositionColGroup_NON_32\", Int64.Type}, {\"PositionColGroup_City\", Int64.Type}, {\"PositionColGroup_TITLE_32\", Int64.Type}, {\"PositionColGroup_Schools\", Int64.Type}, {\"Position_County\", Int64.Type}, {\"Position_NON_32\", Int64.Type}, {\"Position_City\", Int64.Type}, {\"Position_TITLE_32\", Int64.Type}, {\"Position_Schools\", Int64.Type}, {\"PositionRowGroup_Non_32\", Int64.Type}, {\"PositionRowGroup_City\", Int64.Type}, {\"PositionRowGroup_title_32\", Int64.Type}, {\"PositionRowGroup_Schools\", Int64.Type}, {\"Position\", Int64.Type}, {\"Index\", Int64.Type}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "StateReportTab",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "changedProperties": [
          {
            "property": "IsHidden"
          }
        ],
        "columns": [
          {
            "name": "Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "2c83dc39-f36d-418b-bad1-e0cf177aa38d",
            "sourceColumn": "Name",
            "summarizeBy": "none"
          },
          {
            "name": "Code",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "851c3822-481d-4528-963d-f8b4c6967918",
            "sourceColumn": "Code",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "52450ca0-4449-4811-a3db-b7e9c50d6852",
            "sourceColumn": "StateReportTabSortOrder",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "ee7b8f15-1eb8-49d8-bf9e-9ef41875c827",
        "partitions": [
          {
            "name": "StateReportTab-26becc69-d2d6-486b-b031-a1b3d2050fbe",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(mds_server, mds_database, [CreateNavigationProperties=false]),",
                "    mdm_Mill_Levy_StateReportTab = Source{[Schema=\"mdm\",Item=\"Mill_Levy_StateReportTab\"]}[Data],",
                "    #\"Trimmed Text\" = Table.TransformColumns(mdm_Mill_Levy_StateReportTab,{{\"Name\", Text.Trim, type text}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Trimmed Text\",{\"ID\", \"MUID\", \"VersionName\", \"VersionNumber\", \"Version_ID\", \"VersionFlag\", \"ChangeTrackingMask\", \"EnterDateTime\", \"EnterUserName\", \"EnterVersionNumber\", \"LastChgDateTime\", \"LastChgUserName\", \"LastChgVersionNumber\", \"ValidationStatus\"}),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Removed Columns\",{{\"StateReportTabSortOrder\", Int64.Type}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "StateReportTabSection",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "changedProperties": [
          {
            "property": "IsHidden"
          }
        ],
        "columns": [
          {
            "name": "Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "c9145afb-86b5-4756-a9bb-63f8259f5a1f",
            "sourceColumn": "Name",
            "summarizeBy": "none"
          },
          {
            "name": "Code",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "lineageTag": "a7d21e20-c5f6-4a66-a24f-301f66ac700b",
            "sourceColumn": "Code",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSectionSortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "7b0b6373-ccb7-4dd9-8aca-0c8d1acf6693",
            "sourceColumn": "StateReportTabSectionSortOrder",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "7fc1fc6a-fdab-46d8-983a-ca612bade1d1",
        "partitions": [
          {
            "name": "StateReportTabSection-93138eb3-e286-4dd1-a5bf-60c2316bfc66",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(mds_server, mds_database, [CreateNavigationProperties=false]),",
                "    mdm_Mill_Levy_StateReportTabSection = Source{[Schema=\"mdm\",Item=\"Mill_Levy_StateReportTabSection\"]}[Data],",
                "    #\"Trimmed Text\" = Table.TransformColumns(mdm_Mill_Levy_StateReportTabSection,{{\"Name\", Text.Trim, type text}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Trimmed Text\",{\"ID\", \"MUID\", \"VersionName\", \"VersionNumber\", \"Version_ID\", \"VersionFlag\", \"ChangeTrackingMask\", \"EnterDateTime\", \"EnterUserName\", \"EnterVersionNumber\", \"LastChgDateTime\", \"LastChgUserName\", \"LastChgVersionNumber\", \"ValidationStatus\"}),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Removed Columns\",{{\"StateReportTabSectionSortOrder\", Int64.Type}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Schools",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "columns": [
          {
            "name": "taxyear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "1fb509b0-5ea3-4dfe-977e-960116d469cc",
            "sourceColumn": "taxyear",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "12d00a37-1aff-4ebc-93ab-15e7e16c5e98",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTab",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "9f5b6244-88dd-45d7-bc5f-4b927c571372",
            "sourceColumn": "StateReportTab",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "40a96ad7-09c6-4e3b-9759-608e2eabab44",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          },
          {
            "name": "taxauthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e32a4f0b-0c93-4eae-8d50-8c239ed66adc",
            "sourceColumn": "taxauthority",
            "summarizeBy": "none"
          },
          {
            "name": "AUTHORITYTYPE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e092b48f-ace0-4c76-81e7-6113df0f1e35",
            "sourceColumn": "AUTHORITYTYPE",
            "summarizeBy": "none"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "24e8ab5c-2489-4a34-9362-e8470143f750",
            "sourceColumn": "rownum",
            "summarizeBy": "none"
          },
          {
            "name": "rownum2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c5927492-1279-4d6e-a0d3-4c59972107fc",
            "sourceColumn": "rownum2",
            "summarizeBy": "none"
          },
          {
            "name": "rownum3",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "354db6e3-6c44-4280-bbc3-2eb4f270bf4a",
            "sourceColumn": "rownum3",
            "summarizeBy": "none"
          },
          {
            "name": "Total_All_Funds_Levy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "93c0b2c8-e681-4da2-8027-ba9ea49a03a2",
            "sourceColumn": "Total_All_Funds_Levy",
            "summarizeBy": "sum"
          },
          {
            "name": "Total_All_Funds_GrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "2ad46944-ffc2-4dfb-b6ad-79baf9c09d99",
            "sourceColumn": "Total_All_Funds_GrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "index",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "3cd4e9b1-42e3-4760-b4fd-3580ff005541",
            "sourceColumn": "index",
            "summarizeBy": "sum"
          },
          {
            "name": "FundType",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "27f5af2d-5e54-4a08-bf8d-7108c243eddc",
            "sourceColumn": "FundType",
            "summarizeBy": "none"
          },
          {
            "name": "FundID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c508c2ef-1fe2-4d58-baf6-63617bacc47f",
            "sourceColumn": "FundID",
            "summarizeBy": "none"
          },
          {
            "name": "DateOfIssue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "9bc332ee-2553-444c-b68f-7c8b21d3aa04",
            "sourceColumn": "DateOfIssue",
            "summarizeBy": "none"
          },
          {
            "name": "MaturityDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "84aef448-36ac-4974-8146-5795c4b2ab4f",
            "sourceColumn": "MaturityDate",
            "summarizeBy": "none"
          },
          {
            "name": "TermInYears",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "483f61f2-3cd4-4962-b82a-43fcdd31cd08",
            "sourceColumn": "TermInYears",
            "summarizeBy": "none"
          },
          {
            "name": "Levy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "9eb15819-88e4-4685-9c12-2254fcdb7b96",
            "sourceColumn": "Levy",
            "summarizeBy": "sum"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c209122d-1760-4c2f-932e-701bc0df8c1d",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "2c078068-f665-4d70-b5fd-78655b25bafb",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "NETASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "fdcacce0-112a-4d74-b143-3b5e00ad7238",
            "sourceColumn": "NETASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "e13d191a-84e9-41e7-b597-f719a9de1f40",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "4f92dd00-331e-4c24-9068-4af57a41196b",
            "sourceColumn": "TotalRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "9e220620-f854-4a0b-bdfc-a3e7b0f39bbb",
            "sourceColumn": "TotalGrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "f754043e-488b-475e-94cc-0ecf290ee5f9",
            "sourceColumn": "GrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "CertID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "429834da-ea12-4778-b520-4ad5bf7b28f3",
            "sourceColumn": "CertID",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "12076046-0d5e-41bf-8b09-957668b159c3",
            "sourceColumn": "StateReportTabSortOrder",
            "summarizeBy": "none"
          },
          {
            "name": "PositionColGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e744a58d-1242-4922-95e4-7ec750ac0363",
            "sourceColumn": "PositionColGroup",
            "summarizeBy": "sum"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2c44d072-f801-43e2-931e-4b2d1e54b88d",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "sum"
          },
          {
            "name": "Position",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "1bea9588-444e-4107-b67c-472186f463db",
            "sourceColumn": "Position",
            "summarizeBy": "sum"
          },
          {
            "name": "RowNum_TA_Position",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": [
              "RANKX(",
              "        FILTER(",
              "            'Schools',",
              "            'Schools'[taxyear]=EARLIER('Schools'[taxyear]) && 'Schools'[taxauthority]=EARLIER('Schools'[taxauthority]) && 'Schools'[Position]=EARLIER('Schools'[Position])",
              "        ),",
              "        IF(ISBLANK(Schools[Levy]),999999,Schools[Levy])",
              "    )"
            ],
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "6b9627a9-f61d-4bd4-9aa2-44e230a9e719",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Show_Or_Hide",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "If(Schools[RowNum_TA_Position] <> 1 && ISBLANK([Levy]), \"Hide\", \"Show\")",
            "isDataTypeInferred": true,
            "lineageTag": "e600e057-9386-4f0b-9be5-e13361aa1015",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "StateReportTabSectionSortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "1",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "61239c9b-ceac-4238-a679-9572ba7fcd15",
            "summarizeBy": "sum",
            "type": "calculated"
          }
        ],
        "lineageTag": "68ab1952-382e-4ddc-9cd5-929e13d79796",
        "partitions": [
          {
            "name": "Schools-3a925f8c-cbc7-44e5-a3ed-6a701b3ddae5",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database, [Query=\"with cte_SchoolData#(lf)as (#(lf)#(tab)select  distinct #(lf)#(tab)f.taxyear#(lf)#(tab)--, case g.StateReportTab#(lf)#(tab)--#(tab)when 'schools' then 1#(lf)#(tab)--#(tab)when 'county' then 2#(lf)#(tab)--#(tab)when 'city' then 3#(lf)#(tab)--#(tab)when 'title 32' then 4#(lf)#(tab)--#(tab)when 'non 32' then 5#(lf)#(tab)--#(tab)end StateReportTabSortOrder#(lf)#(tab)--, case g.StateReportTabSection#(lf)#(tab)--#(tab)when 'Metro Districts' then 1#(lf)#(tab)--#(tab)when 'Recreation Districts' then 2#(lf)#(tab)--#(tab)when 'Fire Protection Districts' then 3#(lf)#(tab)--#(tab)when 'Water Districts' then 4#(lf)#(tab)--#(tab)when 'Water & Sanitation Districts' then 5#(lf)#(tab)--#(tab)when 'Water Conservancy Districts' then 6#(lf)#(tab)--#(tab)when 'Urban Renewal Authorities' then 7#(lf)#(tab)--#(tab)when 'Public Improvement Districts' then 8#(lf)#(tab)--#(tab)when 'Urban Drain & Flood Control Districts' then 9#(lf)#(tab)--#(tab)when 'Business Improvement Districts' then 10#(lf)#(tab)--#(tab)end StateReportTabSectionSortOrder#(lf)#(tab)--,c.FundTypeIndex#(lf)#(tab), a.authorityname TaxingEntity#(lf)#(lf)#(tab)--, case #(lf)#(tab)--#(tab)when StateReportTab = 'schools' and b.[Index] = 8 then 8#(lf)#(tab)--#(tab)when StateReportTab = 'schools' and b.[Index] = 7 then 7#(lf)#(tab)--#(tab)#(tab)when StateReportTab = 'schools' and b.[Index] = 1 then 3#(lf)#(tab)#(lf)#(tab)--#(tab)--these fundtypes need to be added#(lf)#(tab)--#(tab)#(tab)when StateReportTab = 'schools' and b.[Index] = 3 then 4 --override mill levy#(lf)#(tab)--#(tab)#(tab)when StateReportTab = 'schools' and b.[Index] = 2 then 6 #(lf)#(tab)--#(tab)when StateReportTab = 'schools' and b.[Index] = 22 then 6#(lf)#(tab)--#(tab)when StateReportTab = 'schools' and b.[Index] = 23 then 7#(lf)#(tab)--#(tab)when StateReportTab = 'schools' and b.[Index] = 24 then 4#(lf)#(tab)--#(tab)else b.Position end Position#(lf)#(lf)#(lf)#(tab), g.StateReportTab, g.StateReportTabSection#(lf)#(tab), a.taxauthority, a.AUTHORITYTYPE#(lf)#(lf)#(tab)--, case #(lf)#(tab)--#(tab)when statereporttab = 'schools' and b.[index] = 7 then 4#(lf)#(tab)--#(tab)when statereporttab = 'schools' and b.[index] = 2 then 3#(lf)#(tab)--#(tab)when statereporttab = 'schools' and b.[index] = 8 then 4#(lf)#(tab)--#(tab)when statereporttab = 'schools' and b.[index] = 22 then 3#(lf)#(tab)--#(tab)when statereporttab = 'schools' and b.[index] = 23 then 4#(lf)#(tab)--#(tab)when statereporttab = 'schools' and b.[index] = 24 then 2#(lf)#(tab)--#(tab)else b.positiongroup end PositionColGroup#(lf)#(lf)#(tab)--, case #(lf)#(tab)--#(tab)when StateReportTab in ('city', 'non 32') and b.position in (1, 3, 5) then 1#(lf)#(tab)--#(tab)when StateReportTab in ('city', 'non 32') and b.position in (2, 4, 6, 7) then 2#(lf)#(tab)--#(tab)when StateReportTab in ('title 32') and b.position in (1, 5) then 1#(lf)#(tab)--#(tab)when StateReportTab in ('title 32') and b.position in (2, 3, 6, 7) then 2#(lf)#(tab)--#(tab)when StateReportTab in ('title 32') and b.position in (4) then 3#(lf)#(tab)--#(tab)when StateReportTab in ('schools') and b.[index] in (6, 1, 10, 7) then 1#(lf)#(tab)--#(tab)when StateReportTab in ('schools') and b.[index] in (4, 3, 2, 8, 22, 24) then 2#(lf)#(tab)--#(tab)else 1#(lf)#(tab)--#(tab)end PositionRowGroup#(lf)#(lf)#(tab), ROW_NUMBER() over(partition by f.taxyear, a.taxauthority, b.[index] order by b.[index], isnull(d.Levy, 999999)) rownum#(lf)#(tab), rank() over(partition by f.taxyear, a.authoritytype order by a.authoritytype, a.authorityname) rownum2#(lf)#(tab), ROW_NUMBER() over(partition by f.taxyear, a.taxauthority order by e.grossassessed desc) rownum3#(lf)#(tab), sum(case b.FundType#(lf)#(tab)#(tab)#(tab)when 'TEMP TAX CREDIT' then d.Levy * -1#(lf)#(tab)#(tab)#(tab)else d.Levy end) over (partition by a.taxauthority) as Total_All_Funds_Levy#(lf)#(tab), sum(case b.FundType#(lf)#(tab)#(tab)#(tab)when 'TEMP TAX CREDIT' then -1 * d.GrossRevenue#(lf)#(tab)#(tab)#(tab)else d.GrossRevenue end) over (partition by a.taxauthority) as Total_All_Funds_GrossRevenue#(lf)#(lf)#(tab), b.[index], b.FundType#(lf)#(tab), c.FundID, c.DateOfIssue, c.MaturityDate#(lf)#(tab), case when isdate(c.dateofissue)<>1 or isdate(c.maturitydate)<>1 then null else DATEDIFF(YEAR, c.DateOfIssue, c.MaturityDate) end TermInYears#(lf)#(tab), case b.FundType#(lf)#(tab)#(tab)when 'TEMP TAX CREDIT' then d.Levy * -1#(lf)#(tab)#(tab)else d.Levy end Levy#(lf)#(lf)#(tab)-- DG 8/26/2020#(lf)#(tab)-- revenue column has been removed.  It is not in use in this report.#(lf)#(lf)#(tab), e.Certified#(lf)#(tab), e.GROSSASSESSED#(lf)#(tab), e.NETASSESSED#(lf)#(tab), e.TotalLevy#(lf)#(tab), e.TotalRevenue#(lf)#(lf)#(tab)-- DG 8/26/2020. The next line of code replaces the calcuation #(lf)#(tab)-- \"\"convert(decimal(18,0), (e.GROSSASSESSED * e.Totallevy) /1000)\"\"#(lf)#(tab)-- with the TotalGrossRevenue column in the CERT Table#(lf)#(tab), convert(decimal(18,0), e.TotalGrossRevenue) TotalGrossRevenue#(tab)#(lf)#(lf)#(tab)-- The next 3 lines of code replace the calculation #(lf)#(tab)-- \"\"convert(decimal(18,0), (e.GROSSASSESSED * d.levy) /1000)\"\"#(lf)#(tab)-- with the GrossRevenue column in the FundYear table#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(lf)#(tab)--, case b.[index]#(tab)#(lf)#(tab)-- when 4 then convert(decimal(18,0), -1 * (e.GROSSASSESSED * d.levy) /1000)#(lf)#(tab)-- else convert(decimal(18,0), (e.GROSSASSESSED * d.levy) /1000) end GrossRevenue#(lf)#(tab),case b.FundType#(lf)#(tab)when 'TEMP TAX CREDIT' then -1 * d.GrossRevenue#(lf)#(tab)else d.GrossRevenue end GrossRevenue#(tab)#(lf)#(lf)#(tab), e.CertID#(lf)#(lf)#(tab)from#(tab)#(tab)encompass.tlkptaxauthority#(tab)#(tab)#(tab)a#(lf)#(tab)full join#(tab)millap.fundtype#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)b on 1 = 1#(lf)#(tab)join#(tab)#(tab)encompass.TLKPTAXAUTHORITYDETAIL#(tab)f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR >=2018#(tab)#(tab)--and coalesce(f.taxyear, 2018) = 2018#(lf)#(tab)left join#(tab)millap.fund#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)c on (c.TaxAuthority = a.TAXAUTHORITY or c.TaxAuthority is null) and (c.fundtypeindex = b.[index] or c.fundtypeindex is null)#(lf)#(tab)left join#(tab)millap.fundyear#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)d on d.FundID = c.FundID  and d.TaxYear = f.TAXYEAR#(tab)#(tab)#(tab)#(tab)--and coalesce(d.taxyear, 2018) = 2018 #(lf)#(tab)left join#(tab)millap.cert#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)e on e.TaxYear = d.TaxYear and e.TaxAuthority = a.TAXAUTHORITY#(lf)#(tab)left join#(tab)millap.TAXAUTHORITYINFO#(tab)#(tab)#(tab)#(tab)g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(lf)#(tab)where a.TAXAUTHORITY is not null#(lf)#(tab)and f.ACTIVEFLAG = 1#(lf)#(tab)and g.StateReportTab in ( 'schools')#(lf)#(tab)--and f.TAXYEAR = 2021#(lf)#(tab)--and isnull(d.GrossRevenue, 0) <> 0#(lf)--order by 1, 2, 3, 4, 5, 8#(lf)#(lf))#(lf)select#(tab)*#(lf)#(tab)#(tab)--, ROW_NUMBER() over(partition by taxauthority, Position order by isnull(Levy, 999999)) as RowNum_TA_Position#(lf)#(tab)#(tab)--, case when ROW_NUMBER() over(partition by taxauthority, Position order by isnull(Levy, 999999)) <> 1 and Levy is null then 'Hide' else 'Show' end as Show_Or_Hide#(lf)from cte_SchoolData#(lf)order by taxyear, TaxingEntity, taxauthority\"]),",
                "    #\"Trimmed Text\" = Table.TransformColumns(Source,{{\"StateReportTab\", Text.Trim, type text}, {\"StateReportTabSection\", Text.Trim, type text}}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Trimmed Text\", {\"StateReportTab\"}, StateReportTab, {\"Name\"}, \"StateReportTab.1\", JoinKind.Inner),",
                "    #\"Expanded StateReportTab.1\" = Table.ExpandTableColumn(#\"Merged Queries\", \"StateReportTab.1\", {\"StateReportTabSortOrder\"}, {\"StateReportTabSortOrder\"}),",
                "    #\"Merged Queries1\" = Table.NestedJoin(#\"Expanded StateReportTab.1\", {\"index\"}, FundType_Position, {\"Index\"}, \"FundType_Position\", JoinKind.Inner),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged Queries1\", \"FundType_Position\", {\"PositionColGroup_Schools\", \"PositionRowGroup_Schools\", \"Position_Schools\"}, {\"PositionColGroup_Schools\", \"PositionRowGroup_Schools\", \"Position_Schools\"}),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Expanded FundType_Position\",{{\"PositionColGroup_Schools\", Int64.Type}, {\"PositionRowGroup_Schools\", Int64.Type}, {\"Position_Schools\", Int64.Type}}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Changed Type\",{{\"PositionColGroup_Schools\", \"PositionColGroup\"}, {\"PositionRowGroup_Schools\", \"PositionRowGroup\"}, {\"Position_Schools\", \"Position\"}}),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Renamed Columns\",{{\"taxyear\", Int64.Type}}),",
                "    #\"Filtered Rows\" = Table.SelectRows(#\"Changed Type1\", each ([taxyear] = 2023))",
                "in",
                "    #\"Filtered Rows\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "City",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "columns": [
          {
            "name": "taxyear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "8aaac8fd-49ec-4dfe-9b94-f9d1e9288fd8",
            "sourceColumn": "taxyear",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7fab142f-2f65-4b47-96ce-f87a68706ded",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTab",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "acdb6b97-45fd-4137-a8f1-89a43a9c74e0",
            "sourceColumn": "StateReportTab",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "2886cbfe-db8d-4653-8a35-58ac98d3a6e9",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          },
          {
            "name": "taxauthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "5971d53d-0621-4ca2-93d8-bae0fa4d1023",
            "sourceColumn": "taxauthority",
            "summarizeBy": "none"
          },
          {
            "name": "AUTHORITYTYPE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "aec8215f-9d72-4bb4-9d02-19bc819ae327",
            "sourceColumn": "AUTHORITYTYPE",
            "summarizeBy": "none"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "0e598641-bfa1-4702-b506-4cc6144b013d",
            "sourceColumn": "rownum",
            "summarizeBy": "none"
          },
          {
            "name": "rownum2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "3a68ffd6-f6ea-49fb-8712-da5f5c16199c",
            "sourceColumn": "rownum2",
            "summarizeBy": "none"
          },
          {
            "name": "index",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "45e49520-c244-4175-b053-074a2afdbfeb",
            "sourceColumn": "index",
            "summarizeBy": "sum"
          },
          {
            "name": "FundType",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "97b36a2e-3bdb-464b-90bf-0aaeaa804f14",
            "sourceColumn": "FundType",
            "summarizeBy": "none"
          },
          {
            "name": "FundID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "8697d482-5713-4295-a159-c11ddde71aff",
            "sourceColumn": "FundID",
            "summarizeBy": "none"
          },
          {
            "name": "DateOfIssue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "3c052b5b-2b76-40a7-9a82-dc4e40dd051d",
            "sourceColumn": "DateOfIssue",
            "summarizeBy": "none"
          },
          {
            "name": "MaturityDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "147e8d75-6b40-4a6e-9bf6-e2716c8348ad",
            "sourceColumn": "MaturityDate",
            "summarizeBy": "none"
          },
          {
            "name": "TermInYears",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "679edf7f-372d-470c-86f9-612b617dab25",
            "sourceColumn": "TermInYears",
            "summarizeBy": "none"
          },
          {
            "name": "Levy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "85ec2f64-af8a-48d5-8306-8a75054cebf2",
            "sourceColumn": "Levy",
            "summarizeBy": "sum"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a2aab11a-be0d-47fa-b3a8-a0222d68a5c9",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "e09ea91a-bb72-448d-a35f-7ca430685f32",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "NETASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "ccb3cd5e-983c-4648-b3bf-91d5ea016775",
            "sourceColumn": "NETASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "9d8eb8b8-ba20-4ce5-9732-f47170b5d6d7",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "f63d5456-d896-4426-8ec9-0210f67acc4b",
            "sourceColumn": "TotalRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "6380bcde-e91f-48ec-9ced-014d73bc8d5d",
            "sourceColumn": "TotalGrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "1262f259-32ba-45e4-a7be-27e1a767d88e",
            "sourceColumn": "GrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "StateReportTabSortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a5b948f2-25ca-4002-8696-d3da3e7926ea",
            "sourceColumn": "StateReportTabSortOrder",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "780d81d5-0fab-4625-9df0-73ee58d0250c",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "none"
          },
          {
            "name": "Position",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ef961929-cf90-4804-9e9d-9788bdc75cbd",
            "sourceColumn": "Position",
            "summarizeBy": "none"
          },
          {
            "name": "PositionColGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b3dd0a1a-75b4-4cfe-b097-d40120dc5eb9",
            "sourceColumn": "PositionColGroup",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSectionSortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "expression": "1 ",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "a4514d36-8c71-4bc9-82c7-e9c541b906ac",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "5cd2ed58-11f9-490e-bf9d-acbb6ab67917",
        "partitions": [
          {
            "name": "City-2e43bcbc-18b5-4165-986d-502f539da890",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database, [Query=\"select  distinct #(lf)f.taxyear#(lf)--, case g.StateReportTab#(lf)--#(tab)when 'schools' then 1#(lf)--#(tab)when 'county' then 2#(lf)--#(tab)when 'city' then 3#(lf)--#(tab)when 'title 32' then 4#(lf)--#(tab)when 'non 32' then 5#(lf)--#(tab)end StateReportTabSortOrder#(lf)--, case g.StateReportTabSection#(lf)--#(tab)when 'Metro Districts' then 1#(lf)--#(tab)when 'Recreation Districts' then 2#(lf)--#(tab)when 'Fire Protection Districts' then 3#(lf)--#(tab)when 'Water Districts' then 4#(lf)--#(tab)when 'Water & Sanitation Districts' then 5#(lf)--#(tab)when 'Water Conservancy Districts' then 6#(lf)--#(tab)when 'Urban Renewal Authorities' then 7#(lf)--#(tab)when 'Public Improvement Districts' then 8#(lf)--#(tab)when 'Urban Drain & Flood Control Districts' then 9#(lf)--#(tab)when 'Business Improvement Districts' then 10#(lf)--#(tab)end StateReportTabSectionSortOrder#(lf)#(tab)#(lf), a.authorityname TaxingEntity#(lf)--, b.Position#(lf), g.StateReportTab#(lf), g.StateReportTabSection#(lf), a.taxauthority#(lf), a.AUTHORITYTYPE#(lf)--, b.PositionGroup PositionColGroup#(lf)#(lf)--, case #(lf)--#(tab)when StateReportTab in ('city', 'non 32') and b.position in (1, 3, 5) then 1#(lf)--#(tab)when StateReportTab in ('city', 'non 32') and b.position in (2, 4, 6, 7) then 2#(lf)--#(tab)when StateReportTab in ('title 32') and b.position in (1, 5) then 1#(lf)--#(tab)when StateReportTab in ('title 32') and b.position in (2, 3, 6, 7) then 2#(lf)--#(tab)when StateReportTab in ('title 32') and b.position in (4) then 3#(lf)--#(tab)end PositionRowGroup#(lf)#(lf), ROW_NUMBER() over(partition by f.taxyear,a.taxauthority, b.[index] order by b.[index]) rownum#(lf), rank() over(partition by f.taxyear, a.authoritytype order by a.authoritytype, a.authorityname) rownum2#(lf), b.[index], b.FundType#(lf), c.FundID, c.DateOfIssue, c.MaturityDate#(lf), case when isdate(c.dateofissue)<>1 or isdate(c.maturitydate)<>1 then null else DATEDIFF(YEAR, c.DateOfIssue, c.MaturityDate) end TermInYears#(lf), case b.[Index]#(lf)#(tab)when 4 then d.Levy * -1#(lf)#(tab)else d.Levy end Levy#(lf)#(lf)-- DG 8/26/2020#(lf)-- revenue column has been removed.  It is not in use in this report.#(lf)#(lf), e.Certified#(lf), e.GROSSASSESSED#(lf), e.NETASSESSED#(lf), e.TotalLevy#(lf), e.TotalRevenue#(lf)#(lf)-- DG 8/26/2020. The next line of code replaces the calcuation #(lf)-- \"\"convert(decimal(18,0), (e.GROSSASSESSED * e.Totallevy) /1000)\"\"#(lf)-- with the TotalGrossRevenue column in the CERT Table#(lf), convert(decimal(18,0), e.TotalGrossRevenue) TotalGrossRevenue#(tab)#(lf)#(lf)-- The next 3 lines of code replace the calculation #(lf)-- \"\"convert(decimal(18,0), (e.GROSSASSESSED * d.levy) /1000)\"\"#(lf)-- with the GrossRevenue column in the FundYear table#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(lf)--, case b.[index]#(tab)#(lf)-- when 4 then convert(decimal(18,0), -1 * (e.GROSSASSESSED * d.levy) /1000)#(lf)-- else convert(decimal(18,0), (e.GROSSASSESSED * d.levy) /1000) end GrossRevenue#(lf),case b.[index]#(lf)when 4 then -1 * d.GrossRevenue#(lf)else d.GrossRevenue end GrossRevenue#(tab)#(lf)#(lf)#(lf)from encompass.tlkptaxauthority a#(lf)full join millap.fundtype b on b.position >= 1#(lf)join encompass.TLKPTAXAUTHORITYDETAIL f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR >=2018 --and coalesce(f.taxyear, 2018) = 2018#(lf)left join millap.fund c on (c.TaxAuthority = a.TAXAUTHORITY or c.TaxAuthority is null) and (c.fundtypeindex = b.[index] or c.fundtypeindex is null)#(lf)left join millap.fundyear d on d.FundID = c.FundID  and d.TaxYear = f.TAXYEAR--and coalesce(d.taxyear, 2018) = 2018 #(lf)left join millap.cert e on e.TaxYear = d.TaxYear and e.TaxAuthority = a.TAXAUTHORITY#(lf)left join millap.TAXAUTHORITYINFO g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(lf)where a.TAXAUTHORITY is not null#(lf)and f.ACTIVEFLAG = 1#(lf)and g.StateReportTab = 'city'#(lf)--and f.TAXYEAR = @TaxYear#(lf)\"]),",
                "    #\"Added Custom\" = Table.AddColumn(Source, \"StateReportTabSortOrder\", each 3),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Added Custom\",{{\"taxyear\", Int64.Type}}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Changed Type\", {\"index\"}, FundType_Position, {\"Index\"}, \"FundType_Position\", JoinKind.Inner),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged Queries\", \"FundType_Position\", {\"PositionRowGroup_City\", \"Position_City\", \"PositionColGroup_City\"}, {\"PositionRowGroup_City\", \"Position_City\", \"PositionColGroup_City\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Expanded FundType_Position\",{{\"PositionRowGroup_City\", \"PositionRowGroup\"}, {\"Position_City\", \"Position\"}, {\"PositionColGroup_City\", \"PositionColGroup\"}}),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Renamed Columns\",{{\"PositionColGroup\", Int64.Type}, {\"Position\", Int64.Type}, {\"PositionRowGroup\", Int64.Type}}),",
                "    #\"Replaced Value\" = Table.ReplaceValue(#\"Changed Type1\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"DateOfIssue\"}),",
                "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Replaced Value\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"MaturityDate\"}),",
                "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",0,null,Replacer.ReplaceValue,{\"TermInYears\"}),",
                "    #\"Filtered Rows\" = Table.SelectRows(#\"Replaced Value2\", each ([taxyear] = 2023))",
                "in",
                "    #\"Filtered Rows\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "County",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "f2e20e0c-46b5-4d8c-bff4-d86469b7fed7",
            "sourceColumn": "TaxYear",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c1b6bfd8-8dd7-44dd-ad5f-9267ff4096c3",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTab",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a7061bce-a5a2-4f20-9ba7-0c4b2c30386b",
            "sourceColumn": "StateReportTab",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "32057298-4bb4-4151-a00b-f2dd8a369743",
            "sourceColumn": "StateReportTabSortOrder",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "8a5bc654-b1c6-4f64-a5e6-b4ccfd56b894",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          },
          {
            "name": "taxauthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ecf37d9f-fb19-4620-bf3a-6372516238e4",
            "sourceColumn": "taxauthority",
            "summarizeBy": "none"
          },
          {
            "name": "AUTHORITYTYPE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4f19b246-f111-4ea1-a658-f55e3cdd2f6c",
            "sourceColumn": "AUTHORITYTYPE",
            "summarizeBy": "none"
          },
          {
            "name": "PositionColGroup_Old",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "8f0d0f95-9c79-41ac-91ed-e6131042fd54",
            "sourceColumn": "PositionColGroup_Old",
            "summarizeBy": "none"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "48e81e03-f7d7-4d0b-ae4b-bdb19ea3c917",
            "sourceColumn": "rownum",
            "summarizeBy": "none"
          },
          {
            "name": "rownum2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d5b74499-e539-432b-9a86-adc3faf729b6",
            "sourceColumn": "rownum2",
            "summarizeBy": "none"
          },
          {
            "name": "index",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b0a92154-58b9-4935-a221-d215f6f05355",
            "sourceColumn": "index",
            "summarizeBy": "sum"
          },
          {
            "name": "FundType",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ee12a898-81b6-4d00-a3df-5d09a0705edc",
            "sourceColumn": "FundType",
            "summarizeBy": "none"
          },
          {
            "name": "FundID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "1d599ea3-4b0a-4cdb-a264-1feb298d1f6c",
            "sourceColumn": "FundID",
            "summarizeBy": "none"
          },
          {
            "name": "DateOfIssue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "04c69290-db00-4ce0-b7ec-1f8f4e929907",
            "sourceColumn": "DateOfIssue",
            "summarizeBy": "none"
          },
          {
            "name": "MaturityDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f2188837-98c3-412f-ac5c-11959160d409",
            "sourceColumn": "MaturityDate",
            "summarizeBy": "none"
          },
          {
            "name": "TermInYears",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "34772621-2bd7-47e6-8816-1c279e6df253",
            "sourceColumn": "TermInYears",
            "summarizeBy": "none"
          },
          {
            "name": "Levy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "40302811-a1ac-4027-b247-2e7cc7c93ebc",
            "sourceColumn": "Levy",
            "summarizeBy": "sum"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a7994f46-0105-430e-a442-9dd35b4c3e74",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "2d1ac150-2623-4e3e-b382-bf516d256fd7",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "NETASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "bc9e7f3f-ab37-4e85-9acc-0d0fbaedcfe8",
            "sourceColumn": "NETASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "5a6e72dd-5a1a-43d3-9105-bf80160c1153",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "7b5d061a-0533-4363-beb7-5734cef5294f",
            "sourceColumn": "TotalRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "ab6fc51f-928a-469d-81f8-2ccccf3943ff",
            "sourceColumn": "TotalGrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "b9c5d4a9-7a69-4ce1-beca-43a07168b6ec",
            "sourceColumn": "GrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "CountyCode",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2f7f7b90-e0c2-488b-beb4-25ace9d6c7e9",
            "sourceColumn": "CountyCode",
            "summarizeBy": "none"
          },
          {
            "name": "CountyPosition",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4b43f0fa-dfdc-4cf4-b6b9-08d7696a288f",
            "sourceColumn": "CountyPosition",
            "summarizeBy": "none"
          },
          {
            "name": "CountyColumnGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "23ad9734-2b97-40a0-966a-d0844da72930",
            "sourceColumn": "CountyColumnGroup",
            "summarizeBy": "none"
          },
          {
            "name": "Position",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "eb1886b2-9d22-42fc-a341-8b2e8bf7e228",
            "sourceColumn": "Position",
            "summarizeBy": "none"
          },
          {
            "name": "PositionColGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "75df2c3d-d9ed-46d7-bc23-710c9b41c8ac",
            "sourceColumn": "PositionColGroup",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ff9b592b-3b52-478c-b652-3c7d065d423d",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "ea0c4572-c390-43b1-971a-9a2243a939b2",
        "partitions": [
          {
            "name": "County-041709aa-a4c0-4064-a35e-6f41386d1d23",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database, [Query=\"--County#(lf)select  distinct#(lf)f.taxyear#(lf)--, case g.StateReportTab#(lf)--#(tab)when 'schools' then 1#(lf)--#(tab)when 'county' then 2#(lf)--#(tab)when 'city' then 3#(lf)--#(tab)when 'title 32' then 4#(lf)--#(tab)when 'non 32' then 5#(lf)--#(tab)end StateReportTabSortOrder#(lf)--, case g.StateReportTabSection#(lf)--#(tab)when 'Metro Districts' then 1#(lf)--#(tab)when 'Recreation Districts' then 2#(lf)--#(tab)when 'Fire Protection Districts' then 3#(lf)--#(tab)when 'Water Districts' then 4#(lf)--#(tab)when 'Water & Sanitation Districts' then 5#(lf)--#(tab)when 'Water Conservancy Districts' then 6#(lf)--#(tab)when 'Urban Renewal Authorities' then 7#(lf)--#(tab)when 'Public Improvement Districts' then 8#(lf)--#(tab)when 'Urban Drain & Flood Control Districts' then 9#(lf)--#(tab)when 'Business Improvement Districts' then 10 else 1#(lf)--#(tab)end StateReportTabSectionSortOrder#(lf)#(tab)#(lf), a.authorityname TaxingEntity--, b.Position#(lf), g.StateReportTab, g.StateReportTabSection#(lf), a.taxauthority, a.AUTHORITYTYPE#(lf), b.PositionGroup PositionColGroup#(lf)#(lf)--, case #(lf)--#(tab)when StateReportTab in ('city', 'non 32') and b.position in (1, 3, 5) then 1#(lf)--#(tab)when StateReportTab in ('city', 'non 32') and b.position in (2, 4, 6, 7) then 2#(lf)--#(tab)when StateReportTab in ('title 32') and b.position in (1, 5) then 1#(lf)--#(tab)when StateReportTab in ('title 32') and b.position in (2, 3, 6, 7) then 2#(lf)--#(tab)when StateReportTab in ('title 32') and b.position in (4) then 3 else 1#(lf)--#(tab)end PositionRowGroup#(lf)#(lf), ROW_NUMBER() over(partition by f.taxyear, a.taxauthority, b.[index] order by b.[index]) rownum#(lf), rank() over(partition by f.taxyear, a.authoritytype order by a.authoritytype, a.authorityname) rownum2#(lf), b.[index], b.FundType#(lf), c.FundID, c.DateOfIssue, c.MaturityDate#(lf), case when isdate(c.dateofissue)<>1 or isdate(c.maturitydate)<>1 then null else DATEDIFF(YEAR, c.DateOfIssue, c.MaturityDate) end TermInYears#(lf), case b.[Index]#(lf)#(tab)when 4 then d.Levy * -1#(lf)#(tab)else d.Levy end Levy#(lf)#(lf)-- DG 8/26/2020#(lf)-- revenue column has been removed.  It is not in use in this report.#(lf)#(lf), e.Certified#(lf), e.GROSSASSESSED#(lf), e.NETASSESSED#(lf), e.TotalLevy#(lf), e.TotalRevenue#(lf)#(lf)-- DG 8/26/2020. The next line of code replaces the calcuation #(lf)-- \"\"convert(decimal(18,0), (e.GROSSASSESSED * e.Totallevy) /1000)\"\"#(lf)-- with the TotalGrossRevenue column in the CERT Table#(lf), convert(decimal(18,0), e.TotalGrossRevenue) TotalGrossRevenue#(tab)#(lf)#(lf)-- The next 3 lines of code replace the calculation #(lf)-- \"\"convert(decimal(18,0), (e.GROSSASSESSED * d.levy) /1000)\"\"#(lf)-- with the GrossRevenue column in the FundYear table#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(lf)--, case b.[index]#(tab)#(lf)-- when 4 then convert(decimal(18,0), -1 * (e.GROSSASSESSED * d.levy) /1000)#(lf)-- else convert(decimal(18,0), (e.GROSSASSESSED * d.levy) /1000) end GrossRevenue#(lf),case b.[index]#(lf)when 4 then -1 * d.GrossRevenue#(lf)else d.GrossRevenue end GrossRevenue#(tab)#(lf)#(lf)--, b.CountyCode, b.CountyPosition#(lf)--, ISNULL(b.CountyColumnGroup, 'GENERAL REVENUE') as CountyColumnGroup#(lf)#(lf)from encompass.tlkptaxauthority a#(lf)full join millap.fundtype b on isnull(b.countyposition, 1) >= 1#(lf)join encompass.TLKPTAXAUTHORITYDETAIL f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR >=2018 --and coalesce(f.taxyear, 2018) = 2018#(lf)left join millap.fund c on (c.TaxAuthority = a.TAXAUTHORITY or c.TaxAuthority is null) and (c.fundtypeindex = b.[index] or c.fundtypeindex is null)#(lf)left join millap.fundyear d on d.FundID = c.FundID  and d.TaxYear = f.TAXYEAR--and coalesce(d.taxyear, 2018) = 2018 #(lf)left join millap.cert e on e.TaxYear = d.TaxYear and e.TaxAuthority = a.TAXAUTHORITY#(lf)left join millap.TAXAUTHORITYINFO g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(lf)where 1=1#(lf)and a.TAXAUTHORITY is not null#(lf)and f.ACTIVEFLAG = 1#(lf)and g.StateReportTab = 'county'#(lf)and b.CountyCode is not null#(lf)--and f.TAXYEAR = @TaxYear#(lf)order by 1, 2, 3, 4, 5#(lf)\"]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"taxyear\", Int64.Type}}),",
                "    #\"Filtered Rows\" = Table.SelectRows(#\"Changed Type\", each ([taxyear] = 2023)),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Filtered Rows\", \"StateReportTabSortOrder\", each 2),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Added Custom\", {\"index\"}, FundType_Position, {\"Index\"}, \"FundType_Position\", JoinKind.Inner),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged Queries\", \"FundType_Position\", {\"CountyCode\", \"CountyColumnGroup\", \"CountyPosition\", \"Position_County\", \"PositionColGroup_County\", \"PositionRowGroup_County\"}, {\"CountyCode\", \"CountyColumnGroup\", \"CountyPosition\", \"Position_County\", \"PositionColGroup_County\", \"PositionRowGroup_County\"}),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Expanded FundType_Position\",{{\"Position_County\", Int64.Type}, {\"PositionColGroup_County\", Int64.Type}, {\"PositionRowGroup_County\", Int64.Type}}),",
                "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Changed Type1\",{{\"PositionColGroup\", \"PositionColGroup_Old\"}}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Renamed Columns1\",{{\"Position_County\", \"Position\"}, {\"PositionColGroup_County\", \"PositionColGroup\"}, {\"PositionRowGroup_County\", \"PositionRowGroup\"}, {\"taxyear\", \"TaxYear\"}})",
                "in",
                "    #\"Renamed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "NON 32",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "columns": [
          {
            "name": "taxyear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "88c51ef0-b483-4de8-960b-9a229a1da384",
            "sourceColumn": "taxyear",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "255bac47-ebe8-4c92-893a-cfe4a430121c",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTab",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7b1f7b74-74b3-4040-912a-eb7bf3846f44",
            "sourceColumn": "StateReportTab",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4cb2c2c0-bae4-442c-81dd-8f9287bf7f84",
            "sourceColumn": "StateReportTabSortOrder",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "804247de-c394-4973-b976-e03371c09948",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          },
          {
            "name": "taxauthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "9eff42eb-caab-498b-85be-0466cf32f571",
            "sourceColumn": "taxauthority",
            "summarizeBy": "none"
          },
          {
            "name": "AUTHORITYTYPE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "9101f7c3-a1c9-4c07-b0b2-4883c1759eff",
            "sourceColumn": "AUTHORITYTYPE",
            "summarizeBy": "none"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "dbc3a675-5e5e-4229-b0c5-7b85826435bc",
            "sourceColumn": "rownum",
            "summarizeBy": "none"
          },
          {
            "name": "rownum2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4cdc7825-23d5-4f06-a1b2-b139abc697de",
            "sourceColumn": "rownum2",
            "summarizeBy": "none"
          },
          {
            "name": "rownum3",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d981d80e-b644-49d4-82dc-1bc0888ff1d1",
            "sourceColumn": "rownum3",
            "summarizeBy": "none"
          },
          {
            "name": "index",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c2efb86c-e877-4fc5-a754-415cbefc5918",
            "sourceColumn": "index",
            "summarizeBy": "sum"
          },
          {
            "name": "FundType",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6f4d4419-131c-4ca4-acc2-9b895319f120",
            "sourceColumn": "FundType",
            "summarizeBy": "none"
          },
          {
            "name": "FundID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "8d708b89-4550-4a0a-9d3e-4dcedcec784e",
            "sourceColumn": "FundID",
            "summarizeBy": "none"
          },
          {
            "name": "DateOfIssue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "0c1830e9-e73c-4d6b-9aed-f86c68a719df",
            "sourceColumn": "DateOfIssue",
            "summarizeBy": "none"
          },
          {
            "name": "MaturityDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "158198de-303c-49d7-84d6-b4205999a49e",
            "sourceColumn": "MaturityDate",
            "summarizeBy": "none"
          },
          {
            "name": "TermInYears",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "fbd0b724-d257-4830-8ce0-f32ed50ce22d",
            "sourceColumn": "TermInYears",
            "summarizeBy": "none"
          },
          {
            "name": "Levy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "941a11db-c678-419b-b237-37a6e72d7b1d",
            "sourceColumn": "Levy",
            "summarizeBy": "sum"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "bb8e3719-ff5b-4208-b4b3-a1d7cdc58db3",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "0ea26d3f-b45b-475d-97da-a02597439c41",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "NETASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "41774ad9-5bc4-4157-a599-5c01c7fb5cdf",
            "sourceColumn": "NETASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "fdf6b747-121b-4497-8191-93418c501437",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "4408625a-8c16-4fb4-9d18-14be819f5a79",
            "sourceColumn": "TotalRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "e7540773-cd35-4ae7-92b2-8b9eab4d3a71",
            "sourceColumn": "TotalGrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "ec058f38-ccbf-4cb6-89b8-9d88672305c8",
            "sourceColumn": "GrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "f8878b9d-67bb-4f0c-b6e5-894683901c12",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "none"
          },
          {
            "name": "Position",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "260a90d4-51cb-43cb-b321-3101d523969f",
            "sourceColumn": "Position",
            "summarizeBy": "none"
          },
          {
            "name": "PositionColGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "95ab3e07-0e34-4208-aa48-e4ea5625d749",
            "sourceColumn": "PositionColGroup",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "5d334e33-7819-497a-a10c-e13fb5cdb373",
        "partitions": [
          {
            "name": "NON 32-f9fa7e0f-8431-41a5-af51-ecf65c134e5f",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database, [Query=\"--NON 32#(lf)select  distinct #(lf)f.taxyear#(lf)--, case g.StateReportTab#(lf)--#(tab)when 'schools' then 1#(lf)--#(tab)when 'county' then 2#(lf)--#(tab)when 'city' then 3#(lf)--#(tab)when 'title 32' then 4#(lf)--#(tab)when 'non 32' then 5#(lf)--#(tab)end StateReportTabSortOrder#(lf)--, case g.StateReportTabSection#(lf)--#(tab)when 'Metro Districts' then 1#(lf)--#(tab)when 'Recreation Districts' then 2#(lf)--#(tab)when 'Fire Protection Districts' then 3#(lf)--#(tab)when 'Water Districts' then 4#(lf)--#(tab)when 'Water & Sanitation Districts' then 5#(lf)--#(tab)when 'Water Conservancy Districts' then 6#(lf)--#(tab)when 'Urban Renewal Authorities' then 7#(lf)--#(tab)when 'Public Improvement Districts' then 8#(lf)--#(tab)when 'Urban Drain & Flood Control Districts' then 9#(lf)--#(tab)when 'Business Improvement Districts' then 10#(lf)--#(tab)end StateReportTabSectionSortOrder#(lf)#(tab)#(lf), a.authorityname TaxingEntity--, b.Position#(lf), g.StateReportTab, g.StateReportTabSection#(lf), a.taxauthority, a.AUTHORITYTYPE#(lf)--, b.PositionGroup PositionColGroup#(lf)#(lf)--, case #(lf)--#(tab)when StateReportTab in ('city', 'non 32') and b.position in (1, 3, 5) then 1#(lf)--#(tab)when StateReportTab in ('city', 'non 32') and b.position in (2, 4, 6, 7) then 2#(lf)--#(tab)when StateReportTab in ('title 32') and b.position in (1, 5) then 1#(lf)--#(tab)when StateReportTab in ('title 32') and b.position in (2, 3, 6, 7) then 2#(lf)--#(tab)when StateReportTab in ('title 32') and b.position in (4) then 3#(lf)--#(tab)end PositionRowGroup#(lf)#(lf), ROW_NUMBER() over(partition by f.TAXYEAR, a.taxauthority, b.[index] order by d.levy desc) rownum#(lf), rank() over(partition by f.TAXYEAR, a.authoritytype order by a.authoritytype, a.authorityname) rownum2#(lf), ROW_NUMBER() over(partition by f.TAXYEAR, a.taxauthority order by e.grossassessed desc) rownum3 --grossassessed#(lf), b.[index], b.FundType#(lf), c.FundID, c.DateOfIssue, c.MaturityDate#(lf), case when isdate(c.dateofissue)<>1 or isdate(c.maturitydate)<>1 then null else DATEDIFF(YEAR, c.DateOfIssue, c.MaturityDate) end TermInYears#(lf), case b.[Index]#(lf)#(tab)when 4 then d.Levy * -1#(lf)#(tab)else d.Levy end Levy#(lf)#(lf)-- DG 8/26/2020#(lf)-- revenue column has been removed.  It is not in use in this report.#(lf)#(lf), e.Certified#(lf), e.GROSSASSESSED#(lf), e.NETASSESSED#(lf), e.TotalLevy#(lf), e.TotalRevenue#(lf)#(lf)-- DG 8/26/2020. The next line of code replaces the calcuation #(lf)-- \"\"convert(decimal(18,0), (e.GROSSASSESSED * e.Totallevy) /1000)\"\"#(lf)-- with the TotalGrossRevenue column in the CERT Table#(lf), convert(decimal(18,0), e.TotalGrossRevenue) TotalGrossRevenue#(tab)#(lf)#(lf)-- The next 3 lines of code replace the calculation #(lf)-- \"\"convert(decimal(18,0), (e.GROSSASSESSED * d.levy) /1000)\"\"#(lf)-- with the GrossRevenue column in the FundYear table#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)#(lf)--, case b.[index]#(tab)#(lf)-- when 4 then convert(decimal(18,0), -1 * (e.GROSSASSESSED * d.levy) /1000)#(lf)--else convert(decimal(18,0), (e.GROSSASSESSED * d.levy) /1000) end GrossRevenue#(lf),case b.[index]#(lf)when 4 then -1 * d.GrossRevenue#(lf)else d.GrossRevenue end GrossRevenue#(lf)#(lf)from encompass.tlkptaxauthority a#(lf)full join millap.fundtype b on b.position >= 1#(lf)join encompass.TLKPTAXAUTHORITYDETAIL f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR >=2018 --and coalesce(f.taxyear, 2018) = 2018#(lf)left join millap.fund c on (c.TaxAuthority = a.TAXAUTHORITY or c.TaxAuthority is null) and (c.fundtypeindex = b.[index] or c.fundtypeindex is null)#(lf)left join millap.fundyear d on d.FundID = c.FundID  and d.TaxYear = f.TAXYEAR--and coalesce(d.taxyear, 2018) = 2018 #(lf)left join millap.cert e on e.TaxYear = d.TaxYear and e.TaxAuthority = a.TAXAUTHORITY#(lf)left join millap.TAXAUTHORITYINFO g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(lf)where a.TAXAUTHORITY is not null#(lf)and f.ACTIVEFLAG = 1#(lf)and g.StateReportTab = 'NON 32'#(lf)--and f.TAXYEAR = @TaxYear#(lf)order by 1, 2, 3, 4, 5\", CreateNavigationProperties=false]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"taxyear\", Int64.Type}}),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Changed Type\", \"StateReportTabSortOrder\", each 5),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Custom\",{\"taxyear\", \"TaxingEntity\", \"StateReportTab\", \"StateReportTabSortOrder\", \"StateReportTabSection\", \"taxauthority\", \"AUTHORITYTYPE\", \"rownum\", \"rownum2\", \"rownum3\", \"index\", \"FundType\", \"FundID\", \"DateOfIssue\", \"MaturityDate\", \"TermInYears\", \"Levy\", \"Certified\", \"GROSSASSESSED\", \"NETASSESSED\", \"TotalLevy\", \"TotalRevenue\", \"TotalGrossRevenue\", \"GrossRevenue\"}),",
                "    #\"Trimmed Text\" = Table.TransformColumns(#\"Reordered Columns\",{{\"StateReportTabSection\", Text.Trim, type text}}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Trimmed Text\", {\"index\"}, FundType_Position, {\"Index\"}, \"FundType_Position\", JoinKind.Inner),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged Queries\", \"FundType_Position\", {\"PositionRowGroup_Non_32\", \"Position_NON_32\", \"PositionColGroup_NON_32\"}, {\"PositionRowGroup_Non_32\", \"Position_NON_32\", \"PositionColGroup_NON_32\"}),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Expanded FundType_Position\",{{\"PositionRowGroup_Non_32\", Int64.Type}, {\"Position_NON_32\", Int64.Type}, {\"PositionColGroup_NON_32\", Int64.Type}}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Changed Type1\",{{\"PositionRowGroup_Non_32\", \"PositionRowGroup\"}, {\"Position_NON_32\", \"Position\"}, {\"PositionColGroup_NON_32\", \"PositionColGroup\"}})",
                "in",
                "    #\"Renamed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Title 32",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "columns": [
          {
            "name": "taxyear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "int64",
            "lineageTag": "46cb9b75-e752-4c7d-bc85-d898acfd18cb",
            "sourceColumn": "taxyear",
            "summarizeBy": "none"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "64534051-b7b5-469d-a830-0077c984df4d",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "none"
          },
          {
            "name": "MetroDistricts",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4c787026-30d1-486a-ad30-276be41753b1",
            "sourceColumn": "MetroDistricts",
            "summarizeBy": "none"
          },
          {
            "name": "NearestTenDollars",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-US\"}"
              }
            ],
            "dataType": "decimal",
            "formatString": "\\$#,0.###############;(\\$#,0.###############);\\$#,0.###############",
            "lineageTag": "21591dd0-8453-4bb6-8bde-91615f1a6ccf",
            "sourceColumn": "NearestTenDollars",
            "summarizeBy": "sum"
          },
          {
            "name": "r",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4c283387-27a2-4bc8-a8f8-5066cc23127c",
            "sourceColumn": "r",
            "summarizeBy": "none"
          },
          {
            "name": "Levy1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "FormatString"
              }
            ],
            "dataType": "double",
            "formatString": "0.000",
            "lineageTag": "e2a922c2-361f-4c8d-8bc1-a7c3fa0bad09",
            "sourceColumn": "Levy1",
            "summarizeBy": "none"
          },
          {
            "name": "Revenue1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-US\"}"
              }
            ],
            "dataType": "decimal",
            "formatString": "\\$#,0.###############;(\\$#,0.###############);\\$#,0.###############",
            "lineageTag": "58ed16d4-46f1-462b-95a3-b7adbced18e2",
            "sourceColumn": "Revenue1",
            "summarizeBy": "none"
          },
          {
            "name": "Levy3",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "FormatString"
              }
            ],
            "dataType": "double",
            "formatString": "0.000",
            "lineageTag": "f4b5c72c-a95a-4baa-890a-0a390489612b",
            "sourceColumn": "Levy3",
            "summarizeBy": "none"
          },
          {
            "name": "Revenue3",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-US\"}"
              }
            ],
            "dataType": "decimal",
            "formatString": "\\$#,0.###############;(\\$#,0.###############);\\$#,0.###############",
            "lineageTag": "e7b19c7b-53ec-43d0-9081-2439fc61df72",
            "sourceColumn": "Revenue3",
            "summarizeBy": "none"
          },
          {
            "name": "Pos3",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d3be9942-5cf1-4202-8b5d-94a541ac6347",
            "sourceColumn": "Pos3",
            "summarizeBy": "none"
          },
          {
            "name": "Levy5",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "FormatString"
              }
            ],
            "dataType": "double",
            "formatString": "0.000",
            "lineageTag": "3e8951d4-6c18-42f2-b686-770ba55c8acc",
            "sourceColumn": "Levy5",
            "summarizeBy": "none"
          },
          {
            "name": "Revenue5",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-US\"}"
              }
            ],
            "dataType": "decimal",
            "formatString": "\\$#,0.###############;(\\$#,0.###############);\\$#,0.###############",
            "lineageTag": "7af5a448-51d3-40af-91ed-a3d396ff2570",
            "sourceColumn": "Revenue5",
            "summarizeBy": "none"
          },
          {
            "name": "Levy7",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "FormatString"
              }
            ],
            "dataType": "double",
            "formatString": "0.000",
            "lineageTag": "67d0622a-dd36-45f3-b7e8-e946a8d375e6",
            "sourceColumn": "Levy7",
            "summarizeBy": "none"
          },
          {
            "name": "Revenue7",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-US\"}"
              }
            ],
            "dataType": "decimal",
            "formatString": "\\$#,0.###############;(\\$#,0.###############);\\$#,0.###############",
            "lineageTag": "f95a84c6-ac24-45a6-ae51-de3e4c016e77",
            "sourceColumn": "Revenue7",
            "summarizeBy": "none"
          },
          {
            "name": "DeptUse",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "\"_____\"",
            "isDataTypeInferred": true,
            "lineageTag": "88725310-e989-48ed-83a6-ae51ee92d62e",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ccb3976e-23ff-4445-9465-d01bf0e93e87",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSectionSortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "9d09ac57-ff45-45f2-8963-ba3bb319f17f",
            "sourceColumn": "StateReportTabSectionSortOrder",
            "summarizeBy": "none"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4d483993-04fe-4478-8b46-3727f66e16af",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "Pos1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "84aab00d-5c11-4713-bd31-e1c7348dd518",
            "sourceColumn": "Pos1",
            "summarizeBy": "none"
          },
          {
            "name": "BondDateofIssue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e7d333e6-bf55-4568-8b3b-baf4de115d3f",
            "sourceColumn": "BondDateofIssue",
            "summarizeBy": "none"
          },
          {
            "name": "TermInYears",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ecd637bd-eeb9-4768-84a1-40f4d0654568",
            "sourceColumn": "TermInYears",
            "summarizeBy": "none"
          },
          {
            "name": "Pos5",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "a17c8696-b0ac-4408-9bc0-84a4aede03be",
            "sourceColumn": "Pos5",
            "summarizeBy": "none"
          },
          {
            "name": "Pos7",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "597ed60e-fc9b-4071-9ff5-f1bf68d80985",
            "sourceColumn": "Pos7",
            "summarizeBy": "none"
          },
          {
            "name": "Levy1Display",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "caae094e-55c1-444e-a97b-9af10f1d7f45",
            "sourceColumn": "Levy1Display",
            "summarizeBy": "none"
          },
          {
            "name": "Levy3Display",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4f59bd55-e32f-45cd-90f5-c4c4b5ea977a",
            "sourceColumn": "Levy3Display",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f308bf63-e5df-48a3-b8e7-4b31cb8d2c0f",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "none"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-US\"}"
              }
            ],
            "dataType": "decimal",
            "expression": "'Title 32'[Revenue1] + 'Title 32'[Revenue3] + 'Title 32'[Revenue5] + 'Title 32'[Revenue7]",
            "formatString": "\\$#,0.###############;(\\$#,0.###############);\\$#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "654c12dc-5671-4ba5-8f86-bb983aeae908",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "TotalGrossLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "FormatString"
              }
            ],
            "dataType": "double",
            "expression": "'Title 32'[Levy1]+'Title 32'[Levy3]+'Title 32'[Levy5]+'Title 32'[Levy7]",
            "formatString": "0.000",
            "isDataTypeInferred": true,
            "lineageTag": "de88a720-6e26-49a1-b595-4b251fc5d5c1",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Revenue1Display",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "fd904be8-474c-405a-a0d4-d894e7f7a125",
            "sourceColumn": "Revenue1Display",
            "summarizeBy": "none"
          },
          {
            "name": "Revenue3Display",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "471409db-18cf-476c-8cf2-9a9ad24e15bd",
            "sourceColumn": "Revenue3Display",
            "summarizeBy": "none"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "936b21cc-8643-4baa-941a-a980819a01a9",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-US\"}"
              }
            ],
            "dataType": "decimal",
            "formatString": "\\$#,0.###############;(\\$#,0.###############);\\$#,0.###############",
            "lineageTag": "8f512370-dbac-43ff-a9fb-6a2d1178c67c",
            "sourceColumn": "TotalRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalRowNum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "if ( 'Title 32'[TotalLevy] = blank(), blank(), 1)",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "6ffbf57b-9532-427f-a4b2-4eeae4e769b2",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Levy5Display",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f8bd71c2-58d5-4c39-ae8f-397687ce936d",
            "sourceColumn": "Levy5Display",
            "summarizeBy": "none"
          },
          {
            "name": "Revenue5Display",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "17eb66b3-60ee-4f3a-85dd-4015b690de03",
            "sourceColumn": "Revenue5Display",
            "summarizeBy": "none"
          },
          {
            "name": "NearestTenDollarsTotal",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-US\"}"
              }
            ],
            "dataType": "decimal",
            "expression": "if('Title 32'[r] = 1 && 'Title 32'[PositionRowGroup] = \"1\", 'Title 32'[NearestTenDollars], BLANK())",
            "formatString": "\\$#,0.###############;(\\$#,0.###############);\\$#,0.###############",
            "isDataTypeInferred": true,
            "lineageTag": "ba653133-40bf-4d08-a4fa-136d63ef82b4",
            "summarizeBy": "sum",
            "type": "calculated"
          }
        ],
        "lineageTag": "865ae39e-a1d2-48ca-a214-3a1de9c1012d",
        "measures": [
          {
            "name": "Measure",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-US\"}"
              }
            ],
            "expression": "sum('Title 32'[NearestTenDollarsTotal])",
            "formatString": "\\$#,0.###############;(\\$#,0.###############);\\$#,0.###############",
            "lineageTag": "306dbc43-1ca0-49e9-ad6c-f0b90e76fead"
          }
        ],
        "partitions": [
          {
            "name": "Title 32-c3191419-9730-4a4f-9910-60492e41464f",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database, [Query=\"declare @TaxYear int = 2023;#(lf)with ta (taxyear,StateReportTabSection,TaxAuthority, MetroDistricts, Certified, NearestTenDollars, TotalLevy, TotalRevenue, r) AS (#(lf)#(tab)SELECT #(lf)#(tab)#(tab) f.taxyear#(lf)#(tab)#(tab),i.StateReportTabSection#(lf)#(tab)#(tab),a.TAXAUTHORITY TaxAuthority#(lf)#(tab)#(tab),a.authorityname MetroDistricts#(lf)#(tab)#(tab),e.Certified#(lf)#(tab)#(tab),NearestTenDollars = MAX(e.GROSSASSESSED)#(lf)#(tab)#(tab),TotalLevy = MAX(e.TotalLevy)#(lf)#(tab)#(tab),TotalRevenue = MAX(e.TotalRevenue)#(lf)#(tab)#(tab),nums.r#(lf)#(tab)FROM encompass.tlkptaxauthority a #(lf)#(tab)#(tab)join millap.TAXAUTHORITYINFO i on a.TAXAUTHORITY = i.TAXAUTHORITY#(lf)#(tab)#(tab)JOIN encompass.TLKPTAXAUTHORITYDETAIL f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR = @TaxYear#(lf)#(tab)#(tab)LEFT JOIN (#(tab)SELECT #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab) TaxYear --= @TaxYear#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab),TaxAuthority#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab),Certified#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab),TotalLevy = MAX(TotalLevy)#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab),TotalRevenue = MAX(TotalGrossRevenue)#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab),GROSSASSESSED = MAX(GROSSASSESSED)#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)FROM millap.cert#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)where TaxYear = @TaxYear#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)GROUP BY #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)TaxYear, Certified, TaxAuthority) e on e.TaxYear = f.TaxYear and e.TaxAuthority = a.TAXAUTHORITY#(lf)#(tab)#(tab)LEFT JOIN millap.TAXAUTHORITYINFO g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(tab)#(tab)cross join (#(lf)#(tab)#(tab)SELECT r = ones.n + 10*tens.n#(lf)#(tab)#(tab)#(tab)FROM (VALUES(0),(1),(2),(3),(4),(5),(6),(7),(8),(9)) ones(n),#(lf)#(tab)#(tab)#(tab)#(tab) (VALUES(0),(1),(2),(3),(4),(5),(6),(7),(8),(9)) tens(n)#(lf)#(tab)#(tab)#(tab)where ones.n + 10*tens.n between 1 and 99#(lf)#(tab)#(tab)#(tab)--ORDER BY 1 #(lf)#(tab)#(tab)#(tab)) nums#(lf)#(lf)#(tab)WHERE f.ACTIVEFLAG = 1#(lf)#(tab)#(tab)and g.StateReportTab = 'TITLE 32'#(lf)#(tab)#(tab)and f.taxyear = @TaxYear#(lf)#(tab)#(tab)--and a.TAXAUTHORITY = 4460 #(lf)#(tab)group by #(lf)#(tab)#(tab) f.taxyear#(lf)#(tab)#(tab),i.StateReportTabSection#(lf)#(tab)#(tab),a.TAXAUTHORITY #(lf)#(tab)#(tab),a.authorityname #(lf)#(tab)#(tab),e.Certified#(lf)#(tab)#(tab),nums.r#(lf)#(tab)--order by 1,2,3,9#(lf)#(lf)),#(lf)l12 as #(lf)(#(lf)#(tab)select #(lf)#(tab)#(tab) f.taxyear#(lf)#(tab)#(tab),a.TaxAuthority#(lf)#(tab)#(tab),Levy1 = case when b.FundType = 'TEMP TAX CREDIT' then d.Levy * -1 else d.Levy end#(lf)#(tab)#(tab),Revenue1 = case when b.FundType = 'TEMP TAX CREDIT' then d.GrossRevenue * -1 else d.GrossRevenue end#(lf)#(tab)#(tab),BondDateofIssue = null --nullif(c.DateOfIssue,'1900-01-01') --CONCAT('Bond Date: ', c.DateOfIssue)#(lf)#(tab)#(tab),TermInYears = null --nullif(convert(varchar(3), DATEDIFF(YEAR, c.DateOfIssue, c.MaturityDate)),'0')#(lf)#(tab)#(tab),R = RANK () OVER ( PARTITION BY f.taxyear, a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC)#(lf)#(tab)#(tab)#(tab)#(tab)+ case when b.Position = 1 then 0 else 20 end#(lf)#(lf)#(tab)#(tab),Pos = b.Position --case when RANK () OVER ( PARTITION BY a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC) = 1 then b.Position else null end#(lf)#(tab)FROM encompass.tlkptaxauthority a#(lf)#(tab)#(tab)JOIN encompass.TLKPTAXAUTHORITYDETAIL f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR = @TaxYear #(lf)#(tab)#(tab)JOIN millap.fund c on c.TaxAuthority = a.TAXAUTHORITY #(lf)#(tab)#(tab)LEFT JOIN millap.fundtype b on b.[Index] = c.FundTypeIndex #(lf)#(tab)#(tab)JOIN millap.fundyear d on d.FundID = c.FundID  and d.TaxYear = f.TAXYEAR #(lf)#(tab)#(tab)JOIN millap.TAXAUTHORITYINFO g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(tab)WHERE (b.Position = 1 or b.Position = 2)#(lf)#(tab)#(tab)and f.ACTIVEFLAG = 1#(lf)#(tab)#(tab)and g.StateReportTab = 'TITLE 32'#(lf)#(tab)#(tab)and f.taxyear = @TaxYear#(lf)#(tab)#(tab)--and (isnull(d.GrossRevenue, 0) <> 0 or isnull(d.Levy, 0) <> 0)#(lf)#(tab)--order by 1,2#(lf)),#(lf)l34 as#(lf)(#(lf)#(tab)select #(lf)#(tab)#(tab) f.taxyear#(lf)#(tab)#(tab),a.TaxAuthority#(lf)#(tab)#(tab),Levy3 = d.Levy#(lf)#(tab)#(tab),Revenue3 = d.GrossRevenue#(lf)#(tab)#(tab),BondDateofIssue = case when b.fundtype = 'BOND' then nullif(c.DateOfIssue,'1900-01-01') else null end #(lf)#(tab)#(tab),TermInYears = case #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)when b.fundtype <> 'BOND' or nullif(c.DateOfIssue,'1900-01-01') is null then null #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)else convert(varchar(3), DATEDIFF(YEAR, c.DateOfIssue, c.MaturityDate)) #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)   end#(lf)#(tab)#(tab),R = RANK () OVER ( PARTITION BY f.taxyear, a.TaxAuthority ORDER BY d.GrossRevenue, c.FundID DESC)#(lf)#(tab)#(tab)#(tab) + case when b.Position = 3 then 0 else 40 end#(lf)#(tab)#(tab),Pos = b.Position --case when RANK () OVER ( PARTITION BY a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC) = 1 then b.Position else null end#(lf)#(tab)#(tab),c.FundID#(lf)#(tab)#(tab),b.fundtype#(lf)#(tab)FROM encompass.tlkptaxauthority a#(lf)#(tab)#(tab)JOIN encompass.TLKPTAXAUTHORITYDETAIL f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR = @TaxYear #(lf)#(tab)#(tab)JOIN millap.fund c on c.TaxAuthority = a.TAXAUTHORITY #(lf)#(tab)#(tab)LEFT JOIN millap.fundtype b on b.[Index] = c.FundTypeIndex #(lf)#(tab)#(tab)JOIN millap.fundyear d on d.FundID = c.FundID  and d.TaxYear = f.TAXYEAR #(lf)#(tab)#(tab)JOIN millap.TAXAUTHORITYINFO g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(tab)WHERE (b.Position = 3 or b.Position = 4)#(lf)#(tab)#(tab)and f.ACTIVEFLAG = 1#(lf)#(tab)#(tab)and g.StateReportTab = 'TITLE 32'#(lf)#(tab)#(tab)and f.taxyear = @TaxYear#(lf)#(tab)#(tab)--and a.TAXAUTHORITY = 4567#(lf)#(tab)#(tab)--and (isnull(d.GrossRevenue, 0) <> 0 or isnull(d.Levy, 0) <> 0)#(lf)#(tab)#(tab)--and nullif(c.DateOfIssue,'1900-01-01') is null#(lf)#(tab)--order by 1,2#(lf)),#(lf)l56 as#(lf)(#(lf)#(tab)select #(lf)#(tab)#(tab) f.taxyear#(lf)#(tab)#(tab),a.TaxAuthority#(lf)#(tab)#(tab),Levy5 = d.Levy#(lf)#(tab)#(tab),Revenue5 = d.GrossRevenue#(lf)#(tab)#(tab),BondDateofIssue = null--if(c.DateOfIssue,'1900-01-01') --CONCAT('Bond Date: ', c.DateOfIssue)#(lf)#(tab)#(tab),TermInYears = null--if(convert(varchar(3), DATEDIFF(YEAR, c.DateOfIssue, c.MaturityDate)),'0')#(lf)#(tab)#(tab),R = RANK () OVER ( PARTITION BY f.taxyear, a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC) #(lf)#(tab)#(tab)#(tab) + case when b.Position = 5 then 0 else 20 end#(lf)#(lf)#(tab)#(tab),Pos = b.Position --case when RANK () OVER ( PARTITION BY a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC) = 1 then b.Position else null end#(lf)#(tab)FROM encompass.tlkptaxauthority a#(lf)#(tab)#(tab)JOIN encompass.TLKPTAXAUTHORITYDETAIL f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR = @TaxYear #(lf)#(tab)#(tab)JOIN millap.fund c on c.TaxAuthority = a.TAXAUTHORITY #(lf)#(tab)#(tab)LEFT JOIN millap.fundtype b on b.[Index] = c.FundTypeIndex #(lf)#(tab)#(tab)JOIN millap.fundyear d on d.FundID = c.FundID  and d.TaxYear = f.TAXYEAR #(lf)#(tab)#(tab)JOIN millap.TAXAUTHORITYINFO g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(tab)WHERE (b.Position = 5 or b.Position = 6)#(lf)#(tab)#(tab)and f.ACTIVEFLAG = 1#(lf)#(tab)#(tab)and g.StateReportTab = 'TITLE 32'#(lf)#(tab)#(tab)and f.taxyear = @TaxYear#(lf)#(tab)#(tab)--and (isnull(d.GrossRevenue, 0) <> 0 or isnull(d.Levy, 0) <> 0)#(lf)#(tab)--order by 1,2#(lf)),#(lf)l7 as#(lf)(#(lf)#(tab)select #(lf)#(tab)#(tab) f.taxyear#(lf)#(tab)#(tab),a.TaxAuthority#(lf)#(tab)#(tab),Levy7 = d.Levy#(lf)#(tab)#(tab),Revenue7 = d.GrossRevenue#(lf)#(tab)#(tab),BondDateofIssue = null--if(c.DateOfIssue,'1900-01-01') --CONCAT('Bond Date: ', c.DateOfIssue)#(lf)#(tab)#(tab),TermInYears = nullif(convert(varchar(3), DATEDIFF(YEAR, c.DateOfIssue, c.MaturityDate)),'0')#(lf)#(tab)#(tab),R = RANK () OVER ( PARTITION BY f.taxyear, a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC) #(lf)#(tab)#(tab),Pos = b.Position --case when RANK () OVER ( PARTITION BY a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC) = 1 then b.Position else null end#(lf)#(tab)FROM encompass.tlkptaxauthority a#(lf)#(tab)#(tab)JOIN encompass.TLKPTAXAUTHORITYDETAIL f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR = @TaxYear #(lf)#(tab)#(tab)JOIN millap.fund c on c.TaxAuthority = a.TAXAUTHORITY #(lf)#(tab)#(tab)LEFT JOIN millap.fundtype b on b.[Index] = c.FundTypeIndex --and (c.fundtypeindex = b.[index] or c.fundtypeindex is null) #(lf)#(tab)#(tab)JOIN millap.fundyear d on d.FundID = c.FundID  and d.TaxYear = f.TAXYEAR #(lf)#(tab)#(tab)JOIN millap.TAXAUTHORITYINFO g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(tab)WHERE b.Position = 7#(lf)#(tab)#(tab)and f.ACTIVEFLAG = 1#(lf)#(tab)#(tab)and g.StateReportTab = 'TITLE 32'#(lf)#(tab)#(tab)and f.taxyear = @TaxYear#(lf)#(tab)#(tab)--and (isnull(d.GrossRevenue, 0) <> 0 or isnull(d.Levy, 0) <> 0)#(lf))#(lf)select * from (#(lf)select #(lf)#(tab) ta.taxyear#(tab)#(lf)#(tab), case ta.StateReportTabSection#(lf)#(tab)#(tab)when 'Metro Districts' then 1#(lf)#(tab)#(tab)when 'Recreation Districts' then 2#(lf)#(tab)#(tab)when 'Fire Protection Districts' then 3#(lf)#(tab)#(tab)when 'Water Districts' then 4#(lf)#(tab)#(tab)when 'Water & Sanitation Districts' then 5#(lf)#(tab)#(tab)when 'Water Conservancy Districts' then 6#(lf)#(tab)#(tab)when 'Urban Renewal Authorities' then 7#(lf)#(tab)#(tab)when 'Public Improvement Districts' then 8#(lf)#(tab)#(tab)when 'Urban Drain & Flood Control Districts' then 9#(lf)#(tab)#(tab)when 'Business Improvement Districts' then 10#(lf)#(tab)#(tab)end StateReportTabSectionSortOrder#(lf)#(tab),ta.StateReportTabSection#(lf)#(tab),ta.TaxAuthority#(tab)#(lf)#(tab),MetroDistricts#(tab)#(lf)#(tab),Certified = case #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)when ta.Certified = 'true' then 5 #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)when ta.Certified = '5' then 5#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)else 0 end#(lf)#(tab),NearestTenDollars#(tab)--= MAX(ta.NearestTenDollars) #(lf)#(tab),TotalLevy#(tab)#(lf)#(tab),TotalRevenue#(tab)#(lf)#(tab),ta.r#(tab)#(lf)#(tab),Pos1 = l12.Pos#(lf)#(tab),Levy1#(tab)#(lf)#(tab),Revenue1#(tab)#(lf)#(tab),BondDateofIssue = null#(lf)#(tab),Pos3 = l34.Pos#(lf)#(tab),Levy3#(tab)#(lf)#(tab),Revenue3#(tab)#(lf)#(tab),TermInYears = null#(lf)#(tab),Pos5 = l56.Pos#(lf)#(tab),Levy5#(tab)#(lf)#(tab),Revenue5#(tab)#(lf)#(tab),Pos7 = l7.Pos#(lf)#(tab),Levy7#(tab)#(lf)#(tab),Revenue7#(tab)#(lf)#(lf)from  ta#(tab)#(lf)#(lf)#(tab)left join l12 on ta.TAXYEAR = l12.TAXYEAR and ta.TaxAuthority = l12.TAXAUTHORITY and ta.r = l12.R#(lf)#(tab)left join l34 on ta.TAXYEAR = l34.TAXYEAR and ta.TaxAuthority = l34.TAXAUTHORITY and ta.r = l34.R#(lf)#(tab)left join l56 on ta.TAXYEAR = l56.TAXYEAR and ta.TaxAuthority = l56.TAXAUTHORITY and ta.r = l56.R#(lf)#(tab)left join l7 on ta.TAXYEAR = l7.TAXYEAR and ta.TaxAuthority = l7.TAXAUTHORITY and ta.r = l7.R#(lf)where #(lf)#(tab)NearestTenDollars is not null#(lf)#(tab)and ta.r = 1#(lf)#(tab)and (Levy1#(tab)#(tab)is null#(lf)#(tab)and Revenue1#(tab)is null#(lf)#(tab)and Levy3#(tab)#(tab)is null#(lf)#(tab)and Revenue3#(tab)is null#(lf)#(tab)and Levy5#(tab)#(tab)is null#(lf)#(tab)and Revenue5#(tab)is null#(lf)#(tab)and Levy7#(tab)#(tab)is null#(lf)#(tab)and Revenue7#(tab)is null)#(lf)union all#(lf)select #(lf)#(tab) ta.taxyear#(tab)#(lf)#(tab), case ta.StateReportTabSection#(lf)#(tab)#(tab)when 'Metro Districts' then 1#(lf)#(tab)#(tab)when 'Recreation Districts' then 2#(lf)#(tab)#(tab)when 'Fire Protection Districts' then 3#(lf)#(tab)#(tab)when 'Water Districts' then 4#(lf)#(tab)#(tab)when 'Water & Sanitation Districts' then 5#(lf)#(tab)#(tab)when 'Water Conservancy Districts' then 6#(lf)#(tab)#(tab)when 'Urban Renewal Authorities' then 7#(lf)#(tab)#(tab)when 'Public Improvement Districts' then 8#(lf)#(tab)#(tab)when 'Urban Drain & Flood Control Districts' then 9#(lf)#(tab)#(tab)when 'Business Improvement Districts' then 10#(lf)#(tab)#(tab)end StateReportTabSectionSortOrder#(lf)#(tab),ta.StateReportTabSection#(lf)#(tab),ta.TaxAuthority#(tab)#(lf)#(tab),MetroDistricts#(tab)#(lf)#(tab),Certified = case #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)when ta.Certified = 'true' then 5 #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)when ta.Certified = '5' then 5#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)else 0 end#(lf)#(tab),NearestTenDollars#(tab)--= MAX(ta.NearestTenDollars) #(lf)#(tab),TotalLevy#(tab)#(lf)#(tab),TotalRevenue#(tab)#(lf)#(tab),ta.r#(tab)#(lf)#(tab),Pos1 = l12.Pos#(lf)#(tab),Levy1#(tab)#(lf)#(tab),Revenue1#(tab)#(lf)#(tab),BondDateofIssue = l34.BondDateofIssue#(lf)#(tab),Pos3 = l34.Pos#(lf)#(tab),Levy3#(tab)#(lf)#(tab),Revenue3#(tab)#(lf)#(tab),TermInYears = l34.TermInYears#(lf)#(tab),Pos5 = l56.Pos#(lf)#(tab),Levy5#(tab)#(lf)#(tab),Revenue5#(tab)#(lf)#(tab),Pos7 = l7.Pos#(lf)#(tab),Levy7#(tab)#(lf)#(tab),Revenue7#(tab)#(lf)#(lf)from  ta#(tab)#(lf)#(lf)#(tab)left join l12 on ta.TAXYEAR = l12.TAXYEAR and ta.TaxAuthority = l12.TAXAUTHORITY and ta.r = l12.R#(lf)#(tab)left join l34 on ta.TAXYEAR = l34.TAXYEAR and ta.TaxAuthority = l34.TAXAUTHORITY and ta.r = l34.R#(lf)#(tab)left join l56 on ta.TAXYEAR = l56.TAXYEAR and ta.TaxAuthority = l56.TAXAUTHORITY and ta.r = l56.R#(lf)#(tab)left join l7 on ta.TAXYEAR = l7.TAXYEAR and ta.TaxAuthority = l7.TAXAUTHORITY and ta.r = l7.R#(lf)where #(lf)#(tab)Levy1 is not null#(lf)#(tab)or Revenue1#(tab) is not null#(lf)#(tab)or Levy3#(tab) is not null#(lf)#(tab)or Revenue3#(tab) is not null#(lf)#(tab)or Levy5#(tab) is not null#(lf)#(tab)or Revenue5#(tab) is not null#(lf)#(tab)or Levy7#(tab) is not null#(lf)#(tab)or Revenue7 is not null#(lf)#(tab)or l34.BondDateofIssue is not null#(lf)#(lf)) final#(lf)where taxyear = @TaxYear\", CreateNavigationProperties=false]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"taxyear\", Int64.Type}, {\"TaxAuthority\", Int64.Type}, {\"NearestTenDollars\", Currency.Type}, {\"TotalLevy\", Decimal.Type}, {\"TotalRevenue\", Currency.Type}, {\"r\", Int64.Type}, {\"Revenue1\", Currency.Type}, {\"Levy3\", type number}, {\"Revenue3\", Currency.Type}, {\"Levy5\", type number}, {\"Revenue5\", Currency.Type}, {\"Revenue7\", Currency.Type}, {\"Levy7\", type number}}),",
                "    #\"Added Levy1Display\" = Table.AddColumn(#\"Changed Type\", \"Levy1Display\", each if [Levy1] is null ",
                "then ",
                "   if [BondDateofIssue] is null",
                "   then null",
                "   else \"Bond Date: \"",
                "else",
                "   if [Levy1] >= 0",
                "   then Text.From([Levy1])",
                "   else Text.Combine({\"(\",Text.Remove(Text.From([Levy1]),\"-\"),\")\"})),",
                "    #\"Added Levy3Display\" = Table.AddColumn(#\"Added Levy1Display\", \"Levy3Display\", each Text.From([Levy3])),",
                "    #\"Added Revenue1Display\" = Table.AddColumn(#\"Added Levy3Display\", \"Revenue1Display\", each if [Revenue1] is null ",
                "then ",
                "   if [BondDateofIssue] is null",
                "   then null",
                "   else [BondDateofIssue]",
                "else",
                "   Number.ToText([Revenue1],\"$#,##0;($#,##0)\")),",
                "    #\"Added Revenue3Display\" = Table.AddColumn(#\"Added Revenue1Display\", \"Revenue3Display\", each Number.ToText([Revenue3],\"$#,##0;($#,##0)\")),",
                "    #\"Added Levy5Display\" = Table.AddColumn(#\"Added Revenue3Display\", \"Levy5Display\", each if [Levy5] is null ",
                "then ",
                "   if [TermInYears] is null",
                "   then null",
                "   else \"term in years: \"",
                "else",
                "   Text.From([Levy5])),",
                "    #\"Added Revenue5Display\" = Table.AddColumn(#\"Added Levy5Display\", \"Revenue5Display\", each if [Revenue5] is null ",
                "then ",
                "   if [TermInYears] is null",
                "   then null",
                "   else [TermInYears]",
                "else",
                "   Number.ToText([Revenue5],\"$#,##0;$(#,##0)\")),",
                "    #\"Added PositionRowGroup\" = Table.AddColumn(#\"Added Revenue5Display\", \"PositionRowGroup\", each if [Pos1] is null then ",
                "   if [Pos3] is null then",
                "      if [Pos5] is null then",
                "         if [Pos7] is null then",
                "            if [r] = 1 then 1 else 0",
                "         else Number.Mod([Pos7],2)",
                "      else Number.Mod([Pos5],2)",
                "   else Number.Mod([Pos3],2)",
                "else Number.Mod([Pos1],2)),",
                "    #\"Replaced 0 PositionRowGroup\" = Table.ReplaceValue(#\"Added PositionRowGroup\",0,2,Replacer.ReplaceValue,{\"PositionRowGroup\"}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Replaced 0 PositionRowGroup\", {\"taxyear\", \"TaxAuthority\", \"r\"}, #\"Title 32 Totals\", {\"taxyear\", \"TaxAuthority\", \"Min r\"}, \"Title 32 Totals\", JoinKind.LeftOuter),",
                "    #\"Expanded Title 32 Totals\" = Table.ExpandTableColumn(#\"Merged Queries\", \"Title 32 Totals\", {\"TotalLevy\", \"TotalRevenue\"}, {\"Title 32 Totals.TotalLevy\", \"Title 32 Totals.TotalRevenue\"}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Expanded Title 32 Totals\",{\"TotalLevy\", \"TotalRevenue\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Title 32 Totals.TotalLevy\", \"TotalLevy\"}, {\"Title 32 Totals.TotalRevenue\", \"TotalRevenue\"}})",
                "in",
                "    #\"Renamed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Title 32 Totals",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "columns": [
          {
            "name": "taxyear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "24cecedd-0637-43a6-92f0-d60bb3a27a8a",
            "sourceColumn": "taxyear",
            "summarizeBy": "sum"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "a623ce5a-00d9-496c-87fe-6e4a397fcdbc",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "f0ba2dfe-8525-4384-a572-4d7eb71775d7",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"currencyCulture\":\"en-US\"}"
              }
            ],
            "dataType": "decimal",
            "formatString": "\\$#,0.###############;(\\$#,0.###############);\\$#,0.###############",
            "lineageTag": "9b740ba1-da3f-4e67-a97f-135a0aef62cb",
            "sourceColumn": "TotalRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "Min r",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "3d98ed63-53d1-45d1-a0fc-f7d3b0126ee5",
            "sourceColumn": "Min r",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "ba25bcdc-9fb4-4ecb-a7ed-b252cd18ecc0",
        "partitions": [
          {
            "name": "Title 32 Totals-0ea44926-bcc3-4c90-a124-a757ad94281c",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database, [Query=\"declare @TaxYear int = 2023;#(lf)with ta (taxyear,StateReportTabSection,TaxAuthority, MetroDistricts, Certified, NearestTenDollars, TotalLevy, TotalRevenue, r) AS (#(lf)#(tab)SELECT #(lf)#(tab)#(tab) f.taxyear#(lf)#(tab)#(tab),i.StateReportTabSection#(lf)#(tab)#(tab),a.TAXAUTHORITY TaxAuthority#(lf)#(tab)#(tab),a.authorityname MetroDistricts#(lf)#(tab)#(tab),e.Certified#(lf)#(tab)#(tab),NearestTenDollars = MAX(e.GROSSASSESSED)#(lf)#(tab)#(tab)--,Position12 = case when b.Position = 1 then CONCAT('(',b.Position,')') else null end#(lf)#(tab)#(tab),TotalLevy = MAX(e.TotalLevy)#(lf)#(tab)#(tab),TotalRevenue = MAX(e.TotalRevenue)#(lf)#(tab)#(tab),nums.r#(lf)#(tab)FROM encompass.tlkptaxauthority a #(lf)#(tab)#(tab)join millap.TAXAUTHORITYINFO i on a.TAXAUTHORITY = i.TAXAUTHORITY#(lf)#(tab)#(tab)JOIN encompass.TLKPTAXAUTHORITYDETAIL f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR = @TaxYear#(lf)#(tab)#(tab)LEFT JOIN (#(tab)SELECT #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab) TaxYear --= @TaxYear#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab),TaxAuthority#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab),Certified#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab),TotalLevy = MAX(TotalLevy)#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab),TotalRevenue = MAX(TotalGrossRevenue)#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab),GROSSASSESSED = MAX(GROSSASSESSED)#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)FROM millap.cert#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)where TaxYear = @TaxYear#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)GROUP BY #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)TaxYear, Certified, TaxAuthority) e on e.TaxYear = f.TaxYear and e.TaxAuthority = a.TAXAUTHORITY#(lf)#(tab)#(tab)LEFT JOIN millap.TAXAUTHORITYINFO g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(tab)#(tab)cross join (#(lf)#(tab)#(tab)SELECT r = ones.n + 10*tens.n#(lf)#(tab)#(tab)#(tab)FROM (VALUES(0),(1),(2),(3),(4),(5),(6),(7),(8),(9)) ones(n),#(lf)#(tab)#(tab)#(tab)#(tab) (VALUES(0),(1),(2),(3),(4),(5),(6),(7),(8),(9)) tens(n)#(lf)#(tab)#(tab)#(tab)where ones.n + 10*tens.n between 1 and 99#(lf)#(tab)#(tab)#(tab)--ORDER BY 1 #(lf)#(tab)#(tab)#(tab)) nums#(lf)#(lf)#(tab)WHERE f.ACTIVEFLAG = 1#(lf)#(tab)#(tab)and g.StateReportTab = 'TITLE 32'#(lf)#(tab)#(tab)and f.taxyear = @TaxYear#(lf)#(tab)#(tab)--and a.TAXAUTHORITY = 4460 #(lf)#(tab)group by #(lf)#(tab)#(tab) f.taxyear#(lf)#(tab)#(tab),i.StateReportTabSection#(lf)#(tab)#(tab),a.TAXAUTHORITY #(lf)#(tab)#(tab),a.authorityname #(lf)#(tab)#(tab),e.Certified#(lf)#(tab)#(tab),nums.r#(lf)#(tab)--order by 1,2,3,9#(lf)#(lf)),#(lf)l12 as #(lf)(#(lf)#(tab)select #(lf)#(tab)#(tab) f.taxyear#(lf)#(tab)#(tab),a.TaxAuthority#(lf)#(tab)#(tab),Levy1 = case when b.FundType = 'TEMP TAX CREDIT' then d.Levy * -1 else d.Levy end#(lf)#(tab)#(tab),Revenue1 = case when b.FundType = 'TEMP TAX CREDIT' then d.GrossRevenue * -1 else d.GrossRevenue end#(lf)#(tab)#(tab),BondDateofIssue = null --nullif(c.DateOfIssue,'1900-01-01') --CONCAT('Bond Date: ', c.DateOfIssue)#(lf)#(tab)#(tab),TermInYears = null --nullif(convert(varchar(3), DATEDIFF(YEAR, c.DateOfIssue, c.MaturityDate)),'0')#(lf)#(tab)#(tab),R = RANK () OVER ( PARTITION BY f.taxyear, a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC)#(lf)#(tab)#(tab)#(tab)#(tab)+ case when b.Position = 1 then 0 else 20 end#(lf)#(lf)#(tab)#(tab),Pos = b.Position --case when RANK () OVER ( PARTITION BY a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC) = 1 then b.Position else null end#(lf)#(tab)FROM encompass.tlkptaxauthority a#(lf)#(tab)#(tab)JOIN encompass.TLKPTAXAUTHORITYDETAIL f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR = @TaxYear #(lf)#(tab)#(tab)JOIN millap.fund c on c.TaxAuthority = a.TAXAUTHORITY #(lf)#(tab)#(tab)LEFT JOIN millap.fundtype b on b.[Index] = c.FundTypeIndex #(lf)#(tab)#(tab)JOIN millap.fundyear d on d.FundID = c.FundID  and d.TaxYear = f.TAXYEAR #(lf)#(tab)#(tab)JOIN millap.TAXAUTHORITYINFO g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(tab)WHERE (b.Position = 1 or b.Position = 2)#(lf)#(tab)#(tab)and f.ACTIVEFLAG = 1#(lf)#(tab)#(tab)and g.StateReportTab = 'TITLE 32'#(lf)#(tab)#(tab)and f.taxyear = @TaxYear#(lf)#(tab)#(tab)--and (isnull(d.GrossRevenue, 0) <> 0 or isnull(d.Levy, 0) <> 0)#(lf)#(tab)--order by 1,2#(lf)),#(lf)l34 as#(lf)(#(lf)#(tab)select #(lf)#(tab)#(tab) f.taxyear#(lf)#(tab)#(tab),a.TaxAuthority#(lf)#(tab)#(tab),Levy3 = d.Levy#(lf)#(tab)#(tab),Revenue3 = d.GrossRevenue#(lf)#(tab)#(tab),BondDateofIssue = case when b.fundtype = 'BOND' then nullif(c.DateOfIssue,'1900-01-01') else null end #(lf)#(tab)#(tab),TermInYears = case #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)when b.fundtype <> 'BOND' or nullif(c.DateOfIssue,'1900-01-01') is null then null #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)#(tab)else convert(varchar(3), DATEDIFF(YEAR, c.DateOfIssue, c.MaturityDate)) #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)   end#(lf)#(tab)#(tab),R = RANK () OVER ( PARTITION BY f.taxyear, a.TaxAuthority ORDER BY d.GrossRevenue, c.FundID DESC)#(lf)#(tab)#(tab)#(tab) + case when b.Position = 3 then 0 else 40 end#(lf)#(tab)#(tab),Pos = b.Position --case when RANK () OVER ( PARTITION BY a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC) = 1 then b.Position else null end#(lf)#(tab)#(tab),c.FundID#(lf)#(tab)#(tab),b.fundtype#(lf)#(tab)FROM encompass.tlkptaxauthority a#(lf)#(tab)#(tab)JOIN encompass.TLKPTAXAUTHORITYDETAIL f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR = @TaxYear #(lf)#(tab)#(tab)JOIN millap.fund c on c.TaxAuthority = a.TAXAUTHORITY #(lf)#(tab)#(tab)LEFT JOIN millap.fundtype b on b.[Index] = c.FundTypeIndex #(lf)#(tab)#(tab)JOIN millap.fundyear d on d.FundID = c.FundID  and d.TaxYear = f.TAXYEAR #(lf)#(tab)#(tab)JOIN millap.TAXAUTHORITYINFO g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(tab)WHERE (b.Position = 3 or b.Position = 4)#(lf)#(tab)#(tab)and f.ACTIVEFLAG = 1#(lf)#(tab)#(tab)and g.StateReportTab = 'TITLE 32'#(lf)#(tab)#(tab)and f.taxyear = @TaxYear#(lf)#(tab)#(tab)--and a.TAXAUTHORITY = 4567#(lf)#(tab)#(tab)--and (isnull(d.GrossRevenue, 0) <> 0 or isnull(d.Levy, 0) <> 0)#(lf)#(tab)#(tab)--and nullif(c.DateOfIssue,'1900-01-01') is null#(lf)#(tab)--order by 1,2#(lf)),#(lf)l56 as#(lf)(#(lf)#(tab)select #(lf)#(tab)#(tab) f.taxyear#(lf)#(tab)#(tab),a.TaxAuthority#(lf)#(tab)#(tab),Levy5 = d.Levy#(lf)#(tab)#(tab),Revenue5 = d.GrossRevenue#(lf)#(tab)#(tab),BondDateofIssue = null--if(c.DateOfIssue,'1900-01-01') --CONCAT('Bond Date: ', c.DateOfIssue)#(lf)#(tab)#(tab),TermInYears = null--if(convert(varchar(3), DATEDIFF(YEAR, c.DateOfIssue, c.MaturityDate)),'0')#(lf)#(tab)#(tab),R = RANK () OVER ( PARTITION BY f.taxyear, a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC) #(lf)#(tab)#(tab)#(tab) + case when b.Position = 5 then 0 else 20 end#(lf)#(lf)#(tab)#(tab),Pos = b.Position --case when RANK () OVER ( PARTITION BY a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC) = 1 then b.Position else null end#(lf)#(tab)FROM encompass.tlkptaxauthority a#(lf)#(tab)#(tab)JOIN encompass.TLKPTAXAUTHORITYDETAIL f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR = @TaxYear #(lf)#(tab)#(tab)JOIN millap.fund c on c.TaxAuthority = a.TAXAUTHORITY #(lf)#(tab)#(tab)LEFT JOIN millap.fundtype b on b.[Index] = c.FundTypeIndex #(lf)#(tab)#(tab)JOIN millap.fundyear d on d.FundID = c.FundID  and d.TaxYear = f.TAXYEAR #(lf)#(tab)#(tab)JOIN millap.TAXAUTHORITYINFO g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(tab)WHERE (b.Position = 5 or b.Position = 6)#(lf)#(tab)#(tab)and f.ACTIVEFLAG = 1#(lf)#(tab)#(tab)and g.StateReportTab = 'TITLE 32'#(lf)#(tab)#(tab)and f.taxyear = @TaxYear#(lf)#(tab)#(tab)--and (isnull(d.GrossRevenue, 0) <> 0 or isnull(d.Levy, 0) <> 0)#(lf)#(tab)--order by 1,2#(lf)),#(lf)l7 as#(lf)(#(lf)#(tab)select #(lf)#(tab)#(tab) f.taxyear#(lf)#(tab)#(tab),a.TaxAuthority#(lf)#(tab)#(tab),Levy7 = d.Levy#(lf)#(tab)#(tab),Revenue7 = d.GrossRevenue#(lf)#(tab)#(tab),BondDateofIssue = null--if(c.DateOfIssue,'1900-01-01') --CONCAT('Bond Date: ', c.DateOfIssue)#(lf)#(tab)#(tab),TermInYears = nullif(convert(varchar(3), DATEDIFF(YEAR, c.DateOfIssue, c.MaturityDate)),'0')#(lf)#(tab)#(tab),R = RANK () OVER ( PARTITION BY f.taxyear, a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC) #(lf)#(tab)#(tab),Pos = b.Position --case when RANK () OVER ( PARTITION BY a.TaxAuthority ORDER BY d.Levy, d.GrossRevenue DESC) = 1 then b.Position else null end#(lf)#(tab)FROM encompass.tlkptaxauthority a#(lf)#(tab)#(tab)JOIN encompass.TLKPTAXAUTHORITYDETAIL f on f.TAXAUTHORITY = a.TAXAUTHORITY and f.TAXYEAR = @TaxYear #(lf)#(tab)#(tab)JOIN millap.fund c on c.TaxAuthority = a.TAXAUTHORITY #(lf)#(tab)#(tab)LEFT JOIN millap.fundtype b on b.[Index] = c.FundTypeIndex --and (c.fundtypeindex = b.[index] or c.fundtypeindex is null) #(lf)#(tab)#(tab)JOIN millap.fundyear d on d.FundID = c.FundID  and d.TaxYear = f.TAXYEAR #(lf)#(tab)#(tab)JOIN millap.TAXAUTHORITYINFO g on g.TAXAUTHORITY = a.TAXAUTHORITY#(lf)#(tab)WHERE b.Position = 7#(lf)#(tab)#(tab)and f.ACTIVEFLAG = 1#(lf)#(tab)#(tab)and g.StateReportTab = 'TITLE 32'#(lf)#(tab)#(tab)and f.taxyear = @TaxYear#(lf)#(tab)#(tab)--and (isnull(d.GrossRevenue, 0) <> 0 or isnull(d.Levy, 0) <> 0)#(lf))#(lf)select * from (#(lf)select #(lf)#(tab) ta.taxyear#(tab)#(lf)#(tab), case ta.StateReportTabSection#(lf)#(tab)#(tab)when 'Metro Districts' then 1#(lf)#(tab)#(tab)when 'Recreation Districts' then 2#(lf)#(tab)#(tab)when 'Fire Protection Districts' then 3#(lf)#(tab)#(tab)when 'Water Districts' then 4#(lf)#(tab)#(tab)when 'Water & Sanitation Districts' then 5#(lf)#(tab)#(tab)when 'Water Conservancy Districts' then 6#(lf)#(tab)#(tab)when 'Urban Renewal Authorities' then 7#(lf)#(tab)#(tab)when 'Public Improvement Districts' then 8#(lf)#(tab)#(tab)when 'Urban Drain & Flood Control Districts' then 9#(lf)#(tab)#(tab)when 'Business Improvement Districts' then 10#(lf)#(tab)#(tab)end StateReportTabSectionSortOrder#(lf)#(tab),ta.StateReportTabSection#(lf)#(tab),ta.TaxAuthority#(tab)#(lf)#(tab),MetroDistricts#(tab)#(lf)#(tab),Certified = case #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)when ta.Certified = 'true' then 5 #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)when ta.Certified = '5' then 5#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)else 0 end#(lf)#(tab),NearestTenDollars#(tab)--= MAX(ta.NearestTenDollars) #(lf)#(tab),TotalLevy#(tab)#(lf)#(tab),TotalRevenue#(tab)#(lf)#(tab),ta.r#(tab)#(lf)#(tab),Pos1 = l12.Pos#(lf)#(tab),Levy1#(tab)#(lf)#(tab),Revenue1#(tab)#(lf)#(tab),BondDateofIssue = null#(lf)#(tab),Pos3 = l34.Pos#(lf)#(tab),Levy3#(tab)#(lf)#(tab),Revenue3#(tab)#(lf)#(tab),TermInYears = null#(lf)#(tab),Pos5 = l56.Pos#(lf)#(tab),Levy5#(tab)#(lf)#(tab),Revenue5#(tab)#(lf)#(tab),Pos7 = l7.Pos#(lf)#(tab),Levy7#(tab)#(lf)#(tab),Revenue7#(tab)#(lf)#(lf)from  ta#(tab)#(lf)#(lf)#(tab)left join l12 on ta.TAXYEAR = l12.TAXYEAR and ta.TaxAuthority = l12.TAXAUTHORITY and ta.r = l12.R#(lf)#(tab)left join l34 on ta.TAXYEAR = l34.TAXYEAR and ta.TaxAuthority = l34.TAXAUTHORITY and ta.r = l34.R#(lf)#(tab)left join l56 on ta.TAXYEAR = l56.TAXYEAR and ta.TaxAuthority = l56.TAXAUTHORITY and ta.r = l56.R#(lf)#(tab)left join l7 on ta.TAXYEAR = l7.TAXYEAR and ta.TaxAuthority = l7.TAXAUTHORITY and ta.r = l7.R#(lf)where #(lf)#(tab)NearestTenDollars is not null#(lf)#(tab)and ta.r = 1#(lf)#(tab)and (Levy1#(tab)#(tab)is null#(lf)#(tab)and Revenue1#(tab)is null#(lf)#(tab)and Levy3#(tab)#(tab)is null#(lf)#(tab)and Revenue3#(tab)is null#(lf)#(tab)and Levy5#(tab)#(tab)is null#(lf)#(tab)and Revenue5#(tab)is null#(lf)#(tab)and Levy7#(tab)#(tab)is null#(lf)#(tab)and Revenue7#(tab)is null)#(lf)union all#(lf)select #(lf)#(tab) ta.taxyear#(tab)#(lf)#(tab), case ta.StateReportTabSection#(lf)#(tab)#(tab)when 'Metro Districts' then 1#(lf)#(tab)#(tab)when 'Recreation Districts' then 2#(lf)#(tab)#(tab)when 'Fire Protection Districts' then 3#(lf)#(tab)#(tab)when 'Water Districts' then 4#(lf)#(tab)#(tab)when 'Water & Sanitation Districts' then 5#(lf)#(tab)#(tab)when 'Water Conservancy Districts' then 6#(lf)#(tab)#(tab)when 'Urban Renewal Authorities' then 7#(lf)#(tab)#(tab)when 'Public Improvement Districts' then 8#(lf)#(tab)#(tab)when 'Urban Drain & Flood Control Districts' then 9#(lf)#(tab)#(tab)when 'Business Improvement Districts' then 10#(lf)#(tab)#(tab)end StateReportTabSectionSortOrder#(lf)#(tab),ta.StateReportTabSection#(lf)#(tab),ta.TaxAuthority#(tab)#(lf)#(tab),MetroDistricts#(tab)#(lf)#(tab),Certified = case #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)when ta.Certified = 'true' then 5 #(lf)#(tab)#(tab)#(tab)#(tab)#(tab)when ta.Certified = '5' then 5#(lf)#(tab)#(tab)#(tab)#(tab)#(tab)else 0 end#(lf)#(tab),NearestTenDollars#(tab)--= MAX(ta.NearestTenDollars) #(lf)#(tab),TotalLevy#(tab)#(lf)#(tab),TotalRevenue#(tab)#(lf)#(tab),ta.r#(tab)#(lf)#(tab),Pos1 = l12.Pos#(lf)#(tab),Levy1#(tab)#(lf)#(tab),Revenue1#(tab)#(lf)#(tab),BondDateofIssue = l34.BondDateofIssue#(lf)#(tab),Pos3 = l34.Pos#(lf)#(tab),Levy3#(tab)#(lf)#(tab),Revenue3#(tab)#(lf)#(tab),TermInYears = l34.TermInYears#(lf)#(tab),Pos5 = l56.Pos#(lf)#(tab),Levy5#(tab)#(lf)#(tab),Revenue5#(tab)#(lf)#(tab),Pos7 = l7.Pos#(lf)#(tab),Levy7#(tab)#(lf)#(tab),Revenue7#(tab)#(lf)#(lf)from  ta#(tab)#(lf)#(lf)#(tab)left join l12 on ta.TAXYEAR = l12.TAXYEAR and ta.TaxAuthority = l12.TAXAUTHORITY and ta.r = l12.R#(lf)#(tab)left join l34 on ta.TAXYEAR = l34.TAXYEAR and ta.TaxAuthority = l34.TAXAUTHORITY and ta.r = l34.R#(lf)#(tab)left join l56 on ta.TAXYEAR = l56.TAXYEAR and ta.TaxAuthority = l56.TAXAUTHORITY and ta.r = l56.R#(lf)#(tab)left join l7 on ta.TAXYEAR = l7.TAXYEAR and ta.TaxAuthority = l7.TAXAUTHORITY and ta.r = l7.R#(lf)where #(lf)#(tab)Levy1 is not null#(lf)#(tab)or Revenue1#(tab) is not null#(lf)#(tab)or Levy3#(tab) is not null#(lf)#(tab)or Revenue3#(tab) is not null#(lf)#(tab)or Levy5#(tab) is not null#(lf)#(tab)or Revenue5#(tab) is not null#(lf)#(tab)or Levy7#(tab) is not null#(lf)#(tab)or Revenue7 is not null#(lf)#(tab)or l34.BondDateofIssue is not null#(lf)#(lf)) final#(lf)where taxyear = @TaxYear\", CreateNavigationProperties=false]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"taxyear\", Int64.Type}, {\"TaxAuthority\", Int64.Type}, {\"NearestTenDollars\", Currency.Type}, {\"TotalLevy\", Decimal.Type}, {\"TotalRevenue\", Currency.Type}, {\"r\", Int64.Type}, {\"Revenue1\", Currency.Type}, {\"Levy3\", type number}, {\"Revenue3\", Currency.Type}, {\"Levy5\", type number}, {\"Revenue5\", Currency.Type}, {\"Revenue7\", Currency.Type}, {\"Levy7\", type number}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"Pos1\", \"Levy1\", \"Revenue1\", \"BondDateofIssue\", \"Pos3\", \"Levy3\", \"Revenue3\", \"TermInYears\", \"Pos5\", \"Levy5\", \"Revenue5\", \"Pos7\", \"Levy7\", \"Revenue7\", \"Certified\", \"NearestTenDollars\"}),",
                "    #\"Grouped Rows\" = Table.Group(#\"Removed Columns\", {\"taxyear\", \"TaxAuthority\", \"TotalLevy\", \"TotalRevenue\"}, {{\"Min r\", each List.Min([r]), type nullable number}})",
                "in",
                "    #\"Grouped Rows\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Schools (3)",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2312690a-63fb-40c1-808b-df35bc6bf4e1",
            "sourceColumn": "TaxYear",
            "summarizeBy": "none"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2bc68861-6858-4344-9200-e46ef2cef43d",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "changedProperties": [
              {
                "property": "DataType"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "98486ad1-aaf8-4784-abb9-d616511b4651",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "07bf339b-2345-4934-9bf0-ed32c610cf7e",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "none"
          },
          {
            "name": "Levy12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "double",
            "formatString": "0.000",
            "lineageTag": "1a69050c-5aa1-4b21-a7e9-752b858b143f",
            "sourceColumn": "Levy12",
            "summarizeBy": "none"
          },
          {
            "name": "GrossRevenue12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "DataType"
              }
            ],
            "dataType": "int64",
            "lineageTag": "4305be18-20bd-4c69-8bdc-6b860f41baec",
            "sourceColumn": "GrossRevenue12",
            "summarizeBy": "none"
          },
          {
            "name": "Levy34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "double",
            "formatString": "0.000",
            "lineageTag": "fda09084-bfb0-4b4b-bae9-43b4622db3f5",
            "sourceColumn": "Levy34",
            "summarizeBy": "none"
          },
          {
            "name": "GrossRevenue34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "DataType"
              }
            ],
            "dataType": "int64",
            "lineageTag": "a7c8db8d-c945-41e2-b2e3-4077d3279f9e",
            "sourceColumn": "GrossRevenue34",
            "summarizeBy": "none"
          },
          {
            "name": "Levy56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "double",
            "formatString": "0.000",
            "lineageTag": "cb8b7e1a-9caf-4251-98b7-7f649c924767",
            "sourceColumn": "Levy56",
            "summarizeBy": "none"
          },
          {
            "name": "GrossRevenue56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "DataType"
              }
            ],
            "dataType": "int64",
            "lineageTag": "1988fe80-ebaa-4012-81ac-ea2468ca9a28",
            "sourceColumn": "GrossRevenue56",
            "summarizeBy": "none"
          },
          {
            "name": "Levy78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "double",
            "formatString": "0.000",
            "lineageTag": "644c9d1e-2b0f-4ee8-8075-6cff3460e24d",
            "sourceColumn": "Levy78",
            "summarizeBy": "none"
          },
          {
            "name": "GrossRevenue78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "DataType"
              }
            ],
            "dataType": "int64",
            "lineageTag": "1f6fee95-e8b2-41e8-bb41-da75184ff6a5",
            "sourceColumn": "GrossRevenue78",
            "summarizeBy": "none"
          },
          {
            "name": "Position12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f2d12f9c-1ee8-4275-ae96-5e1958bc77df",
            "sourceColumn": "Position12",
            "summarizeBy": "none"
          },
          {
            "name": "Position34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d4bdef8b-f9e5-4b74-9604-731b1ed0e28a",
            "sourceColumn": "Position34",
            "summarizeBy": "none"
          },
          {
            "name": "Position56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e92637a9-5494-40df-adb2-20c296576e96",
            "sourceColumn": "Position56",
            "summarizeBy": "none"
          },
          {
            "name": "Position78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "5ba5f23b-536a-4ce0-82a2-81054dddc73d",
            "sourceColumn": "Position78",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "29a8f31f-b0a3-41d9-9a7b-d9f870ec5d5f",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c872483e-2572-4309-a63e-108719d213dd",
            "sourceColumn": "rownum",
            "summarizeBy": "none"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "double",
            "formatString": "0.000",
            "lineageTag": "c90c96ef-b7e9-41f9-b1fd-3f3743c3c298",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "max"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "DataType"
              }
            ],
            "dataType": "int64",
            "lineageTag": "1e2c9e6e-2aa0-4414-b277-35c52ecb2591",
            "sourceColumn": "TotalGrossRevenue",
            "summarizeBy": "max"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "85dd8a13-6fb3-4326-b50a-f005b48fc76e",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "1e45ed7d-bca5-468f-9bad-cbf4d6d245c1",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "c62dc1aa-a293-4acc-9680-f8a9ecef49f9",
        "partitions": [
          {
            "name": "Schools (3)",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database, [Query=\"with TAXAUTHORITYDETAIL as (#(lf)#(tab)select  #(lf)#(tab)#(tab) authoritydetail.TaxYear#(lf)#(tab)#(tab),authority.authorityname TaxingEntity#(lf)#(tab)#(tab),authority.TaxAuthority#(lf)#(tab)#(tab),authority.AUTHORITYTYPE#(lf)#(lf)#(tab)#(tab)from#(tab)#(tab)encompass.tlkptaxauthority#(tab)#(tab)#(tab)authority#(lf)#(tab)#(tab)join#(tab)#(tab)encompass.TLKPTAXAUTHORITYDETAIL#(tab)authoritydetail on authoritydetail.TAXAUTHORITY = authority.TAXAUTHORITY #(lf)#(tab)#(tab)where authority.TAXAUTHORITY is not null#(lf)#(tab)#(tab)#(tab)and authoritydetail.ACTIVEFLAG = 1#(lf)#(tab)#(tab)#(tab)and authority.AUTHORITYTYPE = 'School'#(lf)#(tab)#(tab)#(tab)--and authoritydetail.TAXYEAR = 2023#(lf)), fundbyyear as (#(lf)#(tab)select --distinct #(lf)#(tab)#(tab) fundyear.TaxYear#(lf)#(tab)#(tab),fundyear.FundYearId#(lf)#(tab)#(tab),Levy = case when fundtype.FundType = 'TEMP TAX CREDIT' then (fundyear.Levy * -1) else fundyear.Levy end#(lf)#(tab)#(tab),GrossRevenue = case when fundtype.FundType = 'TEMP TAX CREDIT' then (fundyear.GrossRevenue * -1) else fundyear.GrossRevenue end#(lf)#(lf)#(tab)#(tab),fund.FundID#(lf)#(tab)#(tab),fund.TaxAuthority#(lf)#(tab)#(tab),fund.Name#(lf)#(tab)#(tab),fund.DateOfIssue#(tab)#(lf)#(tab)#(tab),fund.MaturityDate#(lf)#(tab)#(tab),TermInYears = DateDiff(year, fund.MaturityDate, fund.DateOfIssue)#(lf)#(tab)#(tab),fund.Is_Active#(lf)#(tab)#(tab),fund.Is_Certified#(lf)#(lf)#(tab)#(tab),fund.FundTypeIndex#(lf)#(tab)#(tab),fundtype.FundType#(lf)#(lf)#(tab)--select * #(lf)#(tab)from #(lf)#(tab)#(tab)millap.fundyear#(tab)#(tab)#(tab)#(tab)fundyear #(lf)#(tab)#(tab)join millap.fund#(tab)#(tab)#(tab)fund on fundyear.FundID = fund.FundID#(lf)#(tab)#(tab)join millap.fundtype#(tab)#(tab)fundtype on fund.FundTypeIndex = fundtype.[Index]#(lf)#(tab)--where fundyear.TaxYear = 2023#(lf)#(lf)), certified as (#(lf)#(tab)select#(lf)#(tab)#(tab)CertID#(lf)#(tab)#(tab),TaxAuthority#(lf)#(tab)#(tab),TaxYear#(lf)#(tab)#(tab),Certified = case when (Certified = 'true' or Certified = '5') then 'true' else 'false' end#(lf)#(tab)#(tab),GROSSASSESSED = convert(decimal(18,0), GROSSASSESSED)#(lf)#(tab)#(tab),TotalLevy#(lf)#(tab)#(tab),TotalGrossRevenue#(lf)#(tab)from millap.cert#(lf)#(tab)where 1=1#(lf)#(tab)#(tab)and (Certified = 'true' or Certified = '5')#(lf)#(tab)#(tab)--and TaxYear = 2023#(lf))#(lf)select#(tab)#(lf)#(tab)ta.TaxYear#(lf)#(tab),ta.TaxAuthority#(lf)#(tab),ta.TaxingEntity#(lf)#(tab),ta.AUTHORITYTYPE#(lf)#(tab),c.Certified#(lf)#(tab),c.GROSSASSESSED#(lf)#(tab)--numbers#(lf)#(tab),fy.Levy #(lf)#(tab),fy.GrossRevenue #(lf)#(tab),TotalLevyByTaxAuthority = (select sum(fby.Levy) from fundbyyear fby where fby.TaxAuthority = ta.TaxAuthority and fby.TaxYear = ta.TAXYEAR group by fby.TaxAuthority,fby.TaxYear)#(lf)#(tab)--,c.TotalLevy#(lf)#(tab),TotalGrossRevenuByTaxAuthority = (select sum(fby.GrossRevenue) from fundbyyear fby where fby.TaxAuthority = ta.TaxAuthority and fby.TaxYear = ta.TAXYEAR group by fby.TaxAuthority,fby.TaxYear)#(lf)#(tab)--,c.TotalGrossRevenue#(lf)#(tab),fy.DateOfIssue#(tab)#(lf)#(tab),fy.MaturityDate#(lf)#(tab),fy.TermInYears#(lf)#(tab),FundYear_Is_Certified = fy.Is_Certified#(lf)#(tab)--used to map positions#(lf)#(tab),fy.FundTypeIndex#(lf)#(tab),fy.FundType#(lf)#(tab),rownum = ROW_NUMBER() over(partition by ta.taxyear,ta.TaxAuthority, fy.FundTypeIndex order by fy.FundTypeIndex, isnull(fy.Levy, 999999)) #(lf)from TAXAUTHORITYDETAIL ta#(lf)#(tab)join certified c on ta.TaxAuthority = c.TaxAuthority and ta.TAXYEAR = c.TaxYear#(lf)#(tab)join fundbyyear fy on ta.TaxAuthority = fy.TaxAuthority and ta.TAXYEAR = fy.TaxYear#(lf)--where ta.TAXYEAR = @taxyear#(lf)order by 1, 2#(lf)\", CreateNavigationProperties=false]),",
                "    #\"Filtered Year\" = Table.SelectRows(Source, each [TaxYear] = TaxYear_Param or [TaxYear] = TaxYear_Param_LY),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Filtered Year\",{{\"TaxYear\", Int64.Type}, {\"TaxAuthority\", Int64.Type}, {\"Certified\", type logical}, {\"GROSSASSESSED\", Int64.Type}, {\"GrossRevenue\", Int64.Type}, {\"TotalGrossRevenuByTaxAuthority\", Int64.Type}}),",
                "    #\"Added Conditional Column\" = Table.AddColumn(#\"Changed Type\", \"Custom\", each if [Certified] = true then [TaxingEntity] else [TaxingEntity] & \" (DID NOT CERTIFY)\"),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"Custom\", \"AUTHORITYTYPE\", \"Certified\", \"GROSSASSESSED\", \"Levy\", \"GrossRevenue\", \"TotalLevyByTaxAuthority\", \"TotalGrossRevenuByTaxAuthority\", \"DateOfIssue\", \"MaturityDate\", \"TermInYears\", \"FundYear_Is_Certified\", \"FundTypeIndex\", \"FundType\"}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Reordered Columns\",{\"TaxingEntity\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Custom\", \"TaxingEntity\"}}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Renamed Columns\", {\"FundTypeIndex\"}, FundType_Position, {\"Index\"}, \"FundType_Position\", JoinKind.LeftOuter),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged Queries\", \"FundType_Position\", {\"Position_Schools\"}, {\"Position\"}),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Expanded FundType_Position\", \"PositionRowGroup\", each if Number.Mod([Position],2) = 0",
                "then 2 ",
                "else Number.Mod([Position],2)),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Added Custom\",{{\"Position\", Int64.Type}, {\"PositionRowGroup\", Int64.Type}}),",
                "    #\"Replaced Value\" = Table.ReplaceValue(#\"Changed Type1\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"DateOfIssue\"}),",
                "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Replaced Value\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"MaturityDate\"}),",
                "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",0,null,Replacer.ReplaceValue,{\"TermInYears\"}),",
                "    #\"Added Levy12\" = Table.AddColumn(#\"Replaced Value2\", \"Levy12\", each if [Position] = 1 or [Position] = 2 then [Levy] else null),",
                "    #\"Added GrossRevenue12\" = Table.AddColumn(#\"Added Levy12\", \"GrossRevenue12\", each if [Position] = 1 or [Position] = 2 then [GrossRevenue] else null),",
                "    #\"Added Levy34\" = Table.AddColumn(#\"Added GrossRevenue12\", \"Levy34\", each if [Position] = 3 or [Position] = 4 then [Levy] else null),",
                "    #\"Added GrossRevenue34\" = Table.AddColumn(#\"Added Levy34\", \"GrossRevenue34\", each if [Position] = 3 or [Position] = 4 then [GrossRevenue] else null),",
                "    #\"Added Levy56\" = Table.AddColumn(#\"Added GrossRevenue34\", \"Levy56\", each if [Position] = 5 or [Position] = 6 then [Levy] else null),",
                "    #\"Added GrossRevenue56\" = Table.AddColumn(#\"Added Levy56\", \"GrossRevenue56\", each if [Position] = 5 or [Position] = 6 then [GrossRevenue] else null),",
                "    #\"Added Levy78\" = Table.AddColumn(#\"Added GrossRevenue56\", \"Levy78\", each if [Position] = 7 or [Position] = 8 then [Levy] else null),",
                "    #\"Added GrossRevenue78\" = Table.AddColumn(#\"Added Levy78\", \"GrossRevenue78\", each if [Position] = 7 or [Position] = 8 then [GrossRevenue] else null),",
                "",
                "    #\"Grouped Rows\" = Table.Group(#\"Added GrossRevenue78\", {\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"PositionRowGroup\", \"rownum\", \"Certified\"}, {{\"GROSSASSESSED\", each List.Max([GROSSASSESSED]), type nullable number}, {\"Levy12\", each List.Sum([Levy12]), type nullable number}, {\"GrossRevenue12\", each List.Sum([GrossRevenue12]), type nullable number}, {\"Levy34\", each List.Sum([Levy34]), type nullable number}, {\"GrossRevenue34\", each List.Sum([GrossRevenue34]), type nullable number}, {\"Levy56\", each List.Sum([Levy56]), type nullable number}, {\"GrossRevenue56\", each List.Sum([GrossRevenue56]), type nullable number}, {\"Levy78\", each List.Sum([Levy78]), type nullable number}, {\"GrossRevenue78\", each List.Sum([GrossRevenue78]), type nullable number}, {\"TotalLevy\", each List.Max([TotalLevyByTaxAuthority]), type nullable number}, {\"TotalGrossRevenue\", each List.Max([TotalGrossRevenuByTaxAuthority]), type nullable number}}),",
                "    #\"Added Position12\" = Table.AddColumn(#\"Grouped Rows\", \"Position12\", each if [PositionRowGroup] = 1",
                "then \"(1)\"",
                "else \"(2)\"),",
                "    #\"Added Position34\" = Table.AddColumn(#\"Added Position12\", \"Position34\", each if [PositionRowGroup] = 1",
                "then \"(3)\"",
                "else \"(4)\"),",
                "    #\"Added Position56\" = Table.AddColumn(#\"Added Position34\", \"Position56\", each if [PositionRowGroup] = 1",
                "then \"(5)\"",
                "else \"(6)\"),",
                "    #\"Added Position78\" = Table.AddColumn(#\"Added Position56\", \"Position78\", each if [PositionRowGroup] = 1",
                "then \"(7)\"",
                "else \"(8)\"),",
                "    #\"Added StateReportTabSection\" = Table.AddColumn(#\"Added Position78\", \"StateReportTabSection\", each \"Schools\")",
                "in",
                "    #\"Added StateReportTabSection\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "City (3)",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d1cd71c7-f0b1-4617-b03c-203875bd9c8a",
            "sourceColumn": "TaxYear",
            "summarizeBy": "sum"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "31bab0f2-43ce-413c-8385-dc5d887c9726",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "sum"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "3036c85c-9f3a-4127-a591-e332073925f5",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e8e93eb3-2685-48ed-b144-46fe05afcd8f",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "sum"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "086744f1-42ea-46a0-92b4-55de0db79028",
            "sourceColumn": "rownum",
            "summarizeBy": "sum"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "ed88f738-745e-4bcf-a74c-a4b4ff7646d4",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "4131f91c-9cee-4b96-9a41-84016c3c7462",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "e77fc281-fe3e-408a-bff5-7deb7f1753ec",
            "sourceColumn": "Levy12",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "ec4f84ee-a970-4adc-aff9-23423fdd617f",
            "sourceColumn": "GrossRevenue12",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "c0369526-610e-42ad-a836-1514fd024b09",
            "sourceColumn": "Levy34",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "81815410-460b-4ac1-81da-df8d98562343",
            "sourceColumn": "GrossRevenue34",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "5af86cbb-007f-409f-83b7-4473dbe287bf",
            "sourceColumn": "Levy56",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "826dd190-753c-4a9e-a144-ceaecd6552ca",
            "sourceColumn": "GrossRevenue56",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "9f6a4c2e-7ac1-41b1-b711-139431d12a29",
            "sourceColumn": "Levy78",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "66a4a20d-f62a-43ea-ac03-119d4ddaccd5",
            "sourceColumn": "GrossRevenue78",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "c520ec91-6b34-49e2-8d54-47fcb1b8fe5c",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "c546fb4a-ea33-41e1-a65b-2799712cf17b",
            "sourceColumn": "TotalGrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "Position12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7745e54a-37d1-469e-8607-d05776054d24",
            "sourceColumn": "Position12",
            "summarizeBy": "none"
          },
          {
            "name": "Position34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "71d20847-e3fa-42d8-97ac-40fe4dfc8fb3",
            "sourceColumn": "Position34",
            "summarizeBy": "none"
          },
          {
            "name": "Position56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "eefa7aa4-f1f7-40a9-b1c9-c24afbd06084",
            "sourceColumn": "Position56",
            "summarizeBy": "none"
          },
          {
            "name": "Position78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "66a5d922-82fc-4e19-bea3-d6fddc169247",
            "sourceColumn": "Position78",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6881492e-4fc0-4632-8052-6095cc3d2eef",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "65781cfc-7e7f-4eac-8bcf-54dbeab88436",
        "partitions": [
          {
            "name": "City (3)",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database, [Query=\"with TAXAUTHORITYDETAIL as (#(lf)#(tab)select  #(lf)#(tab)#(tab) authoritydetail.TaxYear#(lf)#(tab)#(tab),authority.authorityname TaxingEntity#(lf)#(tab)#(tab),authority.TaxAuthority#(lf)#(tab)#(tab),authority.AUTHORITYTYPE#(lf)#(lf)#(tab)#(tab)from#(tab)#(tab)encompass.tlkptaxauthority#(tab)#(tab)#(tab)authority#(lf)#(tab)#(tab)join#(tab)#(tab)encompass.TLKPTAXAUTHORITYDETAIL#(tab)authoritydetail on authoritydetail.TAXAUTHORITY = authority.TAXAUTHORITY #(lf)#(tab)#(tab)where authority.TAXAUTHORITY is not null#(lf)#(tab)#(tab)#(tab)and authoritydetail.ACTIVEFLAG = 1#(lf)#(tab)#(tab)#(tab)and authority.AUTHORITYTYPE = 'City'#(lf)#(tab)#(tab)#(tab)--and authoritydetail.TAXYEAR = 2023#(lf)), fundbyyear as (#(lf)#(tab)select --distinct #(lf)#(tab)#(tab) fundyear.TaxYear#(lf)#(tab)#(tab),fundyear.FundYearId#(lf)#(tab)#(tab),Levy = case when fundtype.FundType = 'TEMP TAX CREDIT' then (fundyear.Levy * -1) else fundyear.Levy end#(lf)#(tab)#(tab),GrossRevenue = case when fundtype.FundType = 'TEMP TAX CREDIT' then (fundyear.GrossRevenue * -1) else fundyear.GrossRevenue end#(lf)#(lf)#(tab)#(tab),fund.FundID#(lf)#(tab)#(tab),fund.TaxAuthority#(lf)#(tab)#(tab),fund.Name#(lf)#(tab)#(tab),fund.DateOfIssue#(tab)#(lf)#(tab)#(tab),fund.MaturityDate#(lf)#(tab)#(tab),TermInYears = DateDiff(year, fund.MaturityDate, fund.DateOfIssue)#(lf)#(tab)#(tab),fund.Is_Active#(lf)#(tab)#(tab),fund.Is_Certified#(lf)#(lf)#(tab)#(tab),fund.FundTypeIndex#(lf)#(tab)#(tab),fundtype.FundType#(lf)#(lf)#(tab)--select * #(lf)#(tab)from #(lf)#(tab)#(tab)millap.fundyear#(tab)#(tab)#(tab)#(tab)fundyear #(lf)#(tab)#(tab)join millap.fund#(tab)#(tab)#(tab)fund on fundyear.FundID = fund.FundID#(lf)#(tab)#(tab)join millap.fundtype#(tab)#(tab)fundtype on fund.FundTypeIndex = fundtype.[Index]#(lf)#(tab)--where fundyear.TaxYear = 2023#(lf)#(lf)), certified as (#(lf)#(tab)select#(lf)#(tab)#(tab)CertID#(lf)#(tab)#(tab),TaxAuthority#(lf)#(tab)#(tab),TaxYear#(lf)#(tab)#(tab),Certified = case when (Certified = 'true' or Certified = '5') then 'true' else 'false' end#(lf)#(tab)#(tab),GROSSASSESSED = convert(decimal(18,0), GROSSASSESSED)#(lf)#(tab)#(tab),TotalLevy#(lf)#(tab)#(tab),TotalGrossRevenue#(lf)#(tab)from millap.cert#(lf)#(tab)where 1=1#(lf)#(tab)#(tab)and (Certified = 'true' or Certified = '5')#(lf)#(tab)#(tab)--and TaxYear = 2023#(lf))#(lf)select#(tab)#(lf)#(tab)ta.TaxYear#(lf)#(tab),ta.TaxAuthority#(lf)#(tab),ta.TaxingEntity#(lf)#(tab),ta.AUTHORITYTYPE#(lf)#(tab),c.Certified#(lf)#(tab),c.GROSSASSESSED#(lf)#(tab)--numbers#(lf)#(tab),fy.Levy #(lf)#(tab),fy.GrossRevenue #(lf)#(tab),TotalLevyByTaxAuthority = (select sum(fby.Levy) from fundbyyear fby where fby.TaxAuthority = ta.TaxAuthority and fby.TaxYear = ta.TAXYEAR group by fby.TaxAuthority,fby.TaxYear)#(lf)#(tab)--,c.TotalLevy#(lf)#(tab),TotalGrossRevenuByTaxAuthority = (select sum(fby.GrossRevenue) from fundbyyear fby where fby.TaxAuthority = ta.TaxAuthority and fby.TaxYear = ta.TAXYEAR group by fby.TaxAuthority,fby.TaxYear)#(lf)#(tab)--,c.TotalGrossRevenue#(lf)#(tab),fy.DateOfIssue#(tab)#(lf)#(tab),fy.MaturityDate#(lf)#(tab),fy.TermInYears#(lf)#(tab),FundYear_Is_Certified = fy.Is_Certified#(lf)#(tab)--used to map positions#(lf)#(tab),fy.FundTypeIndex#(lf)#(tab),fy.FundType#(lf)#(tab),rownum = ROW_NUMBER() over(partition by ta.taxyear,ta.TaxAuthority, fy.FundTypeIndex order by fy.FundTypeIndex, isnull(fy.Levy, 999999)) #(lf)from TAXAUTHORITYDETAIL ta#(lf)#(tab)join certified c on ta.TaxAuthority = c.TaxAuthority and ta.TAXYEAR = c.TaxYear#(lf)#(tab)join fundbyyear fy on ta.TaxAuthority = fy.TaxAuthority and ta.TAXYEAR = fy.TaxYear#(lf)--where ta.TAXYEAR = @taxyear#(lf)order by 1, 2#(lf)\", CreateNavigationProperties=false]),",
                "    #\"Filtered Year\" = Table.SelectRows(Source, each [TaxYear] = TaxYear_Param or [TaxYear] = TaxYear_Param_LY),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Filtered Year\",{{\"TaxYear\", Int64.Type}, {\"TaxAuthority\", Int64.Type}, {\"Certified\", type logical}, {\"GROSSASSESSED\", Int64.Type}, {\"GrossRevenue\", Int64.Type}, {\"TotalGrossRevenuByTaxAuthority\", Int64.Type}}),",
                "    #\"Added Conditional Column\" = Table.AddColumn(#\"Changed Type\", \"Custom\", each if [Certified] = true then [TaxingEntity] else [TaxingEntity] & \" (DID NOT CERTIFY)\"),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"Custom\", \"AUTHORITYTYPE\", \"Certified\", \"GROSSASSESSED\", \"Levy\", \"GrossRevenue\", \"TotalLevyByTaxAuthority\", \"TotalGrossRevenuByTaxAuthority\", \"DateOfIssue\", \"MaturityDate\", \"TermInYears\", \"FundYear_Is_Certified\", \"FundTypeIndex\", \"FundType\"}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Reordered Columns\",{\"TaxingEntity\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Custom\", \"TaxingEntity\"}}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Renamed Columns\", {\"FundTypeIndex\"}, FundType_Position, {\"Index\"}, \"FundType_Position\", JoinKind.LeftOuter),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged Queries\", \"FundType_Position\", {\"Position_City\"}, {\"Position\"}),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Expanded FundType_Position\", \"PositionRowGroup\", each if Number.Mod([Position],2) = 0",
                "then 2 ",
                "else Number.Mod([Position],2)),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Added Custom\",{{\"Position\", Int64.Type}, {\"PositionRowGroup\", Int64.Type}}),",
                "    #\"Replaced Value\" = Table.ReplaceValue(#\"Changed Type1\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"DateOfIssue\"}),",
                "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Replaced Value\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"MaturityDate\"}),",
                "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",0,null,Replacer.ReplaceValue,{\"TermInYears\"}),",
                "    #\"Added Levy12\" = Table.AddColumn(#\"Replaced Value2\", \"Levy12\", each if [Position] = 1 or [Position] = 2 then [Levy] else null),",
                "    #\"Added GrossRevenue12\" = Table.AddColumn(#\"Added Levy12\", \"GrossRevenue12\", each if [Position] = 1 or [Position] = 2 then [GrossRevenue] else null),",
                "    #\"Added Levy34\" = Table.AddColumn(#\"Added GrossRevenue12\", \"Levy34\", each if [Position] = 3 or [Position] = 4 then [Levy] else null),",
                "    #\"Added GrossRevenue34\" = Table.AddColumn(#\"Added Levy34\", \"GrossRevenue34\", each if [Position] = 3 or [Position] = 4 then [GrossRevenue] else null),",
                "    #\"Added Levy56\" = Table.AddColumn(#\"Added GrossRevenue34\", \"Levy56\", each if [Position] = 5 or [Position] = 6 then [Levy] else null),",
                "    #\"Added GrossRevenue56\" = Table.AddColumn(#\"Added Levy56\", \"GrossRevenue56\", each if [Position] = 5 or [Position] = 6 then [GrossRevenue] else null),",
                "    #\"Added Levy78\" = Table.AddColumn(#\"Added GrossRevenue56\", \"Levy78\", each if [Position] = 7 or [Position] = 8 then [Levy] else null),",
                "    #\"Added GrossRevenue78\" = Table.AddColumn(#\"Added Levy78\", \"GrossRevenue78\", each if [Position] = 7 or [Position] = 8 then [GrossRevenue] else null),",
                "",
                "    #\"Grouped Rows\" = Table.Group(#\"Added GrossRevenue78\", {\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"PositionRowGroup\", \"rownum\", \"Certified\"}, {{\"GROSSASSESSED\", each List.Max([GROSSASSESSED]), type nullable number}, {\"Levy12\", each List.Sum([Levy12]), type nullable number}, {\"GrossRevenue12\", each List.Sum([GrossRevenue12]), type nullable number}, {\"Levy34\", each List.Sum([Levy34]), type nullable number}, {\"GrossRevenue34\", each List.Sum([GrossRevenue34]), type nullable number}, {\"Levy56\", each List.Sum([Levy56]), type nullable number}, {\"GrossRevenue56\", each List.Sum([GrossRevenue56]), type nullable number}, {\"Levy78\", each List.Sum([Levy78]), type nullable number}, {\"GrossRevenue78\", each List.Sum([GrossRevenue78]), type nullable number}, {\"TotalLevy\", each List.Max([TotalLevyByTaxAuthority]), type nullable number}, {\"TotalGrossRevenue\", each List.Max([TotalGrossRevenuByTaxAuthority]), type nullable number}}),",
                "    #\"Added Position12\" = Table.AddColumn(#\"Grouped Rows\", \"Position12\", each if [PositionRowGroup] = 1",
                "then \"(1)\"",
                "else \"(2)\"),",
                "    #\"Added Position34\" = Table.AddColumn(#\"Added Position12\", \"Position34\", each if [PositionRowGroup] = 1",
                "then \"(3)\"",
                "else \"(4)\"),",
                "    #\"Added Position56\" = Table.AddColumn(#\"Added Position34\", \"Position56\", each if [PositionRowGroup] = 1",
                "then \"(5)\"",
                "else \"(6)\"),",
                "    #\"Added Position78\" = Table.AddColumn(#\"Added Position56\", \"Position78\", each if [PositionRowGroup] = 1",
                "then \"(7)\"",
                "else \"(8)\"),",
                "    #\"Added StateReportTabSection\" = Table.AddColumn(#\"Added Position78\", \"StateReportTabSection\", each \"City\")",
                "in",
                "    #\"Added StateReportTabSection\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "County (3)",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "6ac61c43-005b-46bf-a91f-01e19c211760",
            "sourceColumn": "TaxYear",
            "summarizeBy": "sum"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "91465844-37e1-4ad8-8e50-42a25668ed1f",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "sum"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7646e5a5-0728-4847-bbd5-8f8063c82313",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "AUTHORITYTYPE",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "09247d3a-2954-4bb7-acb6-be613e53d6ad",
            "sourceColumn": "AUTHORITYTYPE",
            "summarizeBy": "none"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "4fd2654d-c443-4c1d-8b6c-8f62c63a5936",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "f6e2b5d5-0da1-4800-a94d-7d604a26822e",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "c27c1d2e-ef58-4622-80f6-c58e1a095389",
            "sourceColumn": "Levy",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "a933cc31-5f9a-400b-b504-3031ec792548",
            "sourceColumn": "GrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevyByTaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "6c689b47-2b6a-48fd-b766-9005ee5cf31a",
            "sourceColumn": "TotalLevyByTaxAuthority",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalGrossRevenuByTaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "83c4e65e-cdae-44b2-831c-f7de525170a6",
            "sourceColumn": "TotalGrossRevenuByTaxAuthority",
            "summarizeBy": "sum"
          },
          {
            "name": "DateOfIssue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e1c79425-fcf3-4a93-87fb-34943cc7d08b",
            "sourceColumn": "DateOfIssue",
            "summarizeBy": "none"
          },
          {
            "name": "MaturityDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "89f67391-c150-4849-bf9e-fd030b0fab31",
            "sourceColumn": "MaturityDate",
            "summarizeBy": "none"
          },
          {
            "name": "TermInYears",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ce43267a-fb99-4b6a-8980-a1c3d1ce1498",
            "sourceColumn": "TermInYears",
            "summarizeBy": "sum"
          },
          {
            "name": "FundYear_Is_Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "8f8cbdd6-f668-43e9-b9ce-38b50dc4c7e5",
            "sourceColumn": "FundYear_Is_Certified",
            "summarizeBy": "none"
          },
          {
            "name": "FundTypeIndex",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "45ae2abd-a61d-44ef-a5cf-68158569b67c",
            "sourceColumn": "FundTypeIndex",
            "summarizeBy": "sum"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "9baecea6-08bd-45a0-94ca-90e0a96339f4",
            "sourceColumn": "rownum",
            "summarizeBy": "sum"
          },
          {
            "name": "FundType",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "3af9c549-f036-4daf-a943-d0a245611cbe",
            "sourceColumn": "FundType",
            "summarizeBy": "none"
          },
          {
            "name": "Position",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "710bf749-312d-4996-8413-31f1ee7b3a5d",
            "sourceColumn": "Position",
            "summarizeBy": "sum"
          },
          {
            "name": "CountyCode",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "5024664d-d317-4618-848f-c04a9d8410a5",
            "sourceColumn": "CountyCode",
            "summarizeBy": "count"
          },
          {
            "name": "FundTypeName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "13b55409-06db-4d0e-892e-288fa7f20b2a",
            "sourceColumn": "FundTypeName",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "01edb716-fc43-4bc1-aa36-55da9712e748",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4ccd84ad-d9a5-49c1-b3e2-2051b76fb24e",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "34b157db-f968-413e-bbb0-ad09069e6099",
        "partitions": [
          {
            "name": "County (3)",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database, [Query=\"with TAXAUTHORITYDETAIL as (#(lf)#(tab)select  #(lf)#(tab)#(tab) authoritydetail.TaxYear#(lf)#(tab)#(tab),authority.authorityname TaxingEntity#(lf)#(tab)#(tab),authority.TaxAuthority#(lf)#(tab)#(tab),authority.AUTHORITYTYPE#(lf)#(lf)#(tab)#(tab)from#(tab)#(tab)encompass.tlkptaxauthority#(tab)#(tab)#(tab)authority#(lf)#(tab)#(tab)join#(tab)#(tab)encompass.TLKPTAXAUTHORITYDETAIL#(tab)authoritydetail on authoritydetail.TAXAUTHORITY = authority.TAXAUTHORITY #(lf)#(tab)#(tab)where authority.TAXAUTHORITY is not null#(lf)#(tab)#(tab)#(tab)and authoritydetail.ACTIVEFLAG = 1#(lf)#(tab)#(tab)#(tab)and authority.AUTHORITYTYPE = 'County'#(lf)#(tab)#(tab)#(tab)--and authoritydetail.TAXYEAR = 2023#(lf)), fundbyyear as (#(lf)#(tab)select --distinct #(lf)#(tab)#(tab) fundyear.TaxYear#(lf)#(tab)#(tab),fundyear.FundYearId#(lf)#(tab)#(tab),Levy = case when fundtype.FundType = 'TEMP TAX CREDIT' then (fundyear.Levy * -1) else fundyear.Levy end#(lf)#(tab)#(tab),GrossRevenue = case when fundtype.FundType = 'TEMP TAX CREDIT' then (fundyear.GrossRevenue * -1) else fundyear.GrossRevenue end#(lf)#(lf)#(tab)#(tab),fund.FundID#(lf)#(tab)#(tab),fund.TaxAuthority#(lf)#(tab)#(tab),fund.Name#(lf)#(tab)#(tab),fund.DateOfIssue#(tab)#(lf)#(tab)#(tab),fund.MaturityDate#(lf)#(tab)#(tab),TermInYears = DateDiff(year, fund.MaturityDate, fund.DateOfIssue)#(lf)#(tab)#(tab),fund.Is_Active#(lf)#(tab)#(tab),fund.Is_Certified#(lf)#(lf)#(tab)#(tab),fund.FundTypeIndex#(lf)#(tab)#(tab),fundtype.FundType#(lf)#(lf)#(tab)--select * #(lf)#(tab)from #(lf)#(tab)#(tab)millap.fundyear#(tab)#(tab)#(tab)#(tab)fundyear #(lf)#(tab)#(tab)join millap.fund#(tab)#(tab)#(tab)fund on fundyear.FundID = fund.FundID#(lf)#(tab)#(tab)join millap.fundtype#(tab)#(tab)fundtype on fund.FundTypeIndex = fundtype.[Index]#(lf)#(tab)--where fundyear.TaxYear = 2023#(lf)#(lf)), certified as (#(lf)#(tab)select#(lf)#(tab)#(tab)CertID#(lf)#(tab)#(tab),TaxAuthority#(lf)#(tab)#(tab),TaxYear#(lf)#(tab)#(tab),Certified = case when (Certified = 'true' or Certified = '5') then 'true' else 'false' end#(lf)#(tab)#(tab),GROSSASSESSED = convert(decimal(18,0), GROSSASSESSED)#(lf)#(tab)#(tab),TotalLevy#(lf)#(tab)#(tab),TotalGrossRevenue#(lf)#(tab)from millap.cert#(lf)#(tab)where 1=1#(lf)#(tab)#(tab)and (Certified = 'true' or Certified = '5')#(lf)#(tab)#(tab)--and TaxYear = 2023#(lf))#(lf)select#(tab)#(lf)#(tab)ta.TaxYear#(lf)#(tab),ta.TaxAuthority#(lf)#(tab),ta.TaxingEntity#(lf)#(tab),ta.AUTHORITYTYPE#(lf)#(tab),c.Certified#(lf)#(tab),c.GROSSASSESSED#(lf)#(tab)--numbers#(lf)#(tab),fy.Levy #(lf)#(tab),fy.GrossRevenue #(lf)#(tab),TotalLevyByTaxAuthority = (select sum(fby.Levy) from fundbyyear fby where fby.TaxAuthority = ta.TaxAuthority and fby.TaxYear = ta.TAXYEAR group by fby.TaxAuthority,fby.TaxYear)#(lf)#(tab)--,c.TotalLevy#(lf)#(tab),TotalGrossRevenuByTaxAuthority = (select sum(fby.GrossRevenue) from fundbyyear fby where fby.TaxAuthority = ta.TaxAuthority and fby.TaxYear = ta.TAXYEAR group by fby.TaxAuthority,fby.TaxYear)#(lf)#(tab)--,c.TotalGrossRevenue#(lf)#(tab),fy.DateOfIssue#(tab)#(lf)#(tab),fy.MaturityDate#(lf)#(tab),fy.TermInYears#(lf)#(tab),FundYear_Is_Certified = fy.Is_Certified#(lf)#(tab)--used to map positions#(lf)#(tab),fy.FundTypeIndex#(lf)#(tab),fy.FundType#(lf)#(tab),rownum = ROW_NUMBER() over(partition by ta.taxyear,ta.TaxAuthority, fy.FundTypeIndex order by fy.FundTypeIndex, isnull(fy.Levy, 999999)) #(lf)from TAXAUTHORITYDETAIL ta#(lf)#(tab)join certified c on ta.TaxAuthority = c.TaxAuthority and ta.TAXYEAR = c.TaxYear#(lf)#(tab)join fundbyyear fy on ta.TaxAuthority = fy.TaxAuthority and ta.TAXYEAR = fy.TaxYear#(lf)--where ta.TAXYEAR = @taxyear#(lf)order by 1, 2#(lf)\", CreateNavigationProperties=false]),",
                "    #\"Filtered Year\" = Table.SelectRows(Source, each [TaxYear] = TaxYear_Param or [TaxYear] = TaxYear_Param_LY),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Filtered Year\",{{\"TaxYear\", Int64.Type}, {\"TaxAuthority\", Int64.Type}, {\"Certified\", type logical}, {\"GROSSASSESSED\", Int64.Type}, {\"GrossRevenue\", Int64.Type}, {\"TotalGrossRevenuByTaxAuthority\", Int64.Type}}),",
                "    #\"Added Conditional Column\" = Table.AddColumn(#\"Changed Type\", \"Custom\", each if [Certified] = true then [TaxingEntity] else [TaxingEntity] & \" (DID NOT CERTIFY)\"),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"Custom\", \"AUTHORITYTYPE\", \"Certified\", \"GROSSASSESSED\", \"Levy\", \"GrossRevenue\", \"TotalLevyByTaxAuthority\", \"TotalGrossRevenuByTaxAuthority\", \"DateOfIssue\", \"MaturityDate\", \"TermInYears\", \"FundYear_Is_Certified\", \"FundTypeIndex\", \"FundType\"}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Reordered Columns\",{\"TaxingEntity\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Custom\", \"TaxingEntity\"}}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Renamed Columns\", {\"FundTypeIndex\"}, FundType_Position, {\"Index\"}, \"FundType_Position\", JoinKind.FullOuter),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged Queries\", \"FundType_Position\", {\"Position_County\",\"CountyCode\",\"Name\"}, {\"Position\",\"CountyCode\", \"FundTypeName\"}),",
                "    #\"Added PositionRowGroup\" = Table.AddColumn(#\"Expanded FundType_Position\", \"PositionRowGroup\", each if Number.Mod([Position],2) = 0",
                "then 2 ",
                "else Number.Mod([Position],2)),",
                "    #\"Added StateReportTabSection\" = Table.AddColumn(#\"Added PositionRowGroup\", \"StateReportTabSection\", each \"County\"),",
                "    #\"Replaced Value\" = Table.ReplaceValue(#\"Added StateReportTabSection\",null,1,Replacer.ReplaceValue,{\"TaxAuthority\"}),",
                "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Replaced Value\",null,\"Douglas County Government\",Replacer.ReplaceValue,{\"TaxingEntity\"}),",
                "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",null,\"County\",Replacer.ReplaceValue,{\"AUTHORITYTYPE\"})",
                "in",
                "    #\"Replaced Value2\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Non Title 32 (3)",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "aeb045b2-e8e3-4758-ab97-249ffc944afc",
            "sourceColumn": "TaxYear",
            "summarizeBy": "none"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "3dc59dd4-70bf-4bde-8a91-2ed5d13d9bbd",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ce5c2fb9-3f30-40f1-b863-4110a29e03e8",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2fdea0a3-96d9-49bc-baeb-fbabf9238884",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "none"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "445984fa-25ed-4930-a976-23788b48fc72",
            "sourceColumn": "rownum",
            "summarizeBy": "none"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "f4e3d9f3-711e-4fe1-9d96-e8b6b22dbb34",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "83aa49d6-f1f8-4e3e-942b-f3ec4d11c4f2",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "none"
          },
          {
            "name": "Levy12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "7549d4af-6fb5-4b9d-afe3-cf3d43808e58",
            "sourceColumn": "Levy12",
            "summarizeBy": "none"
          },
          {
            "name": "GrossRevenue12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "8215ec0c-cb8e-4dfc-bd63-52c0c6944790",
            "sourceColumn": "GrossRevenue12",
            "summarizeBy": "none"
          },
          {
            "name": "Levy34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "cd39d119-9bad-463a-99d4-20198815f05b",
            "sourceColumn": "Levy34",
            "summarizeBy": "none"
          },
          {
            "name": "GrossRevenue34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "96792fc9-94f6-4c47-b983-2f8622d1bd45",
            "sourceColumn": "GrossRevenue34",
            "summarizeBy": "none"
          },
          {
            "name": "Levy56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "cb37ce0c-051e-49e3-b107-0f69f803d531",
            "sourceColumn": "Levy56",
            "summarizeBy": "none"
          },
          {
            "name": "GrossRevenue56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "2ec1f442-fa68-4caa-982e-50e3e5548070",
            "sourceColumn": "GrossRevenue56",
            "summarizeBy": "none"
          },
          {
            "name": "Levy78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "0f28344f-08e6-4221-8f14-3628e5deb8e3",
            "sourceColumn": "Levy78",
            "summarizeBy": "none"
          },
          {
            "name": "GrossRevenue78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "7ad143b8-b210-41e6-bdab-b166251ab45f",
            "sourceColumn": "GrossRevenue78",
            "summarizeBy": "none"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "5985d336-2330-4d72-a937-fe51e98b229f",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "none"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "7ee2b82e-fd48-4454-92c3-b6de80b40597",
            "sourceColumn": "TotalGrossRevenue",
            "summarizeBy": "none"
          },
          {
            "name": "Position12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "974fb5a5-5a44-4d56-9a13-f9ce55864a5f",
            "sourceColumn": "Position12",
            "summarizeBy": "none"
          },
          {
            "name": "Position34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a06f107d-d429-448e-b42e-18ffa5943fec",
            "sourceColumn": "Position34",
            "summarizeBy": "none"
          },
          {
            "name": "Position56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "408439ff-20c5-4cdc-846f-96e8ff091bfe",
            "sourceColumn": "Position56",
            "summarizeBy": "none"
          },
          {
            "name": "Position78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c798bad3-774c-40aa-903b-e2958db1e8ee",
            "sourceColumn": "Position78",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "46c01d96-a440-443c-b92b-a1f9b9843e91",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "8b668bfc-cf28-448b-bb73-0fc663033e68",
        "partitions": [
          {
            "name": "Non Title 32 (3)",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database, [Query=\"with TAXAUTHORITYDETAIL as (#(lf)#(tab)select  #(lf)#(tab)#(tab) authoritydetail.TaxYear#(lf)#(tab)#(tab),TaxingEntity = authority.authorityname #(lf)#(tab)#(tab),TaxAuthority = authority.TaxAuthority#(lf)#(tab)#(tab),AuthorityType = authority.AUTHORITYTYPE#(lf)#(lf)#(tab)#(tab)from#(tab)encompass.tlkptaxauthority#(tab)#(tab)#(tab)authority#(lf)#(tab)#(tab)join#(tab)encompass.TLKPTAXAUTHORITYDETAIL#(tab)authoritydetail on authoritydetail.TAXAUTHORITY = authority.TAXAUTHORITY #(lf)#(tab)#(tab)--join#(tab)millap.TAXAUTHORITYINFO mauthorityinfo on mauthorityinfo.TAXAUTHORITY = authority.TAXAUTHORITY#(lf)#(tab)#(tab)where authority.TAXAUTHORITY is not null#(lf)#(tab)#(tab)#(tab)and authoritydetail.ACTIVEFLAG = 1#(lf)#(tab)#(tab)#(tab)--and mauthorityinfo.StateReportTab = 'NON 32'#(lf)#(tab)#(tab)#(tab)--and authoritydetail.TAXYEAR = 2023#(lf)#(lf)), fundbyyear as (#(lf)#(tab)select --distinct #(lf)#(tab)#(tab) fundyear.TaxYear#(lf)#(tab)#(tab),fundyear.FundYearId#(lf)#(tab)#(tab),Levy = case when fundtype.FundType = 'TEMP TAX CREDIT' then (fundyear.Levy * -1) else fundyear.Levy end#(lf)#(tab)#(tab),GrossRevenue = case when fundtype.FundType = 'TEMP TAX CREDIT' then (fundyear.GrossRevenue * -1) else fundyear.GrossRevenue end#(lf)#(lf)#(tab)#(tab),fund.FundID#(lf)#(tab)#(tab),fund.TaxAuthority#(lf)#(tab)#(tab),fund.Name#(lf)#(tab)#(tab),fund.DateOfIssue#(tab)#(lf)#(tab)#(tab),fund.MaturityDate#(lf)#(tab)#(tab),TermInYears = DateDiff(year, fund.MaturityDate, fund.DateOfIssue)#(lf)#(tab)#(tab),fund.Is_Active#(lf)#(tab)#(tab),fund.Is_Certified#(lf)#(lf)#(tab)#(tab),fund.FundTypeIndex#(lf)#(tab)#(tab),fundtype.FundType#(lf)#(lf)#(tab)--select * #(lf)#(tab)from #(lf)#(tab)#(tab)millap.fundyear#(tab)#(tab)#(tab)#(tab)fundyear #(lf)#(tab)#(tab)join millap.fund#(tab)#(tab)#(tab)fund on fundyear.FundID = fund.FundID#(lf)#(tab)#(tab)join millap.fundtype#(tab)#(tab)fundtype on fund.FundTypeIndex = fundtype.[Index]#(lf)#(tab)--where fundyear.TaxYear = 2023#(lf)#(lf)), certified as (#(lf)#(tab)select#(lf)#(tab)#(tab)CertID#(lf)#(tab)#(tab),TaxAuthority#(lf)#(tab)#(tab),TaxYear#(lf)#(tab)#(tab),Certified = case when (Certified = 'true' or Certified = '5') then 'true' else 'false' end#(lf)#(tab)#(tab),GROSSASSESSED = convert(decimal(18,0), GROSSASSESSED)#(lf)#(tab)#(tab),TotalLevy#(lf)#(tab)#(tab),TotalGrossRevenue#(lf)#(tab)from millap.cert#(lf)#(tab)where 1=1#(lf)#(tab)#(tab)and (Certified = 'true' or Certified = '5')#(lf)#(tab)#(tab)--and TaxYear = 2023#(lf))#(lf)select#(tab)#(lf)#(tab)ta.TaxYear#(lf)#(tab),ta.TaxAuthority#(lf)#(tab),ta.TaxingEntity#(lf)#(tab),ta.AUTHORITYTYPE#(lf)#(tab),c.Certified#(lf)#(tab),c.GROSSASSESSED#(lf)#(tab)--numbers#(lf)#(tab),fy.Levy #(lf)#(tab),fy.GrossRevenue #(lf)#(tab),TotalLevyByTaxAuthority = (select sum(fby.Levy) from fundbyyear fby where fby.TaxAuthority = ta.TaxAuthority and fby.TaxYear = ta.TAXYEAR group by fby.TaxAuthority,fby.TaxYear)#(lf)#(tab)--,c.TotalLevy#(lf)#(tab),TotalGrossRevenuByTaxAuthority = (select sum(fby.GrossRevenue) from fundbyyear fby where fby.TaxAuthority = ta.TaxAuthority and fby.TaxYear = ta.TAXYEAR group by fby.TaxAuthority,fby.TaxYear)#(lf)#(tab)--,c.TotalGrossRevenue#(lf)#(tab),fy.DateOfIssue#(tab)#(lf)#(tab),fy.MaturityDate#(lf)#(tab),fy.TermInYears#(lf)#(tab),FundYear_Is_Certified = fy.Is_Certified#(lf)#(tab)--used to map positions#(lf)#(tab),fy.FundTypeIndex#(lf)#(tab),fy.FundType#(lf)#(tab),rownum = ROW_NUMBER() over(partition by ta.taxyear,ta.TaxAuthority, fy.FundTypeIndex order by fy.FundTypeIndex, isnull(fy.Levy, 999999)) #(lf)from TAXAUTHORITYDETAIL ta#(lf)#(tab)join certified c on ta.TaxAuthority = c.TaxAuthority and ta.TAXYEAR = c.TaxYear#(lf)#(tab)join fundbyyear fy on ta.TaxAuthority = fy.TaxAuthority and ta.TAXYEAR = fy.TaxYear#(lf)--where ta.TAXYEAR = @taxyear#(lf)order by 1, 2#(lf)\", CreateNavigationProperties=false]),",
                "    #\"Filtered Year\" = Table.SelectRows(Source, each [TaxYear] = TaxYear_Param or [TaxYear] = TaxYear_Param_LY),",
                "    #\"Merged Tax Authority Info\" = Table.NestedJoin(#\"Filtered Year\", {\"TaxAuthority\"}, #\"Tax Authority Info\", {\"TaxAuthority\"}, \"Tax Authority Info\", JoinKind.Inner),",
                "    #\"Expanded Tax Authority Info\" = Table.ExpandTableColumn(#\"Merged Tax Authority Info\", \"Tax Authority Info\", {\"StateReportName\"}, {\"StateReportName\"}),",
                "    #\"Filtered NON 32\" = Table.SelectRows(#\"Expanded Tax Authority Info\", each ([StateReportName] = \"NON 32\")),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Filtered NON 32\",{{\"TaxYear\", Int64.Type}, {\"Certified\", type logical}, {\"GROSSASSESSED\", Int64.Type}, {\"GrossRevenue\", Int64.Type}, {\"TotalGrossRevenuByTaxAuthority\", Int64.Type}}),",
                "    #\"Added Conditional Column\" = Table.AddColumn(#\"Changed Type\", \"Custom\", each if [Certified] = true then [TaxingEntity] else [TaxingEntity] & \" (DID NOT CERTIFY)\"),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"Custom\", \"AUTHORITYTYPE\", \"Certified\", \"GROSSASSESSED\", \"Levy\", \"GrossRevenue\", \"TotalLevyByTaxAuthority\", \"TotalGrossRevenuByTaxAuthority\", \"DateOfIssue\", \"MaturityDate\", \"TermInYears\", \"FundYear_Is_Certified\", \"FundTypeIndex\", \"FundType\"}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Reordered Columns\",{\"TaxingEntity\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Custom\", \"TaxingEntity\"}}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Renamed Columns\", {\"FundTypeIndex\"}, FundType_Position, {\"Index\"}, \"FundType_Position\", JoinKind.LeftOuter),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged Queries\", \"FundType_Position\", {\"Position_NON_32\"}, {\"Position\"}),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Expanded FundType_Position\", \"PositionRowGroup\", each if Number.Mod([Position],2) = 0",
                "then 2 ",
                "else Number.Mod([Position],2)),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Added Custom\",{{\"Position\", Int64.Type}, {\"PositionRowGroup\", Int64.Type}}),",
                "    #\"Replaced Value\" = Table.ReplaceValue(#\"Changed Type1\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"DateOfIssue\"}),",
                "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Replaced Value\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"MaturityDate\"}),",
                "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",0,null,Replacer.ReplaceValue,{\"TermInYears\"}),",
                "    #\"Added Levy12\" = Table.AddColumn(#\"Replaced Value2\", \"Levy12\", each if [Position] = 1 or [Position] = 2 then [Levy] else null),",
                "    #\"Added GrossRevenue12\" = Table.AddColumn(#\"Added Levy12\", \"GrossRevenue12\", each if [Position] = 1 or [Position] = 2 then [GrossRevenue] else null),",
                "    #\"Added Levy34\" = Table.AddColumn(#\"Added GrossRevenue12\", \"Levy34\", each if [Position] = 3 or [Position] = 4 then [Levy] else null),",
                "    #\"Added GrossRevenue34\" = Table.AddColumn(#\"Added Levy34\", \"GrossRevenue34\", each if [Position] = 3 or [Position] = 4 then [GrossRevenue] else null),",
                "    #\"Added Levy56\" = Table.AddColumn(#\"Added GrossRevenue34\", \"Levy56\", each if [Position] = 5 or [Position] = 6 then [Levy] else null),",
                "    #\"Added GrossRevenue56\" = Table.AddColumn(#\"Added Levy56\", \"GrossRevenue56\", each if [Position] = 5 or [Position] = 6 then [GrossRevenue] else null),",
                "    #\"Added Levy78\" = Table.AddColumn(#\"Added GrossRevenue56\", \"Levy78\", each if [Position] = 7 or [Position] = 8 then [Levy] else null),",
                "    #\"Added GrossRevenue78\" = Table.AddColumn(#\"Added Levy78\", \"GrossRevenue78\", each if [Position] = 7 or [Position] = 8 then [GrossRevenue] else null),",
                "",
                "    #\"Grouped Rows\" = Table.Group(#\"Added GrossRevenue78\", {\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"PositionRowGroup\", \"rownum\", \"Certified\"}, {{\"GROSSASSESSED\", each List.Max([GROSSASSESSED]), type nullable number}, {\"Levy12\", each List.Sum([Levy12]), type nullable number}, {\"GrossRevenue12\", each List.Sum([GrossRevenue12]), type nullable number}, {\"Levy34\", each List.Sum([Levy34]), type nullable number}, {\"GrossRevenue34\", each List.Sum([GrossRevenue34]), type nullable number}, {\"Levy56\", each List.Sum([Levy56]), type nullable number}, {\"GrossRevenue56\", each List.Sum([GrossRevenue56]), type nullable number}, {\"Levy78\", each List.Sum([Levy78]), type nullable number}, {\"GrossRevenue78\", each List.Sum([GrossRevenue78]), type nullable number}, {\"TotalLevy\", each List.Max([TotalLevyByTaxAuthority]), type nullable number}, {\"TotalGrossRevenue\", each List.Max([TotalGrossRevenuByTaxAuthority]), type nullable number}}),",
                "    #\"Added Position12\" = Table.AddColumn(#\"Grouped Rows\", \"Position12\", each if [PositionRowGroup] = 1",
                "then \"(1)\"",
                "else \"(2)\"),",
                "    #\"Added Position34\" = Table.AddColumn(#\"Added Position12\", \"Position34\", each if [PositionRowGroup] = 1",
                "then \"(3)\"",
                "else \"(4)\"),",
                "    #\"Added Position56\" = Table.AddColumn(#\"Added Position34\", \"Position56\", each if [PositionRowGroup] = 1",
                "then \"(5)\"",
                "else \"(6)\"),",
                "    #\"Added Position78\" = Table.AddColumn(#\"Added Position56\", \"Position78\", each if [PositionRowGroup] = 1",
                "then \"(7)\"",
                "else \"(8)\"),",
                "    #\"Added StateReportTabSection\" = Table.AddColumn(#\"Added Position78\", \"StateReportTabSection\", each \"NON-32\")",
                "in",
                "    #\"Added StateReportTabSection\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Tax Authority Info",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "2b188f6c-2ff8-4729-ae94-be7e7dae09cb",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "0b8fa186-a0fe-4ad6-83ab-c653702038b0",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "none"
          },
          {
            "name": "GoverningBody",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7821bd40-3dfb-4c24-b97b-53a6691e868c",
            "sourceColumn": "GoverningBody",
            "summarizeBy": "none"
          },
          {
            "name": "LocalGovernment",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "042db4f6-8e00-41ad-8764-0f1a5a72bddb",
            "sourceColumn": "LocalGovernment",
            "summarizeBy": "none"
          },
          {
            "name": "StateAuthorityCode",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "75751f8a-46d4-4a1c-8eef-e31817b7f6c8",
            "sourceColumn": "StateAuthorityCode",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d72884af-cf74-4af0-a6c6-4c7eec9f327e",
            "sourceColumn": "StateReportName",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4bafe7d5-8ab5-498d-9578-402ec929b649",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSectionSortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "edb535fc-e924-4105-8663-e26bf5578385",
            "sourceColumn": "StateReportTabSectionSortOrder",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "e307e9a1-fc47-4dfa-a31f-14de0dcddf86",
        "partitions": [
          {
            "name": "Tax Authority Info",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(mds_server, mds_database),",
                "    mdm_Mill_Levy_TAXAUTHORITYINFO = Source{[Schema=\"mdm\",Item=\"Mill_Levy_TAXAUTHORITYINFO\"]}[Data],",
                "    #\"Removed Other Columns\" = Table.SelectColumns(mdm_Mill_Levy_TAXAUTHORITYINFO,{\"Name\", \"Code\", \"GoverningBody\", \"LocalGovernment\", \"StateAuthorityCode\", \"StateReportName\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Other Columns\",{{\"Code\", \"TaxAuthority\"}, {\"Name\", \"TaxingEntity\"}}),",
                "    #\"Trimmed Text\" = Table.TransformColumns(#\"Renamed Columns\",{{\"TaxAuthority\", Text.Trim, type text}}),",
                "    #\"Sorted Rows\" = Table.Sort(#\"Trimmed Text\",{{\"TaxAuthority\", Order.Ascending}})",
                "in",
                "    #\"Sorted Rows\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Title 32 (3)",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "6171ed39-51ba-4e69-9e23-e854d780ed96",
            "sourceColumn": "TaxYear",
            "summarizeBy": "sum"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "bc1b27a9-d2c9-4db2-ac3f-75e246e926d3",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e5e34e1f-f6f7-4c4e-b669-8b7d0fd3a665",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "2dd8e2b1-2fad-49f3-81b4-cf4802135431",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "6d09864e-625b-4cc0-a000-2bae5aeef0a1",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "sum"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4cbe2c4f-afb1-4261-8bb9-d5bedf4eabe4",
            "sourceColumn": "rownum",
            "summarizeBy": "sum"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "572e4339-77ee-4434-b1ec-e69118baeeb1",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "3f961ed5-f903-4caa-892f-745a1b0ead53",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "4bf8b16e-274b-4027-a046-ad21af901e77",
            "sourceColumn": "Levy12",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "d38d6b2a-0dad-4f28-a3a0-e9fcb36d49e0",
            "sourceColumn": "GrossRevenue12",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "d0e8bea2-064e-40cb-a4f0-c6e46b1237db",
            "sourceColumn": "Levy34",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "b4769058-359c-45ab-8600-31ef4b4f8dde",
            "sourceColumn": "GrossRevenue34",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "5b2ed902-5dea-4a86-b0fd-6b035ea6acc5",
            "sourceColumn": "Levy56",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "61974a44-82c3-4105-9fe2-ea31f99ed3a4",
            "sourceColumn": "GrossRevenue56",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "f7ba5dd9-251b-4e9b-80c1-de615c4add64",
            "sourceColumn": "Levy78",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "28c0a578-b76b-491b-92d8-429fbacf9620",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "72a66095-9179-4d56-b278-50aeb6303eaa",
            "sourceColumn": "TotalGrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "Position12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "dfe21d00-065a-4bf4-a4c2-fff43e780a0e",
            "sourceColumn": "Position12",
            "summarizeBy": "none"
          },
          {
            "name": "Position34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c8fe5083-7420-4dd3-ab7d-04df64d46d02",
            "sourceColumn": "Position34",
            "summarizeBy": "none"
          },
          {
            "name": "Position56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7e885193-49d8-4130-84f5-64487a556152",
            "sourceColumn": "Position56",
            "summarizeBy": "none"
          },
          {
            "name": "Position78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ce378a47-e87f-41b1-89e0-d38d0d663679",
            "sourceColumn": "Position78",
            "summarizeBy": "none"
          },
          {
            "name": "DateOfIssue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "329dae20-d96b-4fd4-8a8c-769be76bd00b",
            "sourceColumn": "DateOfIssue",
            "summarizeBy": "none"
          },
          {
            "name": "TermInYears",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d1966385-a50c-41fd-a31f-1154fc050fb0",
            "sourceColumn": "TermInYears",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy12Detail",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "9afacefd-58ae-4856-a80f-59ed35b36a4b",
            "sourceColumn": "Levy12Detail",
            "summarizeBy": "none"
          },
          {
            "name": "GrossRevenue12Detail",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7ed0e0ea-fb33-444e-8f3b-2ae2a589c3e8",
            "sourceColumn": "GrossRevenue12Detail",
            "summarizeBy": "none"
          },
          {
            "name": "Levy56Detail",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "bd8642d6-5060-4194-8ecb-60cc8c27d08d",
            "sourceColumn": "Levy56Detail",
            "summarizeBy": "none"
          },
          {
            "name": "GrossRevenue78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "dc365856-913f-46f6-8dbc-9e4f34141f0b",
            "sourceColumn": "GrossRevenue78",
            "summarizeBy": "sum"
          },
          {
            "name": "StateReportTabSectionSortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "2d422df4-ed2e-4a7b-9111-363dd5e0314e",
            "sourceColumn": "StateReportTabSectionSortOrder",
            "summarizeBy": "sum"
          },
          {
            "name": "GROSSASSESSED1Only",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "DataType"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "7d423072-000a-4001-8d4b-618071530da0",
            "sourceColumn": "GROSSASSESSED1Only",
            "summarizeBy": "sum"
          },
          {
            "name": "PositionRowGroupForTotals",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "589a26d0-7c0f-4ed3-bf8e-aeb824efe58c",
            "sourceColumn": "PositionRowGroupForTotals",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "2b1e6950-1b5c-42b1-b298-17a43691225c",
        "partitions": [
          {
            "name": "Title 32 (3)",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database, [Query=\"with TAXAUTHORITYDETAIL as (#(lf)#(tab)select  #(lf)#(tab)#(tab) authoritydetail.TaxYear#(lf)#(tab)#(tab),TaxingEntity = authority.authorityname #(lf)#(tab)#(tab),TaxAuthority = authority.TaxAuthority#(lf)#(tab)#(tab),AuthorityType = authority.AUTHORITYTYPE#(lf)#(lf)#(tab)#(tab)from#(tab)encompass.tlkptaxauthority#(tab)#(tab)#(tab)authority#(lf)#(tab)#(tab)join#(tab)encompass.TLKPTAXAUTHORITYDETAIL#(tab)authoritydetail on authoritydetail.TAXAUTHORITY = authority.TAXAUTHORITY #(lf)#(tab)#(tab)--join#(tab)millap.TAXAUTHORITYINFO mauthorityinfo on mauthorityinfo.TAXAUTHORITY = authority.TAXAUTHORITY#(lf)#(tab)#(tab)where authority.TAXAUTHORITY is not null#(lf)#(tab)#(tab)#(tab)and authoritydetail.ACTIVEFLAG = 1#(lf)#(tab)#(tab)#(tab)--and mauthorityinfo.StateReportTab = 'NON 32'#(lf)#(tab)#(tab)#(tab)--and authoritydetail.TAXYEAR = 2023#(lf)#(lf)), fundbyyear as (#(lf)#(tab)select --distinct #(lf)#(tab)#(tab) fundyear.TaxYear#(lf)#(tab)#(tab),fundyear.FundYearId#(lf)#(tab)#(tab),Levy = case when fundtype.FundType = 'TEMP TAX CREDIT' then (fundyear.Levy * -1) else fundyear.Levy end#(lf)#(tab)#(tab),GrossRevenue = case when fundtype.FundType = 'TEMP TAX CREDIT' then (fundyear.GrossRevenue * -1) else fundyear.GrossRevenue end#(lf)#(lf)#(tab)#(tab),fund.FundID#(lf)#(tab)#(tab),fund.TaxAuthority#(lf)#(tab)#(tab),fund.Name#(lf)#(tab)#(tab),fund.DateOfIssue#(tab)#(lf)#(tab)#(tab),fund.MaturityDate#(lf)#(tab)#(tab),TermInYears = DateDiff(year, fund.DateOfIssue, fund.MaturityDate)#(lf)#(tab)#(tab),fund.Is_Active#(lf)#(tab)#(tab),fund.Is_Certified#(lf)#(lf)#(tab)#(tab),fund.FundTypeIndex#(lf)#(tab)#(tab),fundtype.FundType#(lf)#(lf)#(tab)--select * #(lf)#(tab)from #(lf)#(tab)#(tab)millap.fundyear#(tab)#(tab)#(tab)#(tab)fundyear #(lf)#(tab)#(tab)join millap.fund#(tab)#(tab)#(tab)fund on fundyear.FundID = fund.FundID#(lf)#(tab)#(tab)join millap.fundtype#(tab)#(tab)fundtype on fund.FundTypeIndex = fundtype.[Index]#(lf)#(tab)--where fundyear.TaxYear = 2023#(lf)#(lf)), certified as (#(lf)#(tab)select#(lf)#(tab)#(tab)CertID#(lf)#(tab)#(tab),TaxAuthority#(lf)#(tab)#(tab),TaxYear#(lf)#(tab)#(tab),Certified = case when (Certified = 'true' or Certified = '5') then 'true' else 'false' end#(lf)#(tab)#(tab),GROSSASSESSED = convert(decimal(18,0), GROSSASSESSED)#(lf)#(tab)#(tab),TotalLevy#(lf)#(tab)#(tab),TotalGrossRevenue#(lf)#(tab)from millap.cert#(lf)#(tab)where 1=1#(lf)#(tab)#(tab)and (Certified = 'true' or Certified = '5')#(lf)#(tab)#(tab)--and TaxYear = 2023#(lf))#(lf)select#(tab)#(lf)#(tab)ta.TaxYear#(lf)#(tab),ta.TaxAuthority#(lf)#(tab),ta.TaxingEntity#(lf)#(tab),ta.AUTHORITYTYPE#(lf)#(tab),c.Certified#(lf)#(tab),c.GROSSASSESSED#(lf)#(tab)--numbers#(lf)#(tab),fy.Levy #(lf)#(tab),fy.GrossRevenue #(lf)#(tab),TotalLevyByTaxAuthority = (select sum(fby.Levy) from fundbyyear fby where fby.TaxAuthority = ta.TaxAuthority and fby.TaxYear = ta.TAXYEAR group by fby.TaxAuthority,fby.TaxYear)#(lf)#(tab)--,c.TotalLevy#(lf)#(tab),TotalGrossRevenuByTaxAuthority = (select sum(fby.GrossRevenue) from fundbyyear fby where fby.TaxAuthority = ta.TaxAuthority and fby.TaxYear = ta.TAXYEAR group by fby.TaxAuthority,fby.TaxYear)#(lf)#(tab)--,c.TotalGrossRevenue#(lf)#(tab),fy.DateOfIssue#(tab)#(lf)#(tab),fy.MaturityDate#(lf)#(tab),fy.TermInYears#(lf)#(tab),FundYear_Is_Certified = fy.Is_Certified#(lf)#(tab)--used to map positions#(lf)#(tab),fy.FundTypeIndex#(lf)#(tab),fy.FundType#(lf)#(tab),rownum = ROW_NUMBER() over(partition by ta.taxyear,ta.TaxAuthority, fy.FundTypeIndex order by fy.FundTypeIndex, isnull(fy.Levy, 999999)) #(lf)from TAXAUTHORITYDETAIL ta#(lf)#(tab)join certified c on ta.TaxAuthority = c.TaxAuthority and ta.TAXYEAR = c.TaxYear#(lf)#(tab)join fundbyyear fy on ta.TaxAuthority = fy.TaxAuthority and ta.TAXYEAR = fy.TaxYear#(lf)--where ta.TAXYEAR = @taxyear#(lf)order by 1, 2#(lf)\", CreateNavigationProperties=false]),",
                "    #\"Filtered Year\" = Table.SelectRows(Source, each [TaxYear] = TaxYear_Param or [TaxYear] = TaxYear_Param_LY),",
                "    #\"Trimmed Text\" = Table.TransformColumns(#\"Filtered Year\",{{\"TaxAuthority\", Text.Trim, type text}}),",
                "    #\"Merged Tax Authority Info\" = Table.NestedJoin(#\"Trimmed Text\", {\"TaxAuthority\"}, #\"Tax Authority Info\", {\"TaxAuthority\"}, \"Tax Authority Info\", JoinKind.Inner),",
                "    #\"Expanded Tax Authority Info\" = Table.ExpandTableColumn(#\"Merged Tax Authority Info\", \"Tax Authority Info\", {\"StateReportName\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\"}, {\"StateReportName\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\"}),",
                "    #\"Filtered TITLE 32\" = Table.SelectRows(#\"Expanded Tax Authority Info\", each ([StateReportName] = \"TITLE 32\")),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Filtered TITLE 32\",{{\"TaxYear\", Int64.Type}, {\"Certified\", type logical}, {\"GROSSASSESSED\", Int64.Type}, {\"GrossRevenue\", Int64.Type}, {\"TotalGrossRevenuByTaxAuthority\", Int64.Type}}),",
                "    #\"Added Conditional Column\" = Table.AddColumn(#\"Changed Type\", \"Custom\", each if [Certified] = true then [TaxingEntity] else [TaxingEntity] & \" (DID NOT CERTIFY)\"),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"Custom\", \"AUTHORITYTYPE\", \"Certified\", \"GROSSASSESSED\", \"Levy\", \"GrossRevenue\", \"TotalLevyByTaxAuthority\", \"TotalGrossRevenuByTaxAuthority\", \"DateOfIssue\", \"MaturityDate\", \"TermInYears\", \"FundYear_Is_Certified\", \"FundTypeIndex\", \"FundType\"}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Reordered Columns\",{\"TaxingEntity\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Custom\", \"TaxingEntity\"}}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Renamed Columns\", {\"FundTypeIndex\"}, FundType_Position, {\"Index\"}, \"FundType_Position\", JoinKind.LeftOuter),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged Queries\", \"FundType_Position\", {\"Position_NON_32\"}, {\"Position\"}),",
                "    #\"Added PositionRowGroup\" = Table.AddColumn(#\"Expanded FundType_Position\", \"PositionRowGroup\", each if [Position] = 4",
                "then 3",
                "else if Number.Mod([Position],2) = 0",
                "     then 2 ",
                "     else Number.Mod([Position],2)),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Added PositionRowGroup\",{{\"Position\", Int64.Type}, {\"PositionRowGroup\", Int64.Type}}),",
                "    #\"Replaced DateOfIssue\" = Table.ReplaceValue(#\"Changed Type1\",\"1900-01-01\",null,Replacer.ReplaceValue,{\"DateOfIssue\"}),",
                "    #\"Replaced MaturityDate\" = Table.ReplaceValue(#\"Replaced DateOfIssue\",\"1900-01-01\",null,Replacer.ReplaceValue,{\"MaturityDate\"}),",
                "    #\"Replaced TermInYears\" = Table.ReplaceValue(#\"Replaced MaturityDate\",0,null,Replacer.ReplaceValue,{\"TermInYears\"}),",
                "    #\"Added Levy12\" = Table.AddColumn(#\"Replaced TermInYears\", \"Levy12\", each if [Position] = 1 or [Position] = 2 ",
                "then [Levy] ",
                "else null),",
                "    #\"Added GrossRevenue12\" = Table.AddColumn(#\"Added Levy12\", \"GrossRevenue12\", each if [Position] = 1 or [Position] = 2 ",
                "then [GrossRevenue] ",
                "else null),",
                "    #\"Added Levy34\" = Table.AddColumn(#\"Added GrossRevenue12\", \"Levy34\", each if [Position] = 3 or [Position] = 4 then [Levy] else null),",
                "    #\"Added GrossRevenue34\" = Table.AddColumn(#\"Added Levy34\", \"GrossRevenue34\", each if [Position] = 3 or [Position] = 4 then [GrossRevenue] else null),",
                "    #\"Added Levy56\" = Table.AddColumn(#\"Added GrossRevenue34\", \"Levy56\", each if [Position] = 5 or [Position] = 6 ",
                "then [Levy] ",
                "else null),",
                "    #\"Added GrossRevenue56\" = Table.AddColumn(#\"Added Levy56\", \"GrossRevenue56\", each if [Position] = 5 or [Position] = 6 then [GrossRevenue] else null),",
                "    #\"Added Levy78\" = Table.AddColumn(#\"Added GrossRevenue56\", \"Levy78\", each if [Position] = 7 or [Position] = 8 then [Levy] else null),",
                "    #\"Added GrossRevenue78\" = Table.AddColumn(#\"Added Levy78\", \"GrossRevenue78\", each if [Position] = 7 or [Position] = 8 then [GrossRevenue] else null),",
                "    #\"Grouped Rows\" = Table.Group(#\"Added GrossRevenue78\", {\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\", \"PositionRowGroup\", \"rownum\", \"Certified\", \"DateOfIssue\", \"TermInYears\"}, {{\"GROSSASSESSED\", each List.Max([GROSSASSESSED]), type nullable number}, {\"TotalLevy\", each List.Max([TotalLevyByTaxAuthority]), type nullable number}, {\"TotalGrossRevenue\", each List.Max([TotalGrossRevenuByTaxAuthority]), type nullable number}, {\"Levy12\", each List.Sum([Levy12]), type nullable number}, {\"GrossRevenue12\", each List.Sum([GrossRevenue12]), type nullable number}, {\"Levy34\", each List.Sum([Levy34]), type nullable number}, {\"GrossRevenue34\", each List.Sum([GrossRevenue34]), type nullable number}, {\"Levy56\", each List.Sum([Levy56]), type nullable number}, {\"GrossRevenue56\", each List.Sum([GrossRevenue56]), type nullable number}, {\"Levy78\", each List.Sum([Levy78]), type nullable number}, {\"GrossRevenue78\", each List.Sum([GrossRevenue78]), type nullable number}}),",
                "    #\"Added Position12\" = Table.AddColumn(#\"Grouped Rows\", \"Position12\", each if [Levy12] <> null then ",
                "   if [PositionRowGroup] = 1 ",
                "   then \"(1)\" else \"(2)\" ",
                "else null),",
                "    #\"Added Position34\" = Table.AddColumn(#\"Added Position12\", \"Position34\", each if [Levy34] <> null then ",
                "   if [PositionRowGroup] = 1 ",
                "   then \"(3)\" else \"(4)\" ",
                "else null),",
                "    #\"Added Position56\" = Table.AddColumn(#\"Added Position34\", \"Position56\", each if [Levy56] <> null then ",
                "   if [PositionRowGroup] = 1 ",
                "   then \"(5)\" else \"(6)\" ",
                "else null),",
                "    #\"Added Position78\" = Table.AddColumn(#\"Added Position56\", \"Position78\", each if [Levy78] <> null then ",
                "   if [PositionRowGroup] = 1 ",
                "   then \"(7)\" else \"(8)\" ",
                "else null),",
                "    #\"Added Levy12Detail\" = Table.AddColumn(#\"Added Position78\", \"Levy12Detail\", each if [PositionRowGroup] = 3",
                "then \"Bond Date: \" ",
                "else ",
                "if [Levy12] <> null",
                "then if [Levy12] >= 0 then Number.ToText([Levy12],\"F3\",\"\") else \"(\" & Number.ToText(Number.Abs([Levy12]),\"F3\",\"\") & \")\"",
                "else null),",
                "    #\"Added GrossRevenue12Detail\" = Table.AddColumn(#\"Added Levy12Detail\", \"GrossRevenue12Detail\", each ",
                "if [PositionRowGroup] = 3 ",
                "then [DateOfIssue] ",
                "else if [GrossRevenue12] = null",
                "     then null",
                "     else if [GrossRevenue12] >= 0 ",
                "          then \"$\" & Number.ToText([GrossRevenue12], \"N0\", \"\")",
                "          else \"$(\" & Number.ToText(Number.Abs([GrossRevenue12]), \"N0\", \"\") & \")\"",
                "          ),",
                "    #\"Added Levy56Detail\" = Table.AddColumn(#\"Added GrossRevenue12Detail\", \"Levy56Detail\", each ",
                "if [PositionRowGroup] = 3",
                "then \"term in years: \" & Number.ToText([TermInYears])",
                "else if [Levy56] <> null",
                "     then if [Levy56] >= 0 ",
                "          then Number.ToText([Levy56],\"F3\",\"\") ",
                "          else \"(\" & Number.ToText(Number.Abs([Levy56]),\"F3\",\"\") & \")\"",
                "     else null),",
                "    #\"Added GROSSASSESSED1Only\" = Table.AddColumn(#\"Added Levy56Detail\", \"GROSSASSESSED1Only\", each if [PositionRowGroup] = 1 then [GROSSASSESSED] else null),",
                "    #\"Added PositionRowGroupForTotals\" = Table.AddColumn(#\"Added GROSSASSESSED1Only\", \"PositionRowGroupForTotals\", each if [PositionRowGroup] = 3 then 2 else [PositionRowGroup])",
                "in",
                "    #\"Added PositionRowGroupForTotals\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Realware GRASSASSESSED",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "int64",
            "lineageTag": "394778d1-18b6-4356-be71-76d492093edf",
            "sourceColumn": "TaxYear",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "194985b7-601b-4234-921e-9db6d933c6c0",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "5209e971-f7d0-460e-97cc-f596a77003e7",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "none"
          },
          {
            "name": "AuthorityEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "'Realware GRASSASSESSED'[TaxAuthority] & \": \" & 'Realware GRASSASSESSED'[TaxingEntity]",
            "isDataTypeInferred": true,
            "lineageTag": "b90a4697-0364-4d88-b2d7-2adece37b18d",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "63b93f23-701f-42d1-a1d1-48d30e687abe",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "548483d4-58a1-403d-8efb-fc1a94917fa3",
        "partitions": [
          {
            "name": "Realware GRASSASSESSED",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database),",
                "    ENCOMPASS_TLKPTAXAUTHORITY = Source{[Schema=\"ENCOMPASS\",Item=\"TLKPTAXAUTHORITY\"]}[Data],",
                "    Q = Value.NativeQuery(Source, \"",
                "        select  ",
                "            authoritydetail.TaxYear",
                "            ,TaxingEntity = authority.authorityname ",
                "            ,TaxAuthority = authority.TaxAuthority",
                "            ,AuthorityType = authority.AUTHORITYTYPE",
                "            , ActiveFlag = authoritydetail.ACTIVEFLAG",
                "            from\tencompass.tlkptaxauthority\t\t\tauthority",
                "            join\tencompass.TLKPTAXAUTHORITYDETAIL\tauthoritydetail on authoritydetail.TAXAUTHORITY = authority.TAXAUTHORITY ",
                "            where authority.TAXAUTHORITY is not null",
                "                and authoritydetail.ACTIVEFLAG = 1\"",
                "    , null, [EnableFolding = true]),",
                "    #\"Filtered Year\" = Table.SelectRows(Q, each [TaxYear] = TaxYear_Param or [TaxYear] = TaxYear_Param_LY),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Filtered Year\",{{\"TaxYear\", Int64.Type}}),",
                "    #\"Trimmed Text\" = Table.TransformColumns(#\"Changed Type1\",{{\"TaxAuthority\", Text.Trim, type text}}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Trimmed Text\", {\"TaxYear\", \"TaxAuthority\"}, #\"ENCOMPASS TLKPTAXAUTHORITYDETAIL\", {\"TAXYEAR\", \"TAXAUTHORITY\"}, \"ENCOMPASS TLKPTAXAUTHORITYDETAIL\", JoinKind.LeftOuter),",
                "    #\"Expanded ENCOMPASS TLKPTAXAUTHORITYDETAIL\" = Table.ExpandTableColumn(#\"Merged Queries\", \"ENCOMPASS TLKPTAXAUTHORITYDETAIL\", {\"Assessor_GROSSASSESSED\"}, {\"GROSSASSESSED\"}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Expanded ENCOMPASS TLKPTAXAUTHORITYDETAIL\",{\"AuthorityType\", \"ActiveFlag\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "ENCOMPASS TLKPTAXAUTHORITYDETAIL",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TAXAUTHORITY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "47ea905b-1525-4ba6-b421-f7fb29858dc4",
            "sourceColumn": "TAXAUTHORITY",
            "summarizeBy": "none"
          },
          {
            "name": "TAXYEAR",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "changedProperties": [
              {
                "property": "DataType"
              }
            ],
            "dataType": "int64",
            "lineageTag": "bcd15f84-437b-45af-ae5b-2f62d5af92c5",
            "sourceColumn": "TAXYEAR",
            "summarizeBy": "none"
          },
          {
            "name": "Assessor_GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "dataType": "double",
            "formatString": "0",
            "lineageTag": "fc436d22-03fc-4082-8745-9bec43df7f04",
            "sourceColumn": "Assessor_GROSSASSESSED",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "b3816e4d-d4e3-4c43-9267-eebf43b63073",
        "partitions": [
          {
            "name": "ENCOMPASS TLKPTAXAUTHORITYDETAIL",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database),",
                "    ENCOMPASS_TLKPTAXAUTHORITYDETAIL = Source{[Schema=\"ENCOMPASS\",Item=\"TLKPTAXAUTHORITYDETAIL\"]}[Data],",
                "    #\"Filtered Rows\" = Table.SelectRows(ENCOMPASS_TLKPTAXAUTHORITYDETAIL, each ([TAXYEAR] = TaxYear_Param or [TAXYEAR] = TaxYear_Param_LY)),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Filtered Rows\",{\"TIFDISTRICTINCREMENT\", \"NEWCONSTRUCTION\", \"PRODUCINGMINEINCREMENT\", \"ANNEXINCLUSIONS\", \"PREVIOUSEXEMPTFEDERAL\", \"NEWPRIMARYOIL\", \"TAXOMITTEDPROPERTY\", \"TAXESABATEDREFUNDED\", \"REALACTUALVALUE\", \"REALNEWCONSTACTUALVALUE\", \"NEWANNEXACTUALVALUE\", \"PRODUCINGMINEACTUALVALUE\", \"PREVIOUSEXEMPTACTUALVALUE\", \"NEWWELLPRODUCINGACTUALVALUE\", \"REALOMITTEDACTUALVALUE\", \"REALDESTROYEDACTUALVALUE\", \"DISCONNECTEXCLACTUALVALUE\", \"PREVIOUSTAXACTUALVALUE\", \"GROSSACTUALVALUE\", \"ACTIVEFLAG\", \"SORTORDER\", \"JURISDICTIONID\", \"MAXASSESSEDMILLLEVY\", \"LASTUPDATED\", \"NEWPRIMARYOILASSESSED\", \"TAXAUTHORITYNOTE\", \"TAXAUTHORITYTERM\", \"BONDCONTRACTDATE\", \"ENCOMPASS.TLKPTAXAUTHORITY\", \"ENCOMPASS.TMAPTAXAUTHORITYDETAILFUND\", \"ENCOMPASS.TSGNURPLANAUTHORITYVALUE\", \"NETASSESSED\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"GROSSASSESSED\", \"Assessor_GROSSASSESSED\"}})",
                "in",
                "    #\"Renamed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "County (2)",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "a480f343-e679-4bb5-b22c-5d47261c1b38",
            "sourceColumn": "TaxYear",
            "summarizeBy": "sum"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "76a6c176-553b-4e0b-956f-7436d2328dd5",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f04af3c1-03ce-418d-acac-6e5ff5f5f687",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "809efd23-fdc2-4a2e-94f4-74ab21cc2686",
            "sourceColumn": "StateReportName",
            "summarizeBy": "none"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "8e83000a-c7a4-486a-a5e8-74f118667095",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "a3ab92c3-c023-463a-9d81-d863fb10a6b0",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "a88e4112-3c41-4bdc-af86-7de99ea079bb",
            "sourceColumn": "Levy",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "2fe034f6-9481-4073-9201-37ebfb126208",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b4fe3ebe-a293-4e34-957e-f1ee52fc2da1",
            "sourceColumn": "GrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "d0b8c688-1f54-4651-97f9-ef67dfcb7a57",
            "sourceColumn": "TotalGrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevyByTaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "bcec1241-57bf-47d0-b83a-830a9a11926c",
            "sourceColumn": "TotalLevyByTaxAuthority",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalGrossRevenuByTaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4db7eb75-ffec-424c-8bd8-dff2c9358447",
            "sourceColumn": "TotalGrossRevenuByTaxAuthority",
            "summarizeBy": "sum"
          },
          {
            "name": "DateOfIssue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "42e654e3-174b-4094-9bab-ad566cd39503",
            "sourceColumn": "DateOfIssue",
            "summarizeBy": "none"
          },
          {
            "name": "MaturityDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "fae0cdc0-8523-4e5b-b826-f11b9dc45a36",
            "sourceColumn": "MaturityDate",
            "summarizeBy": "none"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ee1caa31-a6fa-4f85-9a8a-6dd772492fbd",
            "sourceColumn": "rownum",
            "summarizeBy": "sum"
          },
          {
            "name": "TermInYears",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "f55fad69-6453-46aa-80d5-3b47472400b3",
            "sourceColumn": "TermInYears",
            "summarizeBy": "sum"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "2f2703b3-9385-4085-991b-619e4b158dfc",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSectionSortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "3c43bdb8-1dab-48ba-9b0c-546612bf3b80",
            "sourceColumn": "StateReportTabSectionSortOrder",
            "summarizeBy": "sum"
          },
          {
            "name": "FundType",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4bc5085b-8f8a-4178-9df9-935ecb122902",
            "sourceColumn": "FundType",
            "summarizeBy": "none"
          },
          {
            "name": "Position",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e2509e67-2f6b-4594-8f33-7f57fb85d87c",
            "sourceColumn": "Position",
            "summarizeBy": "sum"
          },
          {
            "name": "CountyCode",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e43449ca-54c5-40cb-895c-875ba149fdd3",
            "sourceColumn": "CountyCode",
            "summarizeBy": "count"
          },
          {
            "name": "FundTypeName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ef39b26f-d057-46f1-a596-91a25f9e49e4",
            "sourceColumn": "FundTypeName",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e8feabf4-ebfe-41bd-af21-8b520cb1e294",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "b67d965e-5f8c-46cc-b795-6fb3a278682e",
        "partitions": [
          {
            "name": "County (2)",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(azure_server, azure_database, [Query=\"with TAXAUTHORITYDETAIL as (#(lf)#(tab)select  #(lf)#(tab)#(tab) TaxYear = authoritydetail.BudgetYear#(lf)#(tab)#(tab),TaxDistrictID = authority.[TaxDistrictID]#(lf)#(tab)#(tab),TaxingEntity = authority.[Name] #(lf)#(tab)#(tab),TaxAuthority = authority.CountyTaxEntityCode#(lf)#(tab)#(tab),GROSSASSESSED = authoritydetail.[GrossAssessedValue]#(lf)#(tab)#(tab)from#(tab)#(tab)[dbo].[TaxDistrict]#(tab)#(tab)#(tab)#(tab)#(tab)authority#(lf)#(tab)#(tab)join#(tab)#(tab)[dbo].[TaxDistrictYear]#(tab)#(tab)#(tab)#(tab)authoritydetail on authority.TaxDistrictId = authoritydetail.TaxDistrictId#(lf)#(tab)#(tab)where authoritydetail.IsActive = 1#(lf)),#(lf)fundbyyear as (#(lf)#(tab)select #(lf)#(tab)#(tab) TaxYear = fundyear.BudgetYear#(lf)#(tab)#(tab),fundyear.FundYearId#(lf)#(lf)#(tab)#(tab),fund.FundID#(lf)#(tab)#(tab),fund.TaxDistrictID#(lf)#(tab)#(tab),FundType = fundtype.[Name]#(lf)#(tab)#(tab),fund.IsActive#(lf)#(lf)#(tab)#(tab),fund.DateOfIssue#(tab)#(lf)#(tab)#(tab),fund.MaturityDate#(lf)#(tab)#(tab),TermInYears = DateDiff(year, fund.MaturityDate, fund.DateOfIssue)#(lf)#(tab)#(tab),Levy = case when fundtype.[Name] = 'TEMP TAX CREDIT' then (fundyear.MillLevy * -1) else fundyear.MillLevy end#(lf)#(tab)#(tab),GrossRevenue = case when fundtype.[Name] = 'TEMP TAX CREDIT' then (fundyear.GrossRevenue * -1) else fundyear.GrossRevenue end#(lf)#(tab)from #(lf)#(tab)#(tab)dbo.FundYear#(tab)#(tab)fundyear #(lf)#(tab)#(tab)join dbo.Fund#(tab)#(tab)fund on fundyear.FundID = fund.FundID#(lf)#(tab)#(tab)join dbo.FundType#(tab)fundtype on fund.FundTypeID = fundtype.FundTypeID#(lf)#(lf)), certified as (#(lf)#(tab)select#(lf)#(tab)#(tab)CertificationID#(lf)#(tab)#(tab),TaxDistrictID#(lf)#(tab)#(tab),TaxYear = BudgetYear#(lf)#(tab)#(tab),Certified = case when (CertificationStatusID = 5) then 'true' else 'false' end#(lf)#(lf)#(tab)#(tab),TotalLevy#(lf)#(tab)#(tab),TotalGrossRevenue#(lf)#(tab)from [dbo].[Certification]#(lf)#(tab)where 1=1#(lf)#(tab)#(tab)and (CertificationStatusID = 5)#(lf))#(lf)select#(tab)#(lf)#(tab)c.TaxYear#(lf)#(tab),ta.TaxAuthority#(lf)#(tab),ta.TaxingEntity#(lf)#(tab),c.Certified#(lf)#(tab)--numbers and dates#(lf)#(tab),ta.GROSSASSESSED#(lf)#(tab),fy.Levy #(lf)#(tab),fy.GrossRevenue #(lf)#(tab),TotalLevyByTaxAuthority = (select sum(fby.Levy) from fundbyyear fby where fby.TaxDistrictID = ta.TaxDistrictID and fby.TaxYear = ta.TaxYear group by fby.TaxDistrictID,fby.TaxYear)#(lf)#(tab),c.TotalLevy#(lf)#(tab),TotalGrossRevenuByTaxAuthority = (select sum(fby.GrossRevenue) from fundbyyear fby where fby.TaxDistrictID = ta.TaxDistrictID and fby.TaxYear = ta.TaxYear group by fby.TaxDistrictID,fby.TaxYear)#(lf)#(tab),c.TotalGrossRevenue#(lf)#(tab),fy.DateOfIssue#(tab)#(lf)#(tab),fy.MaturityDate#(lf)#(tab),fy.TermInYears#(lf)--#(tab)--used to map positions#(lf)#(tab),fy.FundType#(lf)#(tab),rownum = ROW_NUMBER() over(partition by ta.TaxYear,ta.TaxDistrictID, fy.FundType order by fy.FundType, isnull(fy.Levy, 999999)) #(lf)--select *#(lf)from TAXAUTHORITYDETAIL ta#(lf)#(tab)join certified c on ta.TaxDistrictID = c.TaxDistrictID and ta.TaxYear = c.TaxYear#(lf)#(tab)join fundbyyear fy on ta.TaxDistrictID = fy.TaxDistrictID and ta.TAXYEAR = fy.TaxYear#(lf)\", CreateNavigationProperties=false]),",
                "    #\"Filtered Year\" = Table.SelectRows(Source, each [TaxYear] = TaxYear_Param or [TaxYear] = TaxYear_Param_LY),",
                "    #\"Merged Queries1\" = Table.NestedJoin(#\"Filtered Year\", {\"TaxAuthority\"}, #\"Tax Authority Info\", {\"TaxAuthority\"}, \"Tax Authority Info\", JoinKind.Inner),",
                "    #\"Expanded Tax Authority Info\" = Table.ExpandTableColumn(#\"Merged Queries1\", \"Tax Authority Info\", {\"StateReportName\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\"}, {\"StateReportName\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\"}),",
                "    #\"Filtered Rows\" = Table.SelectRows(#\"Expanded Tax Authority Info\", each ([StateReportName] = \"County\")),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Filtered Rows\",{{\"TaxYear\", Int64.Type}, {\"Certified\", type logical}, {\"GROSSASSESSED\", Int64.Type}, {\"GrossRevenue\", Int64.Type}, {\"TotalGrossRevenuByTaxAuthority\", Int64.Type}}),",
                "    #\"Added Conditional Column\" = Table.AddColumn(#\"Changed Type\", \"Custom\", each if [Certified] = true then [TaxingEntity] else [TaxingEntity] & \" (DID NOT CERTIFY)\"),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"Custom\", \"StateReportName\", \"Certified\", \"GROSSASSESSED\", \"Levy\", \"GrossRevenue\", \"TotalLevyByTaxAuthority\", \"TotalGrossRevenuByTaxAuthority\", \"DateOfIssue\", \"MaturityDate\", \"TermInYears\", \"FundType\"}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Reordered Columns\",{\"TaxingEntity\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Custom\", \"TaxingEntity\"}}),",
                "    #\"Merged FundType_Position\" = Table.NestedJoin(#\"Renamed Columns\", {\"FundType\"}, FundType_Position, {\"Name\"}, \"FundType_Position\", JoinKind.FullOuter),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged FundType_Position\", \"FundType_Position\", {\"Position_County\",\"CountyCode\",\"Name\"}, {\"Position\",\"CountyCode\", \"FundTypeName\"}),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Expanded FundType_Position\", \"PositionRowGroup\", each if Number.Mod([Position],2) = 0",
                "then 2 ",
                "else Number.Mod([Position],2)),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Added Custom\",{{\"Position\", Int64.Type}, {\"PositionRowGroup\", Int64.Type}}),",
                "    #\"Replaced Value\" = Table.ReplaceValue(#\"Changed Type1\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"DateOfIssue\"}),",
                "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Replaced Value\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"MaturityDate\"}),",
                "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",0,null,Replacer.ReplaceValue,{\"TermInYears\"}),",
                "    #\"Replaced Value3\" = Table.ReplaceValue(#\"Replaced Value2\",null,TaxYear_Param,Replacer.ReplaceValue,{\"TaxYear\"}),",
                "    #\"Replaced Value4\" = Table.ReplaceValue(#\"Replaced Value3\",null,\"0001\",Replacer.ReplaceValue,{\"TaxAuthority\"}),",
                "    #\"Replaced Value5\" = Table.ReplaceValue(#\"Replaced Value4\",null,\"Douglas County Government\",Replacer.ReplaceValue,{\"TaxingEntity\"}),",
                "    #\"Replaced Value6\" = Table.ReplaceValue(#\"Replaced Value5\",null,\"County\",Replacer.ReplaceValue,{\"StateReportName\"})",
                "in",
                "    #\"Replaced Value6\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Non Title 32 (2)",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "9286ebf5-1d5b-4f4f-a0dc-d0d30f5b46da",
            "sourceColumn": "TaxYear",
            "summarizeBy": "sum"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d13c7b49-1ba1-4aa7-a150-e9b3350b753a",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "140656e5-65a7-4faf-b032-d0456c109782",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "6a804e63-9167-4a4b-973c-5b27e34132b8",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "sum"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "49a5012b-f385-45ad-92ef-625d8639dbc6",
            "sourceColumn": "rownum",
            "summarizeBy": "sum"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "db42a2b0-a49e-487d-8100-a78c978c0059",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b2c46e35-c549-429c-985f-d537173ec0c9",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "d7c5e6d1-0361-4a34-998f-b147887a8415",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "e0599e6b-6606-42b4-868c-bce0031073f6",
            "sourceColumn": "Levy12",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "0207f8fa-8611-422d-bf68-41d954784443",
            "sourceColumn": "GrossRevenue12",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "4fdd40f3-6955-442f-8113-07c43b8498ce",
            "sourceColumn": "Levy34",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "a6f16fe7-f79d-4fd4-a2ee-13dfc6874d1a",
            "sourceColumn": "GrossRevenue34",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "c09637af-f0c9-490e-a6d5-a95e23f6bf02",
            "sourceColumn": "Levy56",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "b485fcff-9c94-4a50-bbfd-61f6e4584ce4",
            "sourceColumn": "GrossRevenue56",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "eb1867fa-4f39-40e2-9a16-5e345f3d63d3",
            "sourceColumn": "Levy78",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "0749929f-6178-423a-bded-7a5007c25113",
            "sourceColumn": "GrossRevenue78",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "41593c1a-ddb9-4a1b-91b4-d8d2d612feeb",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "8987e2cd-d9d9-4e6a-8f76-03013bd3e0c3",
            "sourceColumn": "TotalGrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "Position12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f11e5b55-1daf-4a7e-9564-1afdaa762657",
            "sourceColumn": "Position12",
            "summarizeBy": "none"
          },
          {
            "name": "Position34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "42692601-5d1d-4b4f-96d9-ba1838b859d2",
            "sourceColumn": "Position34",
            "summarizeBy": "none"
          },
          {
            "name": "Position56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6347d985-7e09-44e0-804d-9a3228e6025d",
            "sourceColumn": "Position56",
            "summarizeBy": "none"
          },
          {
            "name": "Position78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ca2015a7-f300-4ae3-b174-5852f7af960e",
            "sourceColumn": "Position78",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "07d8ff0f-907e-45a5-af91-0c4918bd28ce",
        "partitions": [
          {
            "name": "Non Title 32 (2)",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(azure_server, azure_database, [Query=\"with TAXAUTHORITYDETAIL as (#(lf)#(tab)select  #(lf)#(tab)#(tab) TaxYear = authoritydetail.BudgetYear#(lf)#(tab)#(tab),TaxDistrictID = authority.[TaxDistrictID]#(lf)#(tab)#(tab),TaxingEntity = authority.[Name] #(lf)#(tab)#(tab),TaxAuthority = authority.CountyTaxEntityCode#(lf)#(tab)#(tab),GROSSASSESSED = authoritydetail.[GrossAssessedValue]#(lf)#(tab)#(tab)from#(tab)#(tab)[dbo].[TaxDistrict]#(tab)#(tab)#(tab)#(tab)#(tab)authority#(lf)#(tab)#(tab)join#(tab)#(tab)[dbo].[TaxDistrictYear]#(tab)#(tab)#(tab)#(tab)authoritydetail on authority.TaxDistrictId = authoritydetail.TaxDistrictId#(lf)#(tab)#(tab)where authoritydetail.IsActive = 1#(lf)),#(lf)fundbyyear as (#(lf)#(tab)select #(lf)#(tab)#(tab) TaxYear = fundyear.BudgetYear#(lf)#(tab)#(tab),fundyear.FundYearId#(lf)#(lf)#(tab)#(tab),fund.FundID#(lf)#(tab)#(tab),fund.TaxDistrictID#(lf)#(tab)#(tab),FundType = fundtype.[Name]#(lf)#(tab)#(tab),fund.IsActive#(lf)#(lf)#(tab)#(tab),fund.DateOfIssue#(tab)#(lf)#(tab)#(tab),fund.MaturityDate#(lf)#(tab)#(tab),TermInYears = DateDiff(year, fund.MaturityDate, fund.DateOfIssue)#(lf)#(tab)#(tab),Levy = case when fundtype.[Name] = 'TEMP TAX CREDIT' then (fundyear.MillLevy * -1) else fundyear.MillLevy end#(lf)#(tab)#(tab),GrossRevenue = case when fundtype.[Name] = 'TEMP TAX CREDIT' then (fundyear.GrossRevenue * -1) else fundyear.GrossRevenue end#(lf)#(tab)from #(lf)#(tab)#(tab)dbo.FundYear#(tab)#(tab)fundyear #(lf)#(tab)#(tab)join dbo.Fund#(tab)#(tab)fund on fundyear.FundID = fund.FundID#(lf)#(tab)#(tab)join dbo.FundType#(tab)fundtype on fund.FundTypeID = fundtype.FundTypeID#(lf)#(lf)), certified as (#(lf)#(tab)select#(lf)#(tab)#(tab)CertificationID#(lf)#(tab)#(tab),TaxDistrictID#(lf)#(tab)#(tab),TaxYear = BudgetYear#(lf)#(tab)#(tab),Certified = case when (CertificationStatusID = 5) then 'true' else 'false' end#(lf)#(lf)#(tab)#(tab),TotalLevy#(lf)#(tab)#(tab),TotalGrossRevenue#(lf)#(tab)from [dbo].[Certification]#(lf)#(tab)where 1=1#(lf)#(tab)#(tab)and (CertificationStatusID = 5)#(lf))#(lf)select#(tab)#(lf)#(tab)c.TaxYear#(lf)#(tab),ta.TaxAuthority#(lf)#(tab),ta.TaxingEntity#(lf)#(tab),c.Certified#(lf)#(tab)--numbers and dates#(lf)#(tab),ta.GROSSASSESSED#(lf)#(tab),fy.Levy #(lf)#(tab),fy.GrossRevenue #(lf)#(tab),TotalLevyByTaxAuthority = (select sum(fby.Levy) from fundbyyear fby where fby.TaxDistrictID = ta.TaxDistrictID and fby.TaxYear = ta.TaxYear group by fby.TaxDistrictID,fby.TaxYear)#(lf)#(tab),c.TotalLevy#(lf)#(tab),TotalGrossRevenuByTaxAuthority = (select sum(fby.GrossRevenue) from fundbyyear fby where fby.TaxDistrictID = ta.TaxDistrictID and fby.TaxYear = ta.TaxYear group by fby.TaxDistrictID,fby.TaxYear)#(lf)#(tab),c.TotalGrossRevenue#(lf)#(tab),fy.DateOfIssue#(tab)#(lf)#(tab),fy.MaturityDate#(lf)#(tab),fy.TermInYears#(lf)--#(tab)--used to map positions#(lf)#(tab),fy.FundType#(lf)#(tab),rownum = ROW_NUMBER() over(partition by ta.TaxYear,ta.TaxDistrictID, fy.FundType order by fy.FundType, isnull(fy.Levy, 999999)) #(lf)--select *#(lf)from TAXAUTHORITYDETAIL ta#(lf)#(tab)join certified c on ta.TaxDistrictID = c.TaxDistrictID and ta.TaxYear = c.TaxYear#(lf)#(tab)join fundbyyear fy on ta.TaxDistrictID = fy.TaxDistrictID and ta.TAXYEAR = fy.TaxYear#(lf)\", CreateNavigationProperties=false]),",
                "    #\"Filtered Year\" = Table.SelectRows(Source, each [TaxYear] = TaxYear_Param or [TaxYear] = TaxYear_Param_LY),",
                "    #\"Merged Queries1\" = Table.NestedJoin(#\"Filtered Year\", {\"TaxAuthority\"}, #\"Tax Authority Info\", {\"TaxAuthority\"}, \"Tax Authority Info\", JoinKind.Inner),",
                "    #\"Expanded Tax Authority Info\" = Table.ExpandTableColumn(#\"Merged Queries1\", \"Tax Authority Info\", {\"StateReportName\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\"}, {\"StateReportName\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\"}),",
                "    #\"Filtered Rows\" = Table.SelectRows(#\"Expanded Tax Authority Info\", each ([StateReportName] = \"TITLE 32\")),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Filtered Rows\",{{\"Certified\", type logical}, {\"GROSSASSESSED\", Int64.Type}, {\"GrossRevenue\", Int64.Type}, {\"TotalGrossRevenuByTaxAuthority\", Int64.Type}}),",
                "    #\"Added Conditional Column\" = Table.AddColumn(#\"Changed Type\", \"Custom\", each if [Certified] = true then [TaxingEntity] else [TaxingEntity] & \" (DID NOT CERTIFY)\"),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"Custom\", \"StateReportName\", \"Certified\", \"GROSSASSESSED\", \"Levy\", \"GrossRevenue\", \"TotalLevyByTaxAuthority\", \"TotalGrossRevenuByTaxAuthority\", \"DateOfIssue\", \"MaturityDate\", \"TermInYears\", \"FundType\"}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Reordered Columns\",{\"TaxingEntity\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Custom\", \"TaxingEntity\"}}),",
                "    #\"Merged FundType_Position\" = Table.NestedJoin(#\"Renamed Columns\", {\"FundType\"}, FundType_Position, {\"Name\"}, \"FundType_Position\", JoinKind.LeftOuter),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged FundType_Position\", \"FundType_Position\", {\"Position_NON_32\"}, {\"Position\"}),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Expanded FundType_Position\", \"PositionRowGroup\", each if Number.Mod([Position],2) = 0",
                "then 2 ",
                "else Number.Mod([Position],2)),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Added Custom\",{{\"Position\", Int64.Type}, {\"PositionRowGroup\", Int64.Type}}),",
                "    #\"Replaced Value\" = Table.ReplaceValue(#\"Changed Type1\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"DateOfIssue\"}),",
                "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Replaced Value\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"MaturityDate\"}),",
                "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",0,null,Replacer.ReplaceValue,{\"TermInYears\"}),",
                "    #\"Added Levy12\" = Table.AddColumn(#\"Replaced Value2\", \"Levy12\", each if [Position] = 1 or [Position] = 2 then [Levy] else null),",
                "    #\"Added GrossRevenue12\" = Table.AddColumn(#\"Added Levy12\", \"GrossRevenue12\", each if [Position] = 1 or [Position] = 2 then [GrossRevenue] else null),",
                "    #\"Added Levy34\" = Table.AddColumn(#\"Added GrossRevenue12\", \"Levy34\", each if [Position] = 3 or [Position] = 4 then [Levy] else null),",
                "    #\"Added GrossRevenue34\" = Table.AddColumn(#\"Added Levy34\", \"GrossRevenue34\", each if [Position] = 3 or [Position] = 4 then [GrossRevenue] else null),",
                "    #\"Added Levy56\" = Table.AddColumn(#\"Added GrossRevenue34\", \"Levy56\", each if [Position] = 5 or [Position] = 6 then [Levy] else null),",
                "    #\"Added GrossRevenue56\" = Table.AddColumn(#\"Added Levy56\", \"GrossRevenue56\", each if [Position] = 5 or [Position] = 6 then [GrossRevenue] else null),",
                "    #\"Added Levy78\" = Table.AddColumn(#\"Added GrossRevenue56\", \"Levy78\", each if [Position] = 7 or [Position] = 8 then [Levy] else null),",
                "    #\"Added GrossRevenue78\" = Table.AddColumn(#\"Added Levy78\", \"GrossRevenue78\", each if [Position] = 7 or [Position] = 8 then [GrossRevenue] else null),",
                "",
                "    #\"Grouped Rows\" = Table.Group(#\"Added GrossRevenue78\", {\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"PositionRowGroup\", \"rownum\", \"Certified\", \"StateReportTabSection\"}, {{\"GROSSASSESSED\", each List.Max([GROSSASSESSED]), type nullable number}, {\"Levy12\", each List.Sum([Levy12]), type nullable number}, {\"GrossRevenue12\", each List.Sum([GrossRevenue12]), type nullable number}, {\"Levy34\", each List.Sum([Levy34]), type nullable number}, {\"GrossRevenue34\", each List.Sum([GrossRevenue34]), type nullable number}, {\"Levy56\", each List.Sum([Levy56]), type nullable number}, {\"GrossRevenue56\", each List.Sum([GrossRevenue56]), type nullable number}, {\"Levy78\", each List.Sum([Levy78]), type nullable number}, {\"GrossRevenue78\", each List.Sum([GrossRevenue78]), type nullable number}, {\"TotalLevy\", each List.Max([TotalLevyByTaxAuthority]), type nullable number}, {\"TotalGrossRevenue\", each List.Max([TotalGrossRevenuByTaxAuthority]), type nullable number}}),",
                "    #\"Added Position12\" = Table.AddColumn(#\"Grouped Rows\", \"Position12\", each if [PositionRowGroup] = 1",
                "then \"(1)\"",
                "else \"(2)\"),",
                "    #\"Added Position34\" = Table.AddColumn(#\"Added Position12\", \"Position34\", each if [PositionRowGroup] = 1",
                "then \"(3)\"",
                "else \"(4)\"),",
                "    #\"Added Position56\" = Table.AddColumn(#\"Added Position34\", \"Position56\", each if [PositionRowGroup] = 1",
                "then \"(5)\"",
                "else \"(6)\"),",
                "    #\"Added Position78\" = Table.AddColumn(#\"Added Position56\", \"Position78\", each if [PositionRowGroup] = 1",
                "then \"(7)\"",
                "else \"(8)\")",
                "in",
                "    #\"Added Position78\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Title 32 (2)",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "41bb36e7-021c-47c7-8059-19a5e340b183",
            "sourceColumn": "TaxYear",
            "summarizeBy": "sum"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "556a54a5-0749-4759-b013-70fb311757a3",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b9f85752-f06a-45c3-ba51-bbc8f6ec8db8",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6bac07f4-6d66-420e-88a6-832a16cf001c",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSectionSortOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "d0bee9c8-360e-485d-8bb3-5182b5b787d9",
            "sourceColumn": "StateReportTabSectionSortOrder",
            "summarizeBy": "sum"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "da40c74d-f911-4c16-8fc2-bce686558716",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "sum"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "efb6d05b-bebb-4d11-82ba-7c90cd3ab75d",
            "sourceColumn": "rownum",
            "summarizeBy": "sum"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "8d78719b-b578-40c2-a251-38144ff78488",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "DateOfIssue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7baba71a-02f8-49b3-9df7-36489f27fe06",
            "sourceColumn": "DateOfIssue",
            "summarizeBy": "none"
          },
          {
            "name": "TermInYears",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c17e5e1f-96da-410c-a4fc-4d411571fc68",
            "sourceColumn": "TermInYears",
            "summarizeBy": "sum"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "fb87a709-d819-4146-a4c4-74425159c009",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "19669e15-c378-4307-bcc0-10264dd1666c",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "909f07e0-5546-4713-b8bf-dcfb2029d100",
            "sourceColumn": "TotalGrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "a142d87c-c6ab-4348-988a-1950c943cf3d",
            "sourceColumn": "Levy12",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "13ae997f-031e-44f0-9457-1459c59c7bf5",
            "sourceColumn": "GrossRevenue12",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "96e89b18-576d-4068-9f6c-b4eee1c09101",
            "sourceColumn": "Levy34",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "d346d99d-0a1b-4f4b-9989-732f262180e2",
            "sourceColumn": "GrossRevenue34",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "2facd3a2-ba18-43c5-9ecb-cb312af5d0de",
            "sourceColumn": "Levy56",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "344cbcb9-2cc7-4814-b8e1-cb57bb98bc56",
            "sourceColumn": "GrossRevenue56",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "1f0fecfa-8d0a-4c09-8b28-0e54954b1f44",
            "sourceColumn": "Levy78",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "0a9ffcc7-f265-4d8e-b780-e46e1c94c08e",
            "sourceColumn": "GrossRevenue78",
            "summarizeBy": "sum"
          },
          {
            "name": "Position12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c0be8d7f-f5b5-4936-87e2-50a6b0e1539e",
            "sourceColumn": "Position12",
            "summarizeBy": "none"
          },
          {
            "name": "Position34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "0a800f80-7949-49f8-b172-a156a9edea22",
            "sourceColumn": "Position34",
            "summarizeBy": "none"
          },
          {
            "name": "Position56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "926680da-3e9a-4dbb-902c-5bea4f816359",
            "sourceColumn": "Position56",
            "summarizeBy": "none"
          },
          {
            "name": "Position78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "9cc7735f-1931-44cd-a715-0370ec21268a",
            "sourceColumn": "Position78",
            "summarizeBy": "none"
          },
          {
            "name": "Levy12Detail",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "babc8b06-c165-4f66-918d-400e5e18d9f3",
            "sourceColumn": "Levy12Detail",
            "summarizeBy": "none"
          },
          {
            "name": "GrossRevenue12Detail",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "2b9fd643-adc8-4e9a-bba3-5afca90d2fa3",
            "sourceColumn": "GrossRevenue12Detail",
            "summarizeBy": "none"
          },
          {
            "name": "Levy56Detail",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e3e9312a-498d-4ea3-a1f7-01852034fac9",
            "sourceColumn": "Levy56Detail",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED1Only",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ee919fa6-35d1-4ca6-be16-a79dbed804bb",
            "sourceColumn": "GROSSASSESSED1Only",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroupForTotals",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "558e78b0-3563-4b3b-baff-2373780f65c9",
            "sourceColumn": "PositionRowGroupForTotals",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "02c893b6-85ac-4ecb-87f6-b97d1a800cc2",
        "partitions": [
          {
            "name": "Title 32 (2)",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(azure_server, azure_database, [Query=\"with TAXAUTHORITYDETAIL as (#(lf)#(tab)select  #(lf)#(tab)#(tab) TaxYear = authoritydetail.BudgetYear#(lf)#(tab)#(tab),TaxDistrictID = authority.[TaxDistrictID]#(lf)#(tab)#(tab),TaxingEntity = authority.[Name] #(lf)#(tab)#(tab),TaxAuthority = authority.CountyTaxEntityCode#(lf)#(tab)#(tab),GROSSASSESSED = authoritydetail.[GrossAssessedValue]#(lf)#(tab)#(tab)from#(tab)#(tab)[dbo].[TaxDistrict]#(tab)#(tab)#(tab)#(tab)#(tab)authority#(lf)#(tab)#(tab)join#(tab)#(tab)[dbo].[TaxDistrictYear]#(tab)#(tab)#(tab)#(tab)authoritydetail on authority.TaxDistrictId = authoritydetail.TaxDistrictId#(lf)#(tab)#(tab)where authoritydetail.IsActive = 1#(lf)),#(lf)fundbyyear as (#(lf)#(tab)select #(lf)#(tab)#(tab) TaxYear = fundyear.BudgetYear#(lf)#(tab)#(tab),fundyear.FundYearId#(lf)#(lf)#(tab)#(tab),fund.FundID#(lf)#(tab)#(tab),fund.TaxDistrictID#(lf)#(tab)#(tab),FundType = fundtype.[Name]#(lf)#(tab)#(tab),fund.IsActive#(lf)#(lf)#(tab)#(tab),DateOfIssue = convert(char(10),fund.DateOfIssue)#(tab)#(lf)#(tab)#(tab),MaturityDate = convert(char(10),fund.MaturityDate)#(lf)#(tab)#(tab),TermInYears = DateDiff(year, fund.MaturityDate, fund.DateOfIssue)#(lf)#(tab)#(tab),Levy = case when fundtype.[Name] = 'TEMP TAX CREDIT' then (fundyear.MillLevy * -1) else fundyear.MillLevy end#(lf)#(tab)#(tab),GrossRevenue = case when fundtype.[Name] = 'TEMP TAX CREDIT' then (fundyear.GrossRevenue * -1) else fundyear.GrossRevenue end#(lf)#(tab)from #(lf)#(tab)#(tab)dbo.FundYear#(tab)#(tab)fundyear #(lf)#(tab)#(tab)join dbo.Fund#(tab)#(tab)fund on fundyear.FundID = fund.FundID#(lf)#(tab)#(tab)join dbo.FundType#(tab)fundtype on fund.FundTypeID = fundtype.FundTypeID#(lf)#(lf)), certified as (#(lf)#(tab)select#(lf)#(tab)#(tab)CertificationID#(lf)#(tab)#(tab),TaxDistrictID#(lf)#(tab)#(tab),TaxYear = BudgetYear#(lf)#(tab)#(tab),Certified = case when (CertificationStatusID = 5) then 'true' else 'false' end#(lf)#(lf)#(tab)#(tab),TotalLevy#(lf)#(tab)#(tab),TotalGrossRevenue#(lf)#(tab)from [dbo].[Certification]#(lf)#(tab)where 1=1#(lf)#(tab)#(tab)and (CertificationStatusID = 5)#(lf))#(lf)select#(tab)#(lf)#(tab)c.TaxYear#(lf)#(tab),ta.TaxAuthority#(lf)#(tab),ta.TaxingEntity#(lf)#(tab),c.Certified#(lf)#(tab)--numbers and dates#(lf)#(tab),ta.GROSSASSESSED#(lf)#(tab),fy.Levy #(lf)#(tab),fy.GrossRevenue #(lf)#(tab),TotalLevyByTaxAuthority = (select sum(fby.Levy) from fundbyyear fby where fby.TaxDistrictID = ta.TaxDistrictID and fby.TaxYear = ta.TaxYear group by fby.TaxDistrictID,fby.TaxYear)#(lf)#(tab),c.TotalLevy#(lf)#(tab),TotalGrossRevenuByTaxAuthority = (select sum(fby.GrossRevenue) from fundbyyear fby where fby.TaxDistrictID = ta.TaxDistrictID and fby.TaxYear = ta.TaxYear group by fby.TaxDistrictID,fby.TaxYear)#(lf)#(tab),c.TotalGrossRevenue#(lf)#(tab),fy.DateOfIssue#(tab)#(lf)#(tab),fy.MaturityDate#(lf)#(tab),fy.TermInYears#(lf)--#(tab)--used to map positions#(lf)#(tab),fy.FundType#(lf)#(tab),rownum = ROW_NUMBER() over(partition by ta.TaxYear,ta.TaxDistrictID, fy.FundType order by fy.FundType, isnull(fy.Levy, 999999)) #(lf)--select *#(lf)from TAXAUTHORITYDETAIL ta#(lf)#(tab)join certified c on ta.TaxDistrictID = c.TaxDistrictID and ta.TaxYear = c.TaxYear#(lf)#(tab)join fundbyyear fy on ta.TaxDistrictID = fy.TaxDistrictID and ta.TAXYEAR = fy.TaxYear#(lf)\", CreateNavigationProperties=false]),",
                "    #\"Filtered Year\" = Table.SelectRows(Source, each [TaxYear] = TaxYear_Param or [TaxYear] = TaxYear_Param_LY",
                "),",
                "    #\"Merged Queries1\" = Table.NestedJoin(#\"Filtered Year\", {\"TaxAuthority\"}, #\"Tax Authority Info\", {\"TaxAuthority\"}, \"Tax Authority Info\", JoinKind.Inner),",
                "    #\"Expanded Tax Authority Info\" = Table.ExpandTableColumn(#\"Merged Queries1\", \"Tax Authority Info\", {\"StateReportName\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\"}, {\"StateReportName\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\"}),",
                "    #\"Filtered Rows\" = Table.SelectRows(#\"Expanded Tax Authority Info\", each ([StateReportName] = \"Title 32\")),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Filtered Rows\",{{\"TaxYear\", Int64.Type}, {\"Certified\", type logical}, {\"GROSSASSESSED\", Int64.Type}, {\"GrossRevenue\", Int64.Type}, {\"TotalGrossRevenuByTaxAuthority\", Int64.Type}}),",
                "    #\"Added Conditional Column\" = Table.AddColumn(#\"Changed Type\", \"Custom\", each if [Certified] = true then [TaxingEntity] else [TaxingEntity] & \" (DID NOT CERTIFY)\"),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"Custom\", \"StateReportName\", \"Certified\", \"GROSSASSESSED\", \"Levy\", \"GrossRevenue\", \"TotalLevyByTaxAuthority\", \"TotalGrossRevenuByTaxAuthority\", \"DateOfIssue\", \"MaturityDate\", \"TermInYears\", \"FundType\"}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Reordered Columns\",{\"TaxingEntity\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Custom\", \"TaxingEntity\"}}),",
                "    #\"Merged FundType_Position\" = Table.NestedJoin(#\"Renamed Columns\", {\"FundType\"}, FundType_Position, {\"Name\"}, \"FundType_Position\", JoinKind.LeftOuter),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged FundType_Position\", \"FundType_Position\", {\"Position_TITLE_32\"}, {\"Position\"}),",
                "    #\"Added PositionRowGroup\" = Table.AddColumn(#\"Expanded FundType_Position\", \"PositionRowGroup\", each if [Position] = 4",
                "then 3",
                "else if Number.Mod([Position],2) = 0",
                "     then 2 ",
                "     else Number.Mod([Position],2)),",
                "    #\"Changed Type1 Position\" = Table.TransformColumnTypes(#\"Added PositionRowGroup\",{{\"Position\", Int64.Type}, {\"PositionRowGroup\", Int64.Type}}),",
                "    #\"Replaced Value DateOfIssue\" = Table.ReplaceValue(#\"Changed Type1 Position\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"DateOfIssue\"}),",
                "    #\"Replaced Value1 MaturityDate\" = Table.ReplaceValue(#\"Replaced Value DateOfIssue\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"MaturityDate\"}),",
                "    #\"Replaced Value TermInYears\" = Table.ReplaceValue(#\"Replaced Value1 MaturityDate\",0,null,Replacer.ReplaceValue,{\"TermInYears\"}),",
                "    #\"Added Levy12\" = Table.AddColumn(#\"Replaced Value TermInYears\", \"Levy12\", each if [Position] = 1 or [Position] = 2 then [Levy] else null),",
                "    #\"Added GrossRevenue12\" = Table.AddColumn(#\"Added Levy12\", \"GrossRevenue12\", each if [Position] = 1 or [Position] = 2 then [GrossRevenue] else null),",
                "    #\"Added Levy34\" = Table.AddColumn(#\"Added GrossRevenue12\", \"Levy34\", each if [Position] = 3 or [Position] = 4 then [Levy] else null),",
                "    #\"Added GrossRevenue34\" = Table.AddColumn(#\"Added Levy34\", \"GrossRevenue34\", each if [Position] = 3 or [Position] = 4 then [GrossRevenue] else null),",
                "    #\"Added Levy56\" = Table.AddColumn(#\"Added GrossRevenue34\", \"Levy56\", each if [Position] = 5 or [Position] = 6 then [Levy] else null),",
                "    #\"Added GrossRevenue56\" = Table.AddColumn(#\"Added Levy56\", \"GrossRevenue56\", each if [Position] = 5 or [Position] = 6 then [GrossRevenue] else null),",
                "    #\"Added Levy78\" = Table.AddColumn(#\"Added GrossRevenue56\", \"Levy78\", each if [Position] = 7 or [Position] = 8 then [Levy] else null),",
                "    #\"Added GrossRevenue78\" = Table.AddColumn(#\"Added Levy78\", \"GrossRevenue78\", each if [Position] = 7 or [Position] = 8 then [GrossRevenue] else null),",
                "",
                "    #\"Grouped Rows\" = Table.Group(#\"Added GrossRevenue78\", {\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\", \"PositionRowGroup\", \"rownum\", \"Certified\", \"DateOfIssue\", \"TermInYears\"}, {{\"GROSSASSESSED\", each List.Max([GROSSASSESSED]), type nullable number}, {\"TotalLevy\", each List.Max([TotalLevyByTaxAuthority]), type nullable number}, {\"TotalGrossRevenue\", each List.Max([TotalGrossRevenuByTaxAuthority]), type nullable number}, {\"Levy12\", each List.Sum([Levy12]), type nullable number}, {\"GrossRevenue12\", each List.Sum([GrossRevenue12]), type nullable number}, {\"Levy34\", each List.Sum([Levy34]), type nullable number}, {\"GrossRevenue34\", each List.Sum([GrossRevenue34]), type nullable number}, {\"Levy56\", each List.Sum([Levy56]), type nullable number}, {\"GrossRevenue56\", each List.Sum([GrossRevenue56]), type nullable number}, {\"Levy78\", each List.Sum([Levy78]), type nullable number}, {\"GrossRevenue78\", each List.Sum([GrossRevenue78]), type nullable number}}),",
                "    #\"Added Position12\" = Table.AddColumn(#\"Grouped Rows\", \"Position12\", each if [PositionRowGroup] = 1",
                "then \"(1)\"",
                "else \"(2)\"),",
                "    #\"Added Position34\" = Table.AddColumn(#\"Added Position12\", \"Position34\", each if [PositionRowGroup] = 1",
                "then \"(3)\"",
                "else \"(4)\"),",
                "    #\"Added Position56\" = Table.AddColumn(#\"Added Position34\", \"Position56\", each if [PositionRowGroup] = 1",
                "then \"(5)\"",
                "else \"(6)\"),",
                "    #\"Added Position78\" = Table.AddColumn(#\"Added Position56\", \"Position78\", each if [PositionRowGroup] = 1",
                "then \"(7)\"",
                "else \"(8)\"),",
                "    #\"Added Levy12Detail\" = Table.AddColumn(#\"Added Position78\", \"Levy12Detail\", each if [PositionRowGroup] = 3",
                "then \"Bond Date: \" ",
                "else ",
                "if [Levy12] <> null",
                "then if [Levy12] >= 0 then Number.ToText([Levy12],\"F3\",\"\") else \"(\" & Number.ToText(Number.Abs([Levy12]),\"F3\",\"\") & \")\"",
                "else null),",
                "    #\"Added GrossRevenue12Detail\" = Table.AddColumn(#\"Added Levy12Detail\", \"GrossRevenue12Detail\", each ",
                "if [PositionRowGroup] = 3 ",
                "then [DateOfIssue] ",
                "else if [GrossRevenue12] = null",
                "     then null",
                "     else if [GrossRevenue12] >= 0 ",
                "          then \"$\" & Number.ToText([GrossRevenue12], \"N0\", \"\")",
                "          else \"$(\" & Number.ToText(Number.Abs([GrossRevenue12]), \"N0\", \"\") & \")\"",
                "          ),",
                "    #\"Added Levy56Detail\" = Table.AddColumn(#\"Added GrossRevenue12Detail\", \"Levy56Detail\", each ",
                "if [PositionRowGroup] = 3",
                "then \"term in years: \" & Number.ToText([TermInYears])",
                "else if [Levy56] <> null",
                "     then if [Levy56] >= 0 ",
                "          then Number.ToText([Levy56],\"F3\",\"\") ",
                "          else \"(\" & Number.ToText(Number.Abs([Levy56]),\"F3\",\"\") & \")\"",
                "     else null),",
                "    #\"Added GROSSASSESSED1Only\" = Table.AddColumn(#\"Added Levy56Detail\", \"GROSSASSESSED1Only\", each if [PositionRowGroup] = 1 then [GROSSASSESSED] else null),",
                "    #\"Added PositionRowGroupForTotals\" = Table.AddColumn(#\"Added GROSSASSESSED1Only\", \"PositionRowGroupForTotals\", each if [PositionRowGroup] = 3 then 2 else [PositionRowGroup])",
                "in",
                "    #\"Added PositionRowGroupForTotals\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Schools (2)",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "7630af93-f52a-4d48-93ed-d726d55c3e13",
            "sourceColumn": "TaxYear",
            "summarizeBy": "sum"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "690329f5-89f1-4c19-90ef-8bef1fd0a74f",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f5e784ac-03b5-4311-a74c-9a13ad0ef814",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "820ef12b-033d-4112-9eb8-dfe9a2066492",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "sum"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "96272de0-973b-4a45-9786-800ec2625671",
            "sourceColumn": "rownum",
            "summarizeBy": "sum"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "8ca9d0d0-c690-486e-a8dd-0f7995750af3",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "929cd75f-4031-4413-84e5-6bdc480fa5f3",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "660b78c4-89a2-4bce-a632-524343f36cf8",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "127b2be4-7ec9-4337-af2e-b05dac3dae01",
            "sourceColumn": "Levy12",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "6eb95f3a-632a-4ab6-a679-e2909a37127b",
            "sourceColumn": "GrossRevenue12",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "f20676f0-1e3e-423b-bde4-a8c0301ca927",
            "sourceColumn": "Levy34",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "c9843570-2ed2-4284-9a0c-387fe828ade8",
            "sourceColumn": "GrossRevenue34",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "e1e93427-e6ee-4cb4-83e8-d8a83fbda4c6",
            "sourceColumn": "Levy56",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "e53ff81c-f829-415f-b6aa-3309b7edbd5b",
            "sourceColumn": "GrossRevenue56",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "6e317306-0dce-4cba-961c-f54472566158",
            "sourceColumn": "Levy78",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "b8c651a7-f625-446c-a565-00d864bde870",
            "sourceColumn": "GrossRevenue78",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "80a4f4c0-5255-45ba-be71-2edc8b7cb3f6",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "a1e8d26b-55a1-4d03-9d9d-24b89349187b",
            "sourceColumn": "TotalGrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "Position12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "df5d7f33-6363-45e7-9673-cab277f6f18a",
            "sourceColumn": "Position12",
            "summarizeBy": "none"
          },
          {
            "name": "Position34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "92b90ba9-baae-4253-b925-1d3693515f7c",
            "sourceColumn": "Position34",
            "summarizeBy": "none"
          },
          {
            "name": "Position56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ddcb02ac-646b-4ffc-8ddf-653932f6d14c",
            "sourceColumn": "Position56",
            "summarizeBy": "none"
          },
          {
            "name": "Position78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4a89f790-940d-47af-b341-06b3cf9f0a27",
            "sourceColumn": "Position78",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "6a2f0722-bcb0-44e2-b701-b87fa76f249a",
        "partitions": [
          {
            "name": "Schools (2)",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(azure_server, azure_database, [Query=\"with TAXAUTHORITYDETAIL as (#(lf)#(tab)select  #(lf)#(tab)#(tab) TaxYear = authoritydetail.BudgetYear#(lf)#(tab)#(tab),TaxDistrictID = authority.[TaxDistrictID]#(lf)#(tab)#(tab),TaxingEntity = authority.[Name] #(lf)#(tab)#(tab),TaxAuthority = authority.CountyTaxEntityCode#(lf)#(tab)#(tab),GROSSASSESSED = authoritydetail.[GrossAssessedValue]#(lf)#(tab)#(tab)from#(tab)#(tab)[dbo].[TaxDistrict]#(tab)#(tab)#(tab)#(tab)#(tab)authority#(lf)#(tab)#(tab)join#(tab)#(tab)[dbo].[TaxDistrictYear]#(tab)#(tab)#(tab)#(tab)authoritydetail on authority.TaxDistrictId = authoritydetail.TaxDistrictId#(lf)#(tab)#(tab)where authoritydetail.IsActive = 1#(lf)),#(lf)fundbyyear as (#(lf)#(tab)select #(lf)#(tab)#(tab) TaxYear = fundyear.BudgetYear#(lf)#(tab)#(tab),fundyear.FundYearId#(lf)#(lf)#(tab)#(tab),fund.FundID#(lf)#(tab)#(tab),fund.TaxDistrictID#(lf)#(tab)#(tab),FundType = fundtype.[Name]#(lf)#(tab)#(tab),fund.IsActive#(lf)#(lf)#(tab)#(tab),fund.DateOfIssue#(tab)#(lf)#(tab)#(tab),fund.MaturityDate#(lf)#(tab)#(tab),TermInYears = DateDiff(year, fund.MaturityDate, fund.DateOfIssue)#(lf)#(tab)#(tab),Levy = case when fundtype.[Name] = 'TEMP TAX CREDIT' then (fundyear.MillLevy * -1) else fundyear.MillLevy end#(lf)#(tab)#(tab),GrossRevenue = case when fundtype.[Name] = 'TEMP TAX CREDIT' then (fundyear.GrossRevenue * -1) else fundyear.GrossRevenue end#(lf)#(tab)from #(lf)#(tab)#(tab)dbo.FundYear#(tab)#(tab)fundyear #(lf)#(tab)#(tab)join dbo.Fund#(tab)#(tab)fund on fundyear.FundID = fund.FundID#(lf)#(tab)#(tab)join dbo.FundType#(tab)fundtype on fund.FundTypeID = fundtype.FundTypeID#(lf)#(lf)), certified as (#(lf)#(tab)select#(lf)#(tab)#(tab)CertificationID#(lf)#(tab)#(tab),TaxDistrictID#(lf)#(tab)#(tab),TaxYear = BudgetYear#(lf)#(tab)#(tab),Certified = case when (CertificationStatusID = 5) then 'true' else 'false' end#(lf)#(lf)#(tab)#(tab),TotalLevy#(lf)#(tab)#(tab),TotalGrossRevenue#(lf)#(tab)from [dbo].[Certification]#(lf)#(tab)where 1=1#(lf)#(tab)#(tab)and (CertificationStatusID = 5)#(lf))#(lf)select#(tab)#(lf)#(tab)c.TaxYear#(lf)#(tab),ta.TaxAuthority#(lf)#(tab),ta.TaxingEntity#(lf)#(tab),c.Certified#(lf)#(tab)--numbers and dates#(lf)#(tab),ta.GROSSASSESSED#(lf)#(tab),fy.Levy #(lf)#(tab),fy.GrossRevenue #(lf)#(tab),TotalLevyByTaxAuthority = (select sum(fby.Levy) from fundbyyear fby where fby.TaxDistrictID = ta.TaxDistrictID and fby.TaxYear = ta.TaxYear group by fby.TaxDistrictID,fby.TaxYear)#(lf)#(tab),c.TotalLevy#(lf)#(tab),TotalGrossRevenuByTaxAuthority = (select sum(fby.GrossRevenue) from fundbyyear fby where fby.TaxDistrictID = ta.TaxDistrictID and fby.TaxYear = ta.TaxYear group by fby.TaxDistrictID,fby.TaxYear)#(lf)#(tab),c.TotalGrossRevenue#(lf)#(tab),fy.DateOfIssue#(tab)#(lf)#(tab),fy.MaturityDate#(lf)#(tab),fy.TermInYears#(lf)--#(tab)--used to map positions#(lf)#(tab),fy.FundType#(lf)#(tab),rownum = ROW_NUMBER() over(partition by ta.TaxYear,ta.TaxDistrictID, fy.FundType order by fy.FundType, isnull(fy.Levy, 999999)) #(lf)--select *#(lf)from TAXAUTHORITYDETAIL ta#(lf)#(tab)join certified c on ta.TaxDistrictID = c.TaxDistrictID and ta.TaxYear = c.TaxYear#(lf)#(tab)join fundbyyear fy on ta.TaxDistrictID = fy.TaxDistrictID and ta.TAXYEAR = fy.TaxYear#(lf)\", CreateNavigationProperties=false]),",
                "    #\"Filtered Year\" = Table.SelectRows(Source, each [TaxYear] = TaxYear_Param or [TaxYear] = TaxYear_Param_LY),",
                "    #\"Merged Queries1\" = Table.NestedJoin(#\"Filtered Year\", {\"TaxAuthority\"}, #\"Tax Authority Info\", {\"TaxAuthority\"}, \"Tax Authority Info\", JoinKind.Inner),",
                "    #\"Expanded Tax Authority Info\" = Table.ExpandTableColumn(#\"Merged Queries1\", \"Tax Authority Info\", {\"StateReportName\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\"}, {\"StateReportName\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\"}),",
                "    #\"Filtered Rows\" = Table.SelectRows(#\"Expanded Tax Authority Info\", each ([StateReportName] = \"Schools\")),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Filtered Rows\",{{\"TaxYear\", Int64.Type}, {\"Certified\", type logical}, {\"GROSSASSESSED\", Int64.Type}, {\"GrossRevenue\", Int64.Type}, {\"TotalGrossRevenuByTaxAuthority\", Int64.Type}}),",
                "    #\"Added Conditional Column\" = Table.AddColumn(#\"Changed Type\", \"Custom\", each if [Certified] = true then [TaxingEntity] else [TaxingEntity] & \" (DID NOT CERTIFY)\"),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"Custom\", \"StateReportName\", \"Certified\", \"GROSSASSESSED\", \"Levy\", \"GrossRevenue\", \"TotalLevyByTaxAuthority\", \"TotalGrossRevenuByTaxAuthority\", \"DateOfIssue\", \"MaturityDate\", \"TermInYears\", \"FundType\"}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Reordered Columns\",{\"TaxingEntity\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Custom\", \"TaxingEntity\"}}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Renamed Columns\", {\"FundType\"}, FundType_Position, {\"Name\"}, \"FundType_Position\", JoinKind.LeftOuter),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged Queries\", \"FundType_Position\", {\"Position_Schools\"}, {\"Position\"}),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Expanded FundType_Position\", \"PositionRowGroup\", each if Number.Mod([Position],2) = 0",
                "then 2 ",
                "else Number.Mod([Position],2)),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Added Custom\",{{\"Position\", Int64.Type}, {\"PositionRowGroup\", Int64.Type}}),",
                "    #\"Replaced Value\" = Table.ReplaceValue(#\"Changed Type1\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"DateOfIssue\"}),",
                "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Replaced Value\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"MaturityDate\"}),",
                "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",0,null,Replacer.ReplaceValue,{\"TermInYears\"}),",
                "    #\"Added Levy12\" = Table.AddColumn(#\"Replaced Value2\", \"Levy12\", each if [Position] = 1 or [Position] = 2 then [Levy] else null),",
                "    #\"Added GrossRevenue12\" = Table.AddColumn(#\"Added Levy12\", \"GrossRevenue12\", each if [Position] = 1 or [Position] = 2 then [GrossRevenue] else null),",
                "    #\"Added Levy34\" = Table.AddColumn(#\"Added GrossRevenue12\", \"Levy34\", each if [Position] = 3 or [Position] = 4 then [Levy] else null),",
                "    #\"Added GrossRevenue34\" = Table.AddColumn(#\"Added Levy34\", \"GrossRevenue34\", each if [Position] = 3 or [Position] = 4 then [GrossRevenue] else null),",
                "    #\"Added Levy56\" = Table.AddColumn(#\"Added GrossRevenue34\", \"Levy56\", each if [Position] = 5 or [Position] = 6 then [Levy] else null),",
                "    #\"Added GrossRevenue56\" = Table.AddColumn(#\"Added Levy56\", \"GrossRevenue56\", each if [Position] = 5 or [Position] = 6 then [GrossRevenue] else null),",
                "    #\"Added Levy78\" = Table.AddColumn(#\"Added GrossRevenue56\", \"Levy78\", each if [Position] = 7 or [Position] = 8 then [Levy] else null),",
                "    #\"Added GrossRevenue78\" = Table.AddColumn(#\"Added Levy78\", \"GrossRevenue78\", each if [Position] = 7 or [Position] = 8 then [GrossRevenue] else null),",
                "",
                "    #\"Grouped Rows\" = Table.Group(#\"Added GrossRevenue78\", {\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"PositionRowGroup\", \"rownum\", \"Certified\", \"StateReportTabSection\"}, {{\"GROSSASSESSED\", each List.Max([GROSSASSESSED]), type nullable number}, {\"Levy12\", each List.Sum([Levy12]), type nullable number}, {\"GrossRevenue12\", each List.Sum([GrossRevenue12]), type nullable number}, {\"Levy34\", each List.Sum([Levy34]), type nullable number}, {\"GrossRevenue34\", each List.Sum([GrossRevenue34]), type nullable number}, {\"Levy56\", each List.Sum([Levy56]), type nullable number}, {\"GrossRevenue56\", each List.Sum([GrossRevenue56]), type nullable number}, {\"Levy78\", each List.Sum([Levy78]), type nullable number}, {\"GrossRevenue78\", each List.Sum([GrossRevenue78]), type nullable number}, {\"TotalLevy\", each List.Max([TotalLevyByTaxAuthority]), type nullable number}, {\"TotalGrossRevenue\", each List.Max([TotalGrossRevenuByTaxAuthority]), type nullable number}}),",
                "    #\"Added Position12\" = Table.AddColumn(#\"Grouped Rows\", \"Position12\", each if [PositionRowGroup] = 1",
                "then \"(1)\"",
                "else \"(2)\"),",
                "    #\"Added Position34\" = Table.AddColumn(#\"Added Position12\", \"Position34\", each if [PositionRowGroup] = 1",
                "then \"(3)\"",
                "else \"(4)\"),",
                "    #\"Added Position56\" = Table.AddColumn(#\"Added Position34\", \"Position56\", each if [PositionRowGroup] = 1",
                "then \"(5)\"",
                "else \"(6)\"),",
                "    #\"Added Position78\" = Table.AddColumn(#\"Added Position56\", \"Position78\", each if [PositionRowGroup] = 1",
                "then \"(7)\"",
                "else \"(8)\")",
                "in",
                "    #\"Added Position78\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "City (2)",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ef0f9c56-8ed5-4e92-8eb5-e978b41eebc0",
            "sourceColumn": "TaxYear",
            "summarizeBy": "sum"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d0e2eaf7-4d4a-4bb3-92c4-10e24a3f4401",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f19e845c-f593-4fed-aab7-11de9a327fb0",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "PositionRowGroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "aed04f42-e577-4250-aca8-274b13faba09",
            "sourceColumn": "PositionRowGroup",
            "summarizeBy": "sum"
          },
          {
            "name": "rownum",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4718615e-1241-445a-9925-7326abbb7786",
            "sourceColumn": "rownum",
            "summarizeBy": "sum"
          },
          {
            "name": "Certified",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "29c0db3e-d8f0-44e5-9405-60db7b10208e",
            "sourceColumn": "Certified",
            "summarizeBy": "none"
          },
          {
            "name": "StateReportTabSection",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "14963196-4b3a-48fa-abab-3319df956708",
            "sourceColumn": "StateReportTabSection",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "3b6396bb-7a6f-484c-a547-270e83f5ab8c",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "45db96fd-de1c-4af0-b2d0-c7282240d717",
            "sourceColumn": "Levy12",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "b15f45a7-a074-4e01-aadc-4a8510ff4731",
            "sourceColumn": "GrossRevenue12",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "d75676e3-27da-4363-8054-084de334677f",
            "sourceColumn": "Levy34",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "ec4242aa-fdf9-40ae-9e39-bc6d09966821",
            "sourceColumn": "GrossRevenue34",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "cefa8992-3572-4892-9831-79f5f8d12cfa",
            "sourceColumn": "Levy56",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "81eb8f9a-60e0-4fcf-a645-0593fed86b52",
            "sourceColumn": "GrossRevenue56",
            "summarizeBy": "sum"
          },
          {
            "name": "Levy78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "0cd3a29e-ebdf-41b6-883f-b497629def37",
            "sourceColumn": "Levy78",
            "summarizeBy": "sum"
          },
          {
            "name": "GrossRevenue78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "0f9b59d6-8601-4977-9f17-95faca94e7ea",
            "sourceColumn": "GrossRevenue78",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalLevy",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "38028899-701d-4b91-b320-8439fc6a7419",
            "sourceColumn": "TotalLevy",
            "summarizeBy": "sum"
          },
          {
            "name": "TotalGrossRevenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "a2b8ebde-4b50-43d9-aad0-4641b83720bb",
            "sourceColumn": "TotalGrossRevenue",
            "summarizeBy": "sum"
          },
          {
            "name": "Position12",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "83febf18-0330-47b3-9a97-98bfa10a8151",
            "sourceColumn": "Position12",
            "summarizeBy": "none"
          },
          {
            "name": "Position34",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7291eb66-4e07-4208-8a1d-c75460fba5f5",
            "sourceColumn": "Position34",
            "summarizeBy": "none"
          },
          {
            "name": "Position56",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "8cf1f26f-3df1-44ab-8754-f72864aeab4b",
            "sourceColumn": "Position56",
            "summarizeBy": "none"
          },
          {
            "name": "Position78",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "03930c88-e4a5-4266-a335-eee0ca5616a6",
            "sourceColumn": "Position78",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "a93fa788-18be-4d0b-9a87-ea5f64deb51c",
        "partitions": [
          {
            "name": "City (2)",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(azure_server, azure_database, [Query=\"with TAXAUTHORITYDETAIL as (#(lf)#(tab)select  #(lf)#(tab)#(tab) TaxYear = authoritydetail.BudgetYear#(lf)#(tab)#(tab),TaxDistrictID = authority.[TaxDistrictID]#(lf)#(tab)#(tab),TaxingEntity = authority.[Name] #(lf)#(tab)#(tab),TaxAuthority = authority.CountyTaxEntityCode#(lf)#(tab)#(tab),GROSSASSESSED = authoritydetail.[GrossAssessedValue]#(lf)#(tab)#(tab)from#(tab)#(tab)[dbo].[TaxDistrict]#(tab)#(tab)#(tab)#(tab)#(tab)authority#(lf)#(tab)#(tab)join#(tab)#(tab)[dbo].[TaxDistrictYear]#(tab)#(tab)#(tab)#(tab)authoritydetail on authority.TaxDistrictId = authoritydetail.TaxDistrictId#(lf)#(tab)#(tab)where authoritydetail.IsActive = 1#(lf)),#(lf)fundbyyear as (#(lf)#(tab)select #(lf)#(tab)#(tab) TaxYear = fundyear.BudgetYear#(lf)#(tab)#(tab),fundyear.FundYearId#(lf)#(lf)#(tab)#(tab),fund.FundID#(lf)#(tab)#(tab),fund.TaxDistrictID#(lf)#(tab)#(tab),FundType = fundtype.[Name]#(lf)#(tab)#(tab),fund.IsActive#(lf)#(lf)#(tab)#(tab),fund.DateOfIssue#(tab)#(lf)#(tab)#(tab),fund.MaturityDate#(lf)#(tab)#(tab),TermInYears = DateDiff(year, fund.MaturityDate, fund.DateOfIssue)#(lf)#(tab)#(tab),Levy = case when fundtype.[Name] = 'TEMP TAX CREDIT' then (fundyear.MillLevy * -1) else fundyear.MillLevy end#(lf)#(tab)#(tab),GrossRevenue = case when fundtype.[Name] = 'TEMP TAX CREDIT' then (fundyear.GrossRevenue * -1) else fundyear.GrossRevenue end#(lf)#(tab)from #(lf)#(tab)#(tab)dbo.FundYear#(tab)#(tab)fundyear #(lf)#(tab)#(tab)join dbo.Fund#(tab)#(tab)fund on fundyear.FundID = fund.FundID#(lf)#(tab)#(tab)join dbo.FundType#(tab)fundtype on fund.FundTypeID = fundtype.FundTypeID#(lf)#(lf)), certified as (#(lf)#(tab)select#(lf)#(tab)#(tab)CertificationID#(lf)#(tab)#(tab),TaxDistrictID#(lf)#(tab)#(tab),TaxYear = BudgetYear#(lf)#(tab)#(tab),Certified = case when (CertificationStatusID = 5) then 'true' else 'false' end#(lf)#(lf)#(tab)#(tab),TotalLevy#(lf)#(tab)#(tab),TotalGrossRevenue#(lf)#(tab)from [dbo].[Certification]#(lf)#(tab)where 1=1#(lf)#(tab)#(tab)and (CertificationStatusID = 5)#(lf))#(lf)select#(tab)#(lf)#(tab)c.TaxYear#(lf)#(tab),ta.TaxAuthority#(lf)#(tab),ta.TaxingEntity#(lf)#(tab),c.Certified#(lf)#(tab)--numbers and dates#(lf)#(tab),ta.GROSSASSESSED#(lf)#(tab),fy.Levy #(lf)#(tab),fy.GrossRevenue #(lf)#(tab),TotalLevyByTaxAuthority = (select sum(fby.Levy) from fundbyyear fby where fby.TaxDistrictID = ta.TaxDistrictID and fby.TaxYear = ta.TaxYear group by fby.TaxDistrictID,fby.TaxYear)#(lf)#(tab),c.TotalLevy#(lf)#(tab),TotalGrossRevenuByTaxAuthority = (select sum(fby.GrossRevenue) from fundbyyear fby where fby.TaxDistrictID = ta.TaxDistrictID and fby.TaxYear = ta.TaxYear group by fby.TaxDistrictID,fby.TaxYear)#(lf)#(tab),c.TotalGrossRevenue#(lf)#(tab),fy.DateOfIssue#(tab)#(lf)#(tab),fy.MaturityDate#(lf)#(tab),fy.TermInYears#(lf)--#(tab)--used to map positions#(lf)#(tab),fy.FundType#(lf)#(tab),rownum = ROW_NUMBER() over(partition by ta.TaxYear,ta.TaxDistrictID, fy.FundType order by fy.FundType, isnull(fy.Levy, 999999)) #(lf)--select *#(lf)from TAXAUTHORITYDETAIL ta#(lf)#(tab)join certified c on ta.TaxDistrictID = c.TaxDistrictID and ta.TaxYear = c.TaxYear#(lf)#(tab)join fundbyyear fy on ta.TaxDistrictID = fy.TaxDistrictID and ta.TAXYEAR = fy.TaxYear#(lf)\", CreateNavigationProperties=false]),",
                "    #\"Filtered Year\" = Table.SelectRows(Source, each [TaxYear] = TaxYear_Param or [TaxYear] = TaxYear_Param_LY),",
                "    #\"Merged Queries1\" = Table.NestedJoin(#\"Filtered Year\", {\"TaxAuthority\"}, #\"Tax Authority Info\", {\"TaxAuthority\"}, \"Tax Authority Info\", JoinKind.Inner),",
                "    #\"Expanded Tax Authority Info\" = Table.ExpandTableColumn(#\"Merged Queries1\", \"Tax Authority Info\", {\"StateReportName\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\"}, {\"StateReportName\", \"StateReportTabSection\", \"StateReportTabSectionSortOrder\"}),",
                "    #\"Filtered Rows\" = Table.SelectRows(#\"Expanded Tax Authority Info\", each ([StateReportName] = \"City\")),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Filtered Rows\",{{\"TaxYear\", Int64.Type}, {\"Certified\", type logical}, {\"GROSSASSESSED\", Int64.Type}, {\"GrossRevenue\", Int64.Type}, {\"TotalGrossRevenuByTaxAuthority\", Int64.Type}}),",
                "    #\"Added Conditional Column\" = Table.AddColumn(#\"Changed Type\", \"Custom\", each if [Certified] = true then [TaxingEntity] else [TaxingEntity] & \" (DID NOT CERTIFY)\"),",
                "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"Custom\", \"StateReportName\", \"Certified\", \"GROSSASSESSED\", \"Levy\", \"GrossRevenue\", \"TotalLevyByTaxAuthority\", \"TotalGrossRevenuByTaxAuthority\", \"DateOfIssue\", \"MaturityDate\", \"TermInYears\", \"FundType\"}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Reordered Columns\",{\"TaxingEntity\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Custom\", \"TaxingEntity\"}}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Renamed Columns\", {\"FundType\"}, FundType_Position, {\"Name\"}, \"FundType_Position\", JoinKind.LeftOuter),",
                "    #\"Expanded FundType_Position\" = Table.ExpandTableColumn(#\"Merged Queries\", \"FundType_Position\", {\"Position_City\"}, {\"Position\"}),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Expanded FundType_Position\", \"PositionRowGroup\", each if Number.Mod([Position],2) = 0",
                "then 2 ",
                "else Number.Mod([Position],2)),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Added Custom\",{{\"Position\", Int64.Type}, {\"PositionRowGroup\", Int64.Type}}),",
                "    #\"Replaced Value\" = Table.ReplaceValue(#\"Changed Type1\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"DateOfIssue\"}),",
                "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Replaced Value\",\"1900-01-01\",\"\",Replacer.ReplaceText,{\"MaturityDate\"}),",
                "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",0,null,Replacer.ReplaceValue,{\"TermInYears\"}),",
                "    #\"Added Levy12\" = Table.AddColumn(#\"Replaced Value2\", \"Levy12\", each if [Position] = 1 or [Position] = 2 then [Levy] else null),",
                "    #\"Added GrossRevenue12\" = Table.AddColumn(#\"Added Levy12\", \"GrossRevenue12\", each if [Position] = 1 or [Position] = 2 then [GrossRevenue] else null),",
                "    #\"Added Levy34\" = Table.AddColumn(#\"Added GrossRevenue12\", \"Levy34\", each if [Position] = 3 or [Position] = 4 then [Levy] else null),",
                "    #\"Added GrossRevenue34\" = Table.AddColumn(#\"Added Levy34\", \"GrossRevenue34\", each if [Position] = 3 or [Position] = 4 then [GrossRevenue] else null),",
                "    #\"Added Levy56\" = Table.AddColumn(#\"Added GrossRevenue34\", \"Levy56\", each if [Position] = 5 or [Position] = 6 then [Levy] else null),",
                "    #\"Added GrossRevenue56\" = Table.AddColumn(#\"Added Levy56\", \"GrossRevenue56\", each if [Position] = 5 or [Position] = 6 then [GrossRevenue] else null),",
                "    #\"Added Levy78\" = Table.AddColumn(#\"Added GrossRevenue56\", \"Levy78\", each if [Position] = 7 or [Position] = 8 then [Levy] else null),",
                "    #\"Added GrossRevenue78\" = Table.AddColumn(#\"Added Levy78\", \"GrossRevenue78\", each if [Position] = 7 or [Position] = 8 then [GrossRevenue] else null),",
                "",
                "    #\"Grouped Rows\" = Table.Group(#\"Added GrossRevenue78\", {\"TaxYear\", \"TaxAuthority\", \"TaxingEntity\", \"PositionRowGroup\", \"rownum\", \"Certified\", \"StateReportTabSection\"}, {{\"GROSSASSESSED\", each List.Max([GROSSASSESSED]), type nullable number}, {\"Levy12\", each List.Sum([Levy12]), type nullable number}, {\"GrossRevenue12\", each List.Sum([GrossRevenue12]), type nullable number}, {\"Levy34\", each List.Sum([Levy34]), type nullable number}, {\"GrossRevenue34\", each List.Sum([GrossRevenue34]), type nullable number}, {\"Levy56\", each List.Sum([Levy56]), type nullable number}, {\"GrossRevenue56\", each List.Sum([GrossRevenue56]), type nullable number}, {\"Levy78\", each List.Sum([Levy78]), type nullable number}, {\"GrossRevenue78\", each List.Sum([GrossRevenue78]), type nullable number}, {\"TotalLevy\", each List.Max([TotalLevyByTaxAuthority]), type nullable number}, {\"TotalGrossRevenue\", each List.Max([TotalGrossRevenuByTaxAuthority]), type nullable number}}),",
                "    #\"Added Position12\" = Table.AddColumn(#\"Grouped Rows\", \"Position12\", each if [PositionRowGroup] = 1",
                "then \"(1)\"",
                "else \"(2)\"),",
                "    #\"Added Position34\" = Table.AddColumn(#\"Added Position12\", \"Position34\", each if [PositionRowGroup] = 1",
                "then \"(3)\"",
                "else \"(4)\"),",
                "    #\"Added Position56\" = Table.AddColumn(#\"Added Position34\", \"Position56\", each if [PositionRowGroup] = 1",
                "then \"(5)\"",
                "else \"(6)\"),",
                "    #\"Added Position78\" = Table.AddColumn(#\"Added Position56\", \"Position78\", each if [PositionRowGroup] = 1 then -7 else -8)",
                "in",
                "    #\"Added Position78\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Parameters",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Parameter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a46040d5-bda9-417b-b7c6-915a00f670dd",
            "sourceColumn": "Parameter",
            "summarizeBy": "none"
          },
          {
            "name": "Value",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "9632e484-88de-45ab-bd87-a1d4d796fcb1",
            "sourceColumn": "Value",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "3ebd4ee4-af74-413f-a275-e7481d4f3de7",
        "partitions": [
          {
            "name": "Parameters",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromList({",
                "[Parameter = \"TaxYear_Param_LY\", Value = Number.ToText(TaxYear_Param_LY)],",
                "[Parameter = \"TaxYear_Param\", Value = Number.ToText(TaxYear_Param)],",
                "[Parameter = \"azure_server\", Value = azure_server],",
                "[Parameter = \"azure_database\", Value = azure_database],",
                "[Parameter = \"realware_server\", Value = realware_server],",
                "[Parameter = \"realware_database\", Value = realware_database],",
                "[Parameter = \"mds_server\", Value = mds_server],",
                "[Parameter = \"mds_database\", Value = mds_database]",
                "}",
                ",Record.FieldValues",
                "),",
                "    #\"Renamed Columns\" = Table.RenameColumns(Source,{{\"Column1\", \"Parameter\"}, {\"Column2\", \"Value\"}})",
                "in",
                "    #\"Renamed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Millap GROSSASSESSED",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "3a897332-b263-4afc-ad4e-0a6090ba9345",
            "sourceColumn": "TaxYear",
            "summarizeBy": "none"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "bef16537-226d-4cda-a39b-8fbf96e24725",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "387dc371-92b0-417a-9b1a-90639a466a05",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "e30c851c-6163-4c7b-8442-e37e37fe51de",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "AuthorityEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c9243790-fb89-4e4e-84ab-f871655b8454",
            "sourceColumn": "AuthorityEntity",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "3de961b6-6ec9-421e-8be7-34e1b4f68f63",
        "partitions": [
          {
            "name": "Millap GROSSASSESSED",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(realware_server, realware_database, [Query=\"with TAXAUTHORITYDETAIL as (#(lf)#(tab)select  #(lf)#(tab)#(tab) authoritydetail.TaxYear#(lf)#(tab)#(tab),authority.authorityname TaxingEntity#(lf)#(tab)#(tab),authority.TaxAuthority#(lf)#(tab)#(tab),authority.AUTHORITYTYPE#(lf)#(lf)#(tab)#(tab)from#(tab)#(tab)encompass.tlkptaxauthority#(tab)#(tab)#(tab)authority#(lf)#(tab)#(tab)join#(tab)#(tab)encompass.TLKPTAXAUTHORITYDETAIL#(tab)authoritydetail on authoritydetail.TAXAUTHORITY = authority.TAXAUTHORITY #(lf)#(tab)#(tab)where authority.TAXAUTHORITY is not null#(lf)#(tab)#(tab)#(tab)and authoritydetail.ACTIVEFLAG = 1#(lf)), certified as (#(lf)#(tab)select#(lf)#(tab)#(tab)CertID#(lf)#(tab)#(tab),TaxAuthority#(lf)#(tab)#(tab),TaxYear#(lf)#(tab)#(tab),Certified = case when (Certified = 'true' or Certified = '5') then 'true' else 'false' end#(lf)#(tab)#(tab),GROSSASSESSED = convert(decimal(18,0), GROSSASSESSED)#(lf)#(tab)from millap.cert#(lf)#(tab)where 1=1#(lf)#(tab)#(tab)and (Certified = 'true' or Certified = '5')#(lf))#(lf)select#(tab)#(lf)#(tab)ta.TaxYear#(lf)#(tab),ta.TaxAuthority#(lf)#(tab),ta.TaxingEntity#(lf)#(tab),ta.AUTHORITYTYPE#(lf)#(tab),c.Certified#(lf)#(tab),c.GROSSASSESSED#(lf)#(lf)from TAXAUTHORITYDETAIL ta#(lf)#(tab)join certified c on ta.TaxAuthority = c.TaxAuthority and ta.TAXYEAR = c.TaxYear#(lf)order by 1, 2#(lf)\", CreateNavigationProperties=false]),",
                "    #\"Filtered Year\" = Table.SelectRows(Source, each [TaxYear] = TaxYear_Param or [TaxYear] = TaxYear_Param_LY),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Filtered Year\", \"AuthorityEntity\", each [TaxAuthority] & \": \" & [TaxingEntity]),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Added Custom\",{\"AUTHORITYTYPE\", \"Certified\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Azure Mill Levy App GROSSASSESSED",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "TaxYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e805aa15-ba7c-4daf-b090-c74aa55d58bb",
            "sourceColumn": "TaxYear",
            "summarizeBy": "none"
          },
          {
            "name": "TaxAuthority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "acd27682-f39d-4836-b984-99a57b4aed96",
            "sourceColumn": "TaxAuthority",
            "summarizeBy": "none"
          },
          {
            "name": "TaxingEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d46a7ec3-bbd2-409b-9c24-68c03e196100",
            "sourceColumn": "TaxingEntity",
            "summarizeBy": "none"
          },
          {
            "name": "GROSSASSESSED",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "50571ae3-0248-44c6-82d2-9abec2856248",
            "sourceColumn": "GROSSASSESSED",
            "summarizeBy": "sum"
          },
          {
            "name": "AuthorityEntity",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "020574f5-4344-4de1-840b-fd4a54b6f85e",
            "sourceColumn": "AuthorityEntity",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "d1f5fb67-d929-4f70-b1b2-9043c8c760a0",
        "partitions": [
          {
            "name": "Azure Mill Levy App GROSSASSESSED",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(azure_server, azure_database, [Query=\"with TAXAUTHORITYDETAIL as (#(lf)#(tab)select  #(lf)#(tab)#(tab) TaxYear = authoritydetail.BudgetYear#(lf)#(tab)#(tab),TaxDistrictID = authority.[TaxDistrictID]#(lf)#(tab)#(tab),TaxingEntity = authority.[Name] #(lf)#(tab)#(tab),TaxAuthority = authority.CountyTaxEntityCode#(lf)#(tab)#(tab),GROSSASSESSED = authoritydetail.[GrossAssessedValue]#(lf)#(tab)#(tab)from#(tab)#(tab)[dbo].[TaxDistrict]#(tab)#(tab)#(tab)#(tab)#(tab)authority#(lf)#(tab)#(tab)join#(tab)#(tab)[dbo].[TaxDistrictYear]#(tab)#(tab)#(tab)#(tab)authoritydetail on authority.TaxDistrictId = authoritydetail.TaxDistrictId#(lf)#(tab)#(tab)where authoritydetail.IsActive = 1#(lf))#(lf)select#(tab)#(lf)#(tab)ta.TaxYear#(lf)#(tab),ta.TaxAuthority#(lf)#(tab),ta.TaxingEntity#(lf)#(tab)--numbers and dates#(lf)#(tab),ta.GROSSASSESSED#(lf)from TAXAUTHORITYDETAIL ta#(lf)#(lf)\", CreateNavigationProperties=false]),",
                "    #\"Filtered Year\" = Table.SelectRows(Source, each [TaxYear] = TaxYear_Param or [TaxYear] = TaxYear_Param_LY),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Filtered Year\", \"AuthorityEntity\", each [TaxAuthority] & \": \" & [TaxingEntity])",
                "in",
                "    #\"Added Custom\""
              ],
              "type": "m"
            }
          }
        ]
      }
    ]
  }
}